\doxysection{E\+:/pqc-\/engineering-\/ssec-\/23/d\+CTIDH/src/common/random.h File Reference}
\hypertarget{random_8h}{}\label{random_8h}\index{E:/pqc-\/engineering-\/ssec-\/23/dCTIDH/src/common/random.h@{E:/pqc-\/engineering-\/ssec-\/23/dCTIDH/src/common/random.h}}
{\ttfamily \#include $<$inttypes.\+h$>$}\newline
{\ttfamily \#include "{}../common/namespace.\+h"{}}\newline
Include dependency graph for random.\+h\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=280pt]{db/dfa/random_8h__incl}
\end{center}
\end{figure}
This graph shows which files directly or indirectly include this file\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d0/d46/random_8h__dep__incl}
\end{center}
\end{figure}
\doxysubsubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{random_8h_a926bce438bcfcae07eaa0f4ca8f9a424}{random\+\_\+boundedl1}}~\mbox{\hyperlink{namespace_8h_ae43d9937a95da747f7f3f636918c6700}{COMMON}}(random\+\_\+boundedl1)
\item 
\#define \mbox{\hyperlink{random_8h_ad1842f370b81524b5d719b8bcc236b79}{random\+\_\+coin}}~\mbox{\hyperlink{namespace_8h_ae43d9937a95da747f7f3f636918c6700}{COMMON}}(random\+\_\+coin)
\end{DoxyCompactItemize}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int64\+\_\+t \mbox{\hyperlink{random_8h_ad417abaeabbc971b4dcbcaee290fb292}{random\+\_\+coin}} (uint64\+\_\+t \mbox{\hyperlink{j-invariants_8m_ac23fb295847684aaafd24830017a8180}{num}}, uint64\+\_\+t den)
\item 
void \mbox{\hyperlink{random_8h_ace3b8cf474aa93ec9d8708ed8f6ddbc5}{random\+\_\+wombats}} (uint8\+\_\+t \texorpdfstring{$\ast$}{*}key, const long long numkeys, const long long \mbox{\hyperlink{primes_8h_a63de22a96a777bab244dd0850f58fed9}{batch\+\_\+start}}, const long long \mbox{\hyperlink{primes_8h_acc9e03579591509b3edb49d07bc8cca6}{batch\+\_\+stop}}, const long long batch\+\_\+sumykeys)
\end{DoxyCompactItemize}


\label{doc-define-members}
\Hypertarget{random_8h_doc-define-members}
\doxysubsection{Macro Definition Documentation}
\Hypertarget{random_8h_a926bce438bcfcae07eaa0f4ca8f9a424}\index{random.h@{random.h}!random\_boundedl1@{random\_boundedl1}}
\index{random\_boundedl1@{random\_boundedl1}!random.h@{random.h}}
\doxysubsubsection{\texorpdfstring{random\_boundedl1}{random\_boundedl1}}
{\footnotesize\ttfamily \label{random_8h_a926bce438bcfcae07eaa0f4ca8f9a424} 
\#define random\+\_\+boundedl1~\mbox{\hyperlink{namespace_8h_ae43d9937a95da747f7f3f636918c6700}{COMMON}}(random\+\_\+boundedl1)}



Definition at line \mbox{\hyperlink{random_8h_source_l00007}{7}} of file \mbox{\hyperlink{random_8h_source}{random.\+h}}.

\Hypertarget{random_8h_ad1842f370b81524b5d719b8bcc236b79}\index{random.h@{random.h}!random\_coin@{random\_coin}}
\index{random\_coin@{random\_coin}!random.h@{random.h}}
\doxysubsubsection{\texorpdfstring{random\_coin}{random\_coin}}
{\footnotesize\ttfamily \label{random_8h_ad1842f370b81524b5d719b8bcc236b79} 
\#define random\+\_\+coin~\mbox{\hyperlink{namespace_8h_ae43d9937a95da747f7f3f636918c6700}{COMMON}}(random\+\_\+coin)}



Definition at line \mbox{\hyperlink{random_8h_source_l00008}{8}} of file \mbox{\hyperlink{random_8h_source}{random.\+h}}.



\label{doc-func-members}
\Hypertarget{random_8h_doc-func-members}
\doxysubsection{Function Documentation}
\Hypertarget{random_8h_ad417abaeabbc971b4dcbcaee290fb292}\index{random.h@{random.h}!random\_coin@{random\_coin}}
\index{random\_coin@{random\_coin}!random.h@{random.h}}
\doxysubsubsection{\texorpdfstring{random\_coin()}{random\_coin()}}
{\footnotesize\ttfamily \label{random_8h_ad417abaeabbc971b4dcbcaee290fb292} 
int64\+\_\+t random\+\_\+coin (\begin{DoxyParamCaption}\item[{uint64\+\_\+t}]{num}{, }\item[{uint64\+\_\+t}]{den}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{random_8c_source_l00198}{198}} of file \mbox{\hyperlink{random_8c_source}{random.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00199\ \{}
\DoxyCodeLine{00200\ \ \ \ \ uint8\_t\ buf[32];}
\DoxyCodeLine{00201\ \ \ \ \ uint64\_t\ r\ =\ 0;}
\DoxyCodeLine{00202\ }
\DoxyCodeLine{00203\ \ \ \ \ \mbox{\hyperlink{c-code_2src_2rng_8c_aabbddb731663436423d24fa841900821}{randombytes}}(buf,\ \textcolor{keyword}{sizeof}\ buf);}
\DoxyCodeLine{00204\ }
\DoxyCodeLine{00205\ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{long}\ \textcolor{keywordtype}{long}\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}}\ =\ 0;\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}}\ <\ 256;\ ++\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}})}
\DoxyCodeLine{00206\ \ \ \ \ \{}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \ \ uint64\_t\ bit\ =\ 1\ \&\ (buf[\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}}\ /\ 8]\ >>\ (\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}}\ \&\ 7));}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \ \ r\ <<=\ 1;}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \ \ r\ +=\ bit;}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \ \ r\ \string^=\ (\string~uint64mask\_lessthan(r,\ den))\ \&\ (r\ \string^\ (r\ -\/\ den));}
\DoxyCodeLine{00211\ \ \ \ \ \}}
\DoxyCodeLine{00212\ \ \ \ \ \textcolor{comment}{//\ XXX:\ speed\ this\ up}}
\DoxyCodeLine{00213\ }
\DoxyCodeLine{00214\ \ \ \ \ \textcolor{keywordflow}{return}\ uint64mask\_lessthan(r,\ \mbox{\hyperlink{j-invariants_8m_ac23fb295847684aaafd24830017a8180}{num}});}
\DoxyCodeLine{00215\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{prime__search_8m_source_l00010}{i}}, \mbox{\hyperlink{j-invariants_8m_source_l00029}{num}}, and \mbox{\hyperlink{c-code_2src_2rng_8c_source_l00008}{randombytes()}}.

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=260pt]{d1/d79/random_8h_ad417abaeabbc971b4dcbcaee290fb292_cgraph}
\end{center}
\end{figure}
\Hypertarget{random_8h_ace3b8cf474aa93ec9d8708ed8f6ddbc5}\index{random.h@{random.h}!random\_wombats@{random\_wombats}}
\index{random\_wombats@{random\_wombats}!random.h@{random.h}}
\doxysubsubsection{\texorpdfstring{random\_wombats()}{random\_wombats()}}
{\footnotesize\ttfamily \label{random_8h_ace3b8cf474aa93ec9d8708ed8f6ddbc5} 
void random\+\_\+wombats (\begin{DoxyParamCaption}\item[{uint8\+\_\+t \texorpdfstring{$\ast$}{*}}]{key}{, }\item[{const long long}]{numkeys}{, }\item[{const long long}]{batch\+\_\+start}{, }\item[{const long long}]{batch\+\_\+stop}{, }\item[{const long long}]{batch\+\_\+sumykeys}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{random_8c_source_l00015}{15}} of file \mbox{\hyperlink{random_8c_source}{random.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00016\ \{}
\DoxyCodeLine{00017\ \ \ \ \ int32\_t\ batch\_len\ =\ \mbox{\hyperlink{primes_8h_acc9e03579591509b3edb49d07bc8cca6}{batch\_stop}}\ -\/\ \mbox{\hyperlink{primes_8h_a63de22a96a777bab244dd0850f58fed9}{batch\_start}};}
\DoxyCodeLine{00018\ \ \ \ \ int32\_t\ r[4\ *\ batch\_len];}
\DoxyCodeLine{00019\ \ \ \ \ uint8\_t\ ells[numkeys];}
\DoxyCodeLine{00020\ \ \ \ \ \textcolor{keywordflow}{for}\ (;;)}
\DoxyCodeLine{00021\ \ \ \ \ \{\ \textcolor{comment}{/*\ rejection-\/sampling\ loop\ */}}
\DoxyCodeLine{00022\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{c-code_2src_2rng_8c_aabbddb731663436423d24fa841900821}{randombytes}}(r,\ 4\ *\ batch\_len);}
\DoxyCodeLine{00023\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{long}\ \textcolor{keywordtype}{long}\ \mbox{\hyperlink{prime__search_8m_ac86694252f8dfdb19aaeadc4b7c342c6}{j}}\ =\ 0;\ \mbox{\hyperlink{prime__search_8m_ac86694252f8dfdb19aaeadc4b7c342c6}{j}}\ <\ batch\_len;\ ++\mbox{\hyperlink{prime__search_8m_ac86694252f8dfdb19aaeadc4b7c342c6}{j}})}
\DoxyCodeLine{00024\ \ \ \ \ \ \ \ \ \ \ \ \ r[\mbox{\hyperlink{prime__search_8m_ac86694252f8dfdb19aaeadc4b7c342c6}{j}}]\ \&=\ \string~1;}
\DoxyCodeLine{00025\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{long}\ \textcolor{keywordtype}{long}\ \mbox{\hyperlink{prime__search_8m_ac86694252f8dfdb19aaeadc4b7c342c6}{j}}\ =\ 0;\ \mbox{\hyperlink{prime__search_8m_ac86694252f8dfdb19aaeadc4b7c342c6}{j}}\ <\ numkeys;\ ++\mbox{\hyperlink{prime__search_8m_ac86694252f8dfdb19aaeadc4b7c342c6}{j}})}
\DoxyCodeLine{00026\ \ \ \ \ \ \ \ \ \ \ \ \ r[\mbox{\hyperlink{prime__search_8m_ac86694252f8dfdb19aaeadc4b7c342c6}{j}}]\ |=\ 1;}
\DoxyCodeLine{00027\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{int32__sort_8h_ae059af982adfb60f176da9058368aa87}{int32\_sort}}(r,\ batch\_len);}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00029\ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{long}\ collision\ =\ 0;}
\DoxyCodeLine{00030\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (\textcolor{keywordtype}{long}\ \textcolor{keywordtype}{long}\ \mbox{\hyperlink{prime__search_8m_ac86694252f8dfdb19aaeadc4b7c342c6}{j}}\ =\ 1;\ \mbox{\hyperlink{prime__search_8m_ac86694252f8dfdb19aaeadc4b7c342c6}{j}}\ <\ numkeys;\ ++\mbox{\hyperlink{prime__search_8m_ac86694252f8dfdb19aaeadc4b7c342c6}{j}})}
\DoxyCodeLine{00031\ \ \ \ \ \ \ \ \ \ \ \ \ collision\ |=\ int32mask\_zero((r[\mbox{\hyperlink{prime__search_8m_ac86694252f8dfdb19aaeadc4b7c342c6}{j}}]\ \string^\ r[\mbox{\hyperlink{prime__search_8m_ac86694252f8dfdb19aaeadc4b7c342c6}{j}}\ -\/\ 1])\ \&\ \string~1);}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00033\ \textcolor{preprocessor}{\#ifdef\ ENABLE\_CT\_TESTING}}
\DoxyCodeLine{00034\ \ \ \ \ \ \ \ \ VALGRIND\_MAKE\_MEM\_DEFINED(\&collision,\ \textcolor{keyword}{sizeof}(collision));}
\DoxyCodeLine{00035\ \textcolor{preprocessor}{\#endif}}
\DoxyCodeLine{00036\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (collision)}
\DoxyCodeLine{00037\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue};}
\DoxyCodeLine{00038\ }
\DoxyCodeLine{00039\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (int32\_t\ \mbox{\hyperlink{prime__search_8m_ac86694252f8dfdb19aaeadc4b7c342c6}{j}}\ =\ 0;\ \mbox{\hyperlink{prime__search_8m_ac86694252f8dfdb19aaeadc4b7c342c6}{j}}\ <\ numkeys;\ ++\mbox{\hyperlink{prime__search_8m_ac86694252f8dfdb19aaeadc4b7c342c6}{j}})}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \ \ \ \ \ \ ells[\mbox{\hyperlink{prime__search_8m_ac86694252f8dfdb19aaeadc4b7c342c6}{j}}]\ =\ 0;}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (int32\_t\ \mbox{\hyperlink{prime__search_8m_ac86694252f8dfdb19aaeadc4b7c342c6}{j}}\ =\ 0;\ \mbox{\hyperlink{prime__search_8m_ac86694252f8dfdb19aaeadc4b7c342c6}{j}}\ <\ batch\_len;\ ++\mbox{\hyperlink{prime__search_8m_ac86694252f8dfdb19aaeadc4b7c342c6}{j}})}
\DoxyCodeLine{00043\ \ \ \ \ \ \ \ \ \ \ \ \ r[\mbox{\hyperlink{prime__search_8m_ac86694252f8dfdb19aaeadc4b7c342c6}{j}}]\ \&=\ 1;}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (int32\_t\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}}\ =\ 0;\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}}\ <\ numkeys;\ ++\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}})}
\DoxyCodeLine{00046\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00047\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (int32\_t\ \mbox{\hyperlink{prime__search_8m_ac86694252f8dfdb19aaeadc4b7c342c6}{j}}\ =\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}};\ \mbox{\hyperlink{prime__search_8m_ac86694252f8dfdb19aaeadc4b7c342c6}{j}}\ <\ batch\_len;\ ++\mbox{\hyperlink{prime__search_8m_ac86694252f8dfdb19aaeadc4b7c342c6}{j}})}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ r[j]\ \&=\ 1;}}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ int32\_t\ updatemask\ =\ int32mask\_zero(ells[\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}}])\ \&\ int32mask\_nonzero(r[\mbox{\hyperlink{prime__search_8m_ac86694252f8dfdb19aaeadc4b7c342c6}{j}}]);}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ r[\mbox{\hyperlink{prime__search_8m_ac86694252f8dfdb19aaeadc4b7c342c6}{j}}]\ \string^=\ (1\ \&\ updatemask);}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ells[\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}}]\ |=\ (updatemask\ \&\ (\mbox{\hyperlink{prime__search_8m_ac86694252f8dfdb19aaeadc4b7c342c6}{j}}\ +\ 1));}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00056\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (int32\_t\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}}\ =\ 0;\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}}\ <\ numkeys;\ ++\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}})}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \ \ \ \ key[batch\_sumykeys\ +\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}}]\ =\ \mbox{\hyperlink{primes_8h_a63de22a96a777bab244dd0850f58fed9}{batch\_start}}\ +\ ells[\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{i}}]\ -\/\ 1;}
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00060\ \ \ \ \ \}}
\DoxyCodeLine{00061\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{primes_8h_source_l00055}{batch\+\_\+start}}, \mbox{\hyperlink{primes_8h_source_l00056}{batch\+\_\+stop}}, \mbox{\hyperlink{prime__search_8m_source_l00010}{i}}, \mbox{\hyperlink{int32__sort_8h_source_l00006}{int32\+\_\+sort}}, \mbox{\hyperlink{prime__search_8m_source_l00012}{j}}, and \mbox{\hyperlink{c-code_2src_2rng_8c_source_l00008}{randombytes()}}.

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=282pt]{d1/d79/random_8h_ace3b8cf474aa93ec9d8708ed8f6ddbc5_cgraph}
\end{center}
\end{figure}
