\doxysection{/home/liwuen/projects\+\_\+dev/pqc-\/engineering-\/ssec-\/23/d\+CTIDH/src/common/elligator.c File Reference}
\hypertarget{elligator_8c}{}\label{elligator_8c}\index{/home/liwuen/projects\_dev/pqc-\/engineering-\/ssec-\/23/dCTIDH/src/common/elligator.c@{/home/liwuen/projects\_dev/pqc-\/engineering-\/ssec-\/23/dCTIDH/src/common/elligator.c}}
{\ttfamily \#include "{}elligator.\+h"{}}\newline
Include dependency graph for elligator.\+c\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=339pt]{da/da5/elligator_8c__incl}
\end{center}
\end{figure}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{void}} \mbox{\hyperlink{elligator_8c_a0bb8b385006923e2c0fa3e2a69f59a98}{elligator}} (\mbox{\hyperlink{structproj}{proj}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{plus}}, \mbox{\hyperlink{structproj}{proj}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{minus}}, \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{const}} \mbox{\hyperlink{structproj}{proj}} \texorpdfstring{$\ast$}{*}A)
\item 
\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{void}} \mbox{\hyperlink{elligator_8c_a37fd27435003aee4f3bf12402b95a4c7}{elligator\+\_\+seeded}} (\mbox{\hyperlink{structproj}{proj}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{Tp}}, \mbox{\hyperlink{structproj}{proj}} \texorpdfstring{$\ast$}{*}\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{Tm}}, \mbox{\hyperlink{structproj}{proj}} \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{const}} \texorpdfstring{$\ast$}{*}A, \mbox{\hyperlink{fp-gmp_8h_a167c68a20b94476341fdbff3d8688784}{fp}} \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{const}} \texorpdfstring{$\ast$}{*}u)
\end{DoxyCompactItemize}


\doxysubsection{Function Documentation}
\Hypertarget{elligator_8c_a0bb8b385006923e2c0fa3e2a69f59a98}\label{elligator_8c_a0bb8b385006923e2c0fa3e2a69f59a98} 
\index{elligator.c@{elligator.c}!elligator@{elligator}}
\index{elligator@{elligator}!elligator.c@{elligator.c}}
\doxysubsubsection{\texorpdfstring{elligator()}{elligator()}}
{\footnotesize\ttfamily \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{void}} elligator (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structproj}{proj}} \texorpdfstring{$\ast$}{*}}]{plus,  }\item[{\mbox{\hyperlink{structproj}{proj}} \texorpdfstring{$\ast$}{*}}]{minus,  }\item[{\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{const}} \mbox{\hyperlink{structproj}{proj}} \texorpdfstring{$\ast$}{*}}]{A }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{elligator_8c_source_l00006}{6}} of file \mbox{\hyperlink{elligator_8c_source}{elligator.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00007\ \{}
\DoxyCodeLine{00008\ \ \ \textcolor{keywordflow}{for}\ (;;)\ \{}
\DoxyCodeLine{00009\ \ \ \ \ \mbox{\hyperlink{fp-gmp_8h_a167c68a20b94476341fdbff3d8688784}{fp}}\ \mbox{\hyperlink{namespacepip_1_1__vendor_1_1six_a2558e6d58b4c0d33c6a55f0356ca6630}{u}};}
\DoxyCodeLine{00010\ \ \ \ \ \mbox{\hyperlink{fp-gmp_8h_afe624b010306dd35023fcd3ccbcf3378}{fp\_random}}(u);}
\DoxyCodeLine{00011\ \ \ \ \ \textcolor{comment}{//\ memset(u,\ 1,\ sizeof(u));\ }}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \ \ \ \ \textcolor{comment}{//\ long\ long\ reject\ =\ fp\_iszero(\&u);}}
\DoxyCodeLine{00014\ \ \ \ \ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{long}\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{reject}}\ =\ fp\_iszero(u);\ \ \ \ }
\DoxyCodeLine{00015\ \ \ \ \ \textcolor{comment}{//\ crypto\_declassify(\&reject,sizeof\ reject);}}
\DoxyCodeLine{00016\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{reject}})\ \textcolor{keywordflow}{continue};\ \textcolor{comment}{/*\ bad\ RNG\ outputs\ 0\ */}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \ \ \ \ \mbox{\hyperlink{fp-gmp_8h_a167c68a20b94476341fdbff3d8688784}{fp}}\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{u2}};\ fp\_sq2(\&\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{u2}},(\textcolor{keyword}{const}\ \mbox{\hyperlink{fp-gmp_8h_a167c68a20b94476341fdbff3d8688784}{fp}}*)\ \&u);}
\DoxyCodeLine{00019\ \ \ \ \ \mbox{\hyperlink{fp-gmp_8h_a167c68a20b94476341fdbff3d8688784}{fp}}\ \mbox{\hyperlink{namespacepip_1_1__internal_1_1resolution_1_1resolvelib_1_1provider_a350bfcb1e3cfb28ddff48ce525d4f139}{D}}\ =\ \{0\};\ fp\_sub3(\&D,(\textcolor{keyword}{const}\ \mbox{\hyperlink{fp-gmp_8h_a167c68a20b94476341fdbff3d8688784}{fp}}*)\ \&\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{u2}},\&\mbox{\hyperlink{fp-gmp_8h_a4ec3519815103a8a92bd612f933abbb1}{fp\_1}});}
\DoxyCodeLine{00020\ }
\DoxyCodeLine{00021\ \ \ \ \ \textcolor{comment}{//\ reject\ =\ fp\_iszero(\&D);}}
\DoxyCodeLine{00022\ \ \ \ \ }
\DoxyCodeLine{00023\ \ \ \ \ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{reject}}\ =\ fp\_iszero(D);\ \ \ \ }
\DoxyCodeLine{00024\ \ \ \ \ \textcolor{comment}{//\ crypto\_declassify(\&reject,sizeof\ reject);}}
\DoxyCodeLine{00025\ \ \ \ \ \textcolor{keywordflow}{if}\ (\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{reject}})\ \textcolor{keywordflow}{continue};\ \textcolor{comment}{/*\ bad\ RNG\ outputs\ +-\/1\ */}}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00027\ \ \ \ \ \mbox{\hyperlink{fp-gmp_8h_a167c68a20b94476341fdbff3d8688784}{fp}}\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{M}};\ fp\_mul3(\&\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{M}},\&\mbox{\hyperlink{namespacetests_a3b98e2dffc6cb06a89dcb0d5c60a0206}{A}}-\/>x,(\textcolor{keyword}{const}\ \mbox{\hyperlink{fp-gmp_8h_a167c68a20b94476341fdbff3d8688784}{fp}}*)\ \&\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{u2}});\ \textcolor{comment}{/*\ M\ =\ u\string^2\ A-\/>x\ */}}
\DoxyCodeLine{00028\ \ \ \ \ \mbox{\hyperlink{fp-gmp_8h_a167c68a20b94476341fdbff3d8688784}{fp}}\ \mbox{\hyperlink{namespacepip_1_1__internal_1_1models_1_1direct__url_adf1f3edb9115acb0a1e04209b7a9937b}{T}};\ fp\_mul3(\&T,\&\mbox{\hyperlink{namespacetests_a3b98e2dffc6cb06a89dcb0d5c60a0206}{A}}-\/>x,(\textcolor{keyword}{const}\ \mbox{\hyperlink{fp-gmp_8h_a167c68a20b94476341fdbff3d8688784}{fp}}*)\ \&\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{M}});\ \textcolor{comment}{/*\ T\ =\ u\string^2\ A-\/>x\string^2\ */}}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00030\ \ \ \ \ \textcolor{comment}{//\ long\ long\ control\ =\ fp\_iszero(\&A-\/>x);}}
\DoxyCodeLine{00031\ \ \ \ \ \textcolor{keywordtype}{long}\ \textcolor{keywordtype}{long}\ control\ =\ fp\_iszero(\mbox{\hyperlink{namespacetests_a3b98e2dffc6cb06a89dcb0d5c60a0206}{A}}-\/>x);}
\DoxyCodeLine{00032\ \ \ \ \ \mbox{\hyperlink{fp-gmp_8h_a167c68a20b94476341fdbff3d8688784}{fp}}\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{P}};}
\DoxyCodeLine{00033\ \ \ \ \ \mbox{\hyperlink{fp-gmp_8h_ad0b6e5afb2fdd4f50fd2714fc59931ab}{fp\_copy}}(\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{P}},\ \mbox{\hyperlink{namespacetests_a3b98e2dffc6cb06a89dcb0d5c60a0206}{A}}-\/>x);}
\DoxyCodeLine{00034\ \ \ \ \ fp\_cmov\_ctidh(\&\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{P}},\&\mbox{\hyperlink{fp-gmp_8h_a4ec3519815103a8a92bd612f933abbb1}{fp\_1}},control);\ \textcolor{comment}{/*\ P\ =\ 1\ if\ A-\/>x\ =\ 0\ else\ A-\/>x\ */}}
\DoxyCodeLine{00035\ \ \ \ \ fp\_cmov\_ctidh(\&\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{M}},\&\mbox{\hyperlink{fp-gmp_8h_a4ec3519815103a8a92bd612f933abbb1}{fp\_1}},control);\ \textcolor{comment}{/*\ M\ =\ 1\ if\ A-\/>x\ =\ 0\ else\ u\string^2\ A-\/>x\ */}}
\DoxyCodeLine{00036\ \ \ \ \ fp\_cmov\_ctidh(\&T,\&\mbox{\hyperlink{fp-gmp_8h_a4ec3519815103a8a92bd612f933abbb1}{fp\_1}},control);\ \textcolor{comment}{/*\ T\ =\ 1\ if\ A-\/>x\ =\ 0\ */}}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ \ \ \ \ fp\_mul2(\&D,\&\mbox{\hyperlink{namespacetests_a3b98e2dffc6cb06a89dcb0d5c60a0206}{A}}-\/>z);\ \textcolor{comment}{/*\ D\ =\ (u\string^2-\/1)\ A-\/>z\ */}}
\DoxyCodeLine{00039\ }
\DoxyCodeLine{00040\ \ \ \ \ \mbox{\hyperlink{fp-gmp_8h_a167c68a20b94476341fdbff3d8688784}{fp}}\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{D2}};\ fp\_sq2(\&\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{D2}},(\textcolor{keyword}{const}\ \mbox{\hyperlink{fp-gmp_8h_a167c68a20b94476341fdbff3d8688784}{fp}}*)\ \&D);\ \textcolor{comment}{/*\ D2\ =\ (u\string^2-\/1)\string^2\ A-\/>z\string^2\ */}}
\DoxyCodeLine{00041\ }
\DoxyCodeLine{00042\ \ \ \ \ fp\_add2(\&T,(\textcolor{keyword}{const}\ \mbox{\hyperlink{fp-gmp_8h_a167c68a20b94476341fdbff3d8688784}{fp}}*)\ \&\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{D2}});\ \textcolor{comment}{/*\ T\ =\ 1\ +\ (u\string^2-\/1)\string^2\ A-\/>z\string^2\ if\ A-\/>x\ =\ 0,\ else\ u\string^2\ A-\/>x\string^2\ +\ (u\string^2-\/1)\string^2\ A-\/>z\string^2\ */}}
\DoxyCodeLine{00043\ \ \ \ \ fp\_mul2(\&T,(\textcolor{keyword}{const}\ \mbox{\hyperlink{fp-gmp_8h_a167c68a20b94476341fdbff3d8688784}{fp}}*)\ \&D);}
\DoxyCodeLine{00044\ \ \ \ \ fp\_mul2(\&T,(\textcolor{keyword}{const}\ \mbox{\hyperlink{fp-gmp_8h_a167c68a20b94476341fdbff3d8688784}{fp}}*)\ \&\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{P}});}
\DoxyCodeLine{00045\ \ \ \ \ \textcolor{comment}{/*\ T\ =\ (u\string^2-\/1)A-\/>z(1+(u\string^2-\/1)\string^2\ A-\/>z\string^2)\ if\ A-\/>x\ =\ 0\ */}}
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{comment}{/*\ else\ (u\string^2-\/1)\ A-\/>z\ A-\/>x(u\string^2\ A-\/>x\string^2\ +\ (u\string^2-\/1)\string^2\ A-\/>z\string^2)\ */}}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ \ \ \ \ \textcolor{comment}{/*\ plus\ point\ will\ be\ P/D\ =\ 1/(u\string^2-\/1)A-\/>z\ if\ A-\/>x\ =\ 0\ else\ A/(u\string^2-\/1)\ */}}
\DoxyCodeLine{00049\ \ \ \ \ \textcolor{comment}{/*\ and\ minus\ point\ will\ be\ -\/M/D\ =\ -\/1/(u\string^2-\/1)A-\/>z\ if\ A-\/>x\ =\ 0\ else\ -\/u\string^2\ A/(u\string^2-\/1)\ */}}
\DoxyCodeLine{00050\ \ \ \ \ \textcolor{comment}{/*\ unless\ they're\ flipped,\ which\ is\ determined\ by\ T\ */}}
\DoxyCodeLine{00051\ }
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{comment}{/*\ T\ =\ Az\string^4\ (1-\/u\string^2)\string^4\ ((P/D)\string^3+A(P/D)\string^2+(P/D))\ */}}
\DoxyCodeLine{00053\ \ \ \ \ \textcolor{comment}{/*\ so\ T\ squareness\ says\ whether\ P/D\ is\ on\ curve\ */}}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00055\ \ \ \ \ \textcolor{comment}{/*\ also\ says\ whether\ -\/M/D\ is\ not\ on\ curve:\ */}}
\DoxyCodeLine{00056\ \ \ \ \ \textcolor{comment}{/*\ in\ all\ cases\ -\/M/D\ =\ -\/P/D-\/A\ */}}
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{comment}{/*\ so\ (-\/M/D)\string^3+A(-\/M/D)\string^2+(-\/M/D)\ =\ (-\/P/D-\/A)\string^3+A(-\/P/D-\/A)\string^2+(-\/P/D-\/A)\ */}}
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{comment}{/*\ =\ ((P/D)\string^3+A(P/D)\string^2+(P/D))\ (-\/1-\/AD/P)\ */}}
\DoxyCodeLine{00059\ \ \ \ \ \textcolor{comment}{/*\ and\ by\ construction\ -\/1-\/AD/P\ is\ a\ non-\/square\ */}}
\DoxyCodeLine{00060\ \ \ \ \ \textcolor{comment}{/*\ since\ it's\ -\/1\ if\ A=0,\ else\ -\/u\string^2\ */}}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ \ \ \ \ \mbox{\hyperlink{fp-gmp_8h_ad0b6e5afb2fdd4f50fd2714fc59931ab}{fp\_copy}}(\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{plus}}-\/>x,\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{P}});}
\DoxyCodeLine{00063\ \ \ \ \ fp\_neg2(\&\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{minus}}-\/>x,(\textcolor{keyword}{const}\ \mbox{\hyperlink{fp-gmp_8h_a167c68a20b94476341fdbff3d8688784}{fp}}*)\ \&\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{M}});}
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00065\ }
\DoxyCodeLine{00066\ }
\DoxyCodeLine{00067\ \textcolor{comment}{//\ \ \ x0\ =\ plus-\/>x;}}
\DoxyCodeLine{00068\ \textcolor{comment}{//\ \ \ y0\ =\ minus-\/>x;}}
\DoxyCodeLine{00069\ }
\DoxyCodeLine{00070\ \ \ \ \ \textcolor{comment}{//\ test\ x0,\ y0;}}
\DoxyCodeLine{00071\ \ \ \ \ \textcolor{comment}{//\ x0[0]\ =\ 1;}}
\DoxyCodeLine{00072\ \ \ \ \ \textcolor{comment}{//\ y0[0]\ =\ 2;}}
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00074\ }
\DoxyCodeLine{00075\ \ \ \ \ \mbox{\hyperlink{fp-gmp_8h_ae5352fd0eaf14191f3b15b9203b92cfc}{fp\_cswap}}(\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{plus}}-\/>x,\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{minus}}-\/>x,1-\/\mbox{\hyperlink{fp_8c_aba1244ec3fa3fb19a97efee5c67e6b96}{fp\_sqrt}}(\&T));}
\DoxyCodeLine{00076\ }
\DoxyCodeLine{00077\ }
\DoxyCodeLine{00078\ \ \ \ \ \mbox{\hyperlink{fp-gmp_8h_ad0b6e5afb2fdd4f50fd2714fc59931ab}{fp\_copy}}(\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{plus}}-\/>z,\ D);}
\DoxyCodeLine{00079\ \ \ \ \ \mbox{\hyperlink{fp-gmp_8h_ad0b6e5afb2fdd4f50fd2714fc59931ab}{fp\_copy}}(\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{minus}}-\/>z,\ D);}
\DoxyCodeLine{00080\ }
\DoxyCodeLine{00081\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00082\ \ \ \}}
\DoxyCodeLine{00083\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{fp-gmp_8h_source_l00048}{fp\+\_\+1}}, \mbox{\hyperlink{fp-gmp_8h_source_l00079}{fp\+\_\+copy}}, \mbox{\hyperlink{fp-gmp_8h_source_l00082}{fp\+\_\+cswap}}, \mbox{\hyperlink{fp-gmp_8h_source_l00085}{fp\+\_\+random}}, \mbox{\hyperlink{fp_8c_source_l00168}{fp\+\_\+sqrt()}}, \mbox{\hyperlink{proj_8h_source_l00019}{proj\+::x}}, and \mbox{\hyperlink{proj_8h_source_l00020}{proj\+::z}}.

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=325pt]{d5/d78/elligator_8c_a0bb8b385006923e2c0fa3e2a69f59a98_cgraph}
\end{center}
\end{figure}
\Hypertarget{elligator_8c_a37fd27435003aee4f3bf12402b95a4c7}\label{elligator_8c_a37fd27435003aee4f3bf12402b95a4c7} 
\index{elligator.c@{elligator.c}!elligator\_seeded@{elligator\_seeded}}
\index{elligator\_seeded@{elligator\_seeded}!elligator.c@{elligator.c}}
\doxysubsubsection{\texorpdfstring{elligator\_seeded()}{elligator\_seeded()}}
{\footnotesize\ttfamily \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{void}} elligator\+\_\+seeded (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structproj}{proj}} \texorpdfstring{$\ast$}{*}}]{Tp,  }\item[{\mbox{\hyperlink{structproj}{proj}} \texorpdfstring{$\ast$}{*}}]{Tm,  }\item[{\mbox{\hyperlink{structproj}{proj}} \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{const}} \texorpdfstring{$\ast$}{*}}]{A,  }\item[{\mbox{\hyperlink{fp-gmp_8h_a167c68a20b94476341fdbff3d8688784}{fp}} \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{const}} \texorpdfstring{$\ast$}{*}}]{u }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{elligator_8c_source_l00086}{86}} of file \mbox{\hyperlink{elligator_8c_source}{elligator.\+c}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00087\ \{}
\DoxyCodeLine{00088\ \ \ \ \ \mbox{\hyperlink{fp-gmp_8h_a167c68a20b94476341fdbff3d8688784}{fp}}\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{Ap}},\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{C\_times\_u\_squared\_minus\_one}},\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{AC\_times\_u\_squared\_minus\_one}},}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{u\_squared}},\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{u\_squared\_plus\_one}},\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{u\_squared\_minus\_one}},}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{alpha}},\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{beta}},\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{tmp}},\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{aux}};}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00092\ \ \ \ \ \mbox{\hyperlink{fp-gmp_8h_a80f123b780aa89ca8990f737ca4cb107}{fp\_add}}(\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{Ap}},\ \mbox{\hyperlink{namespacetests_a3b98e2dffc6cb06a89dcb0d5c60a0206}{A}}-\/>x,\ \mbox{\hyperlink{namespacetests_a3b98e2dffc6cb06a89dcb0d5c60a0206}{A}}-\/>x);}
\DoxyCodeLine{00093\ \ \ \ \ \mbox{\hyperlink{fp-gmp_8h_a39db70a91da3d35b6c9e8b50cde6aab2}{fp\_sub}}(\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{Ap}},\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{Ap}},\ \mbox{\hyperlink{namespacetests_a3b98e2dffc6cb06a89dcb0d5c60a0206}{A}}-\/>z);}
\DoxyCodeLine{00094\ \ \ \ \ \mbox{\hyperlink{fp-gmp_8h_a80f123b780aa89ca8990f737ca4cb107}{fp\_add}}(\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{Ap}},\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{Ap}},\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{Ap}});}
\DoxyCodeLine{00095\ \ \ \ \ }
\DoxyCodeLine{00096\ \ \ \ \ \mbox{\hyperlink{fp-gmp_8h_a15326dc97def54531d1ba527d996316e}{fp\_sqr}}(\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{u\_squared}},\ *u);}
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00098\ \ \ \ \ \mbox{\hyperlink{fp-gmp_8h_a80f123b780aa89ca8990f737ca4cb107}{fp\_add}}(\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{u\_squared\_plus\_one}},\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{u\_squared}},\ \mbox{\hyperlink{fp-gmp_8h_a4ec3519815103a8a92bd612f933abbb1}{fp\_1}});}
\DoxyCodeLine{00099\ \ \ \ \ \mbox{\hyperlink{fp-gmp_8h_a39db70a91da3d35b6c9e8b50cde6aab2}{fp\_sub}}(\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{u\_squared\_minus\_one}},\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{u\_squared}},\ \mbox{\hyperlink{fp-gmp_8h_a4ec3519815103a8a92bd612f933abbb1}{fp\_1}});}
\DoxyCodeLine{00100\ }
\DoxyCodeLine{00101\ \ \ \ \ \mbox{\hyperlink{fp-gmp_8h_a4072510900fe5bb7cff7fac34e483e48}{fp\_mul}}(\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{C\_times\_u\_squared\_minus\_one}},\ \mbox{\hyperlink{namespacetests_a3b98e2dffc6cb06a89dcb0d5c60a0206}{A}}-\/>z,\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{u\_squared\_minus\_one}});}
\DoxyCodeLine{00102\ \ \ \ \ \mbox{\hyperlink{fp-gmp_8h_a4072510900fe5bb7cff7fac34e483e48}{fp\_mul}}(\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{AC\_times\_u\_squared\_minus\_one}},\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{Ap}},\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{C\_times\_u\_squared\_minus\_one}});}
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00104\ \ \ \ \ \mbox{\hyperlink{fp-gmp_8h_a15326dc97def54531d1ba527d996316e}{fp\_sqr}}(\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{tmp}},\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{Ap}});}
\DoxyCodeLine{00105\ \ \ \ \ \mbox{\hyperlink{fp-gmp_8h_a4072510900fe5bb7cff7fac34e483e48}{fp\_mul}}(\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{tmp}},\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{tmp}},\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{u\_squared}});}
\DoxyCodeLine{00106\ \ \ \ \ \mbox{\hyperlink{fp-gmp_8h_a15326dc97def54531d1ba527d996316e}{fp\_sqr}}(\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{aux}},\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{C\_times\_u\_squared\_minus\_one}});}
\DoxyCodeLine{00107\ \ \ \ \ \mbox{\hyperlink{fp-gmp_8h_a80f123b780aa89ca8990f737ca4cb107}{fp\_add}}(\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{tmp}},\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{tmp}},\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{aux}});}
\DoxyCodeLine{00108\ \ \ \ \ \mbox{\hyperlink{fp-gmp_8h_a4072510900fe5bb7cff7fac34e483e48}{fp\_mul}}(\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{tmp}},\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{AC\_times\_u\_squared\_minus\_one}},\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{tmp}});}
\DoxyCodeLine{00109\ }
\DoxyCodeLine{00110\ \ \ \ \ fp\_set0(\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{alpha}});}
\DoxyCodeLine{00111\ \ \ \ \ \mbox{\hyperlink{fp-gmp_8h_ad0b6e5afb2fdd4f50fd2714fc59931ab}{fp\_copy}}(\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{beta}},\ *u);}
\DoxyCodeLine{00112\ \ \ \ \ \mbox{\hyperlink{fp-gmp_8h_ae5352fd0eaf14191f3b15b9203b92cfc}{fp\_cswap}}(\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{alpha}},\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{beta}},\ fp\_iszero(\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{tmp}}));}
\DoxyCodeLine{00113\ \ \ \ \ \mbox{\hyperlink{fp-gmp_8h_a4072510900fe5bb7cff7fac34e483e48}{fp\_mul}}(\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{u\_squared\_plus\_one}},\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{alpha}},\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{u\_squared\_plus\_one}});}
\DoxyCodeLine{00114\ \ \ \ \ \mbox{\hyperlink{fp-gmp_8h_a4072510900fe5bb7cff7fac34e483e48}{fp\_mul}}(\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{alpha}},\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{alpha}},\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{C\_times\_u\_squared\_minus\_one}});}
\DoxyCodeLine{00115\ }
\DoxyCodeLine{00116\ \ \ \ \ \mbox{\hyperlink{fp-gmp_8h_a80f123b780aa89ca8990f737ca4cb107}{fp\_add}}(\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{Tp}}-\/>x,\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{Ap}},\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{alpha}});}
\DoxyCodeLine{00117\ \ \ \ \ \mbox{\hyperlink{fp-gmp_8h_a4072510900fe5bb7cff7fac34e483e48}{fp\_mul}}(\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{Tm}}-\/>x,\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{Ap}},\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{u\_squared}});}
\DoxyCodeLine{00118\ \ \ \ \ \mbox{\hyperlink{fp-gmp_8h_a80f123b780aa89ca8990f737ca4cb107}{fp\_add}}(\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{Tm}}-\/>x,\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{Tm}}-\/>x,\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{alpha}});}
\DoxyCodeLine{00119\ \ \ \ \ \mbox{\hyperlink{fp-gmp_8h_a39db70a91da3d35b6c9e8b50cde6aab2}{fp\_sub}}(\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{Tm}}-\/>x,\ \mbox{\hyperlink{fp-gmp_8h_a752d13f29bc45af353433e5ac19b10b9}{fp\_0}},\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{Tm}}-\/>x);}
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00121\ \ \ \ \ \mbox{\hyperlink{fp-gmp_8h_a80f123b780aa89ca8990f737ca4cb107}{fp\_add}}(\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{tmp}},\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{tmp}},\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{u\_squared\_plus\_one}});}
\DoxyCodeLine{00122\ \ \ \ \ \mbox{\hyperlink{fp-gmp_8h_ae5352fd0eaf14191f3b15b9203b92cfc}{fp\_cswap}}(\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{Tp}}-\/>x,\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{Tm}}-\/>x,\ 1\ -\/\ \mbox{\hyperlink{fp-gmp_8h_a604ab54d018792270d7166b2a57455c4}{fp\_issquare}}(\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{tmp}}));}
\DoxyCodeLine{00123\ }
\DoxyCodeLine{00124\ \ \ \ \ \mbox{\hyperlink{fp-gmp_8h_ad0b6e5afb2fdd4f50fd2714fc59931ab}{fp\_copy}}(\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{Tp}}-\/>z,\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{C\_times\_u\_squared\_minus\_one}});}
\DoxyCodeLine{00125\ \ \ \ \ \mbox{\hyperlink{fp-gmp_8h_ad0b6e5afb2fdd4f50fd2714fc59931ab}{fp\_copy}}(\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{Tm}}-\/>z,\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{C\_times\_u\_squared\_minus\_one}});}
\DoxyCodeLine{00126\ \}}

\end{DoxyCode}


References \mbox{\hyperlink{fp-gmp_8h_source_l00050}{fp\+\_\+0}}, \mbox{\hyperlink{fp-gmp_8h_source_l00048}{fp\+\_\+1}}, \mbox{\hyperlink{fp-gmp_8h_source_l00064}{fp\+\_\+add}}, \mbox{\hyperlink{fp-gmp_8h_source_l00079}{fp\+\_\+copy}}, \mbox{\hyperlink{fp-gmp_8h_source_l00082}{fp\+\_\+cswap}}, \mbox{\hyperlink{fp-gmp_8h_source_l00076}{fp\+\_\+issquare}}, \mbox{\hyperlink{fp-gmp_8h_source_l00070}{fp\+\_\+mul}}, \mbox{\hyperlink{fp-gmp_8h_source_l00073}{fp\+\_\+sqr}}, \mbox{\hyperlink{fp-gmp_8h_source_l00067}{fp\+\_\+sub}}, \mbox{\hyperlink{proj_8h_source_l00019}{proj\+::x}}, and \mbox{\hyperlink{proj_8h_source_l00020}{proj\+::z}}.

