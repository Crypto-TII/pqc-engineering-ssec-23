\doxysection{Cache\+Controller Class Reference}
\hypertarget{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller}{}\label{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller}\index{CacheController@{CacheController}}


Inheritance diagram for Cache\+Controller\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=167pt]{d4/d99/classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for Cache\+Controller\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=167pt]{d4/d5e/classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_a825bbcdc04ed774ca0fbab955fe32abe}{\+\_\+\+\_\+init\+\_\+\+\_\+}} (self, \mbox{\hyperlink{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_a3c138af7067df82c4c4964d42878edc6}{cache}}=None, \mbox{\hyperlink{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_a566ff2b71ecc3fce3ba7ce91f08808a1}{cache\+\_\+etags}}=True, \mbox{\hyperlink{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_a40084e8ae2e834de2fdea3fbf06080af}{serializer}}=None, status\+\_\+codes=None)
\item 
\mbox{\hyperlink{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_a4df701265ac595e8ec442a3a161550d7}{cache\+\_\+url}} (cls, uri)
\item 
\mbox{\hyperlink{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_aa3436f3fb8f51dbef33cc9b6c0cdb419}{parse\+\_\+cache\+\_\+control}} (self, headers)
\item 
\mbox{\hyperlink{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_a95cabb8ee81f870ea342ff7f37c1099b}{cached\+\_\+request}} (self, request)
\item 
\mbox{\hyperlink{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_a4e94e32dc5b0cd56665b14819bf6e41d}{conditional\+\_\+headers}} (self, request)
\item 
\mbox{\hyperlink{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_adf2940445ebbb6f3e630fc743b56a3d3}{cache\+\_\+response}} (self, request, response, body=None, status\+\_\+codes=None)
\item 
\mbox{\hyperlink{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_a5fa9cb6f918a1c6cf11760f42dfa773a}{update\+\_\+cached\+\_\+response}} (self, request, response)
\end{DoxyCompactItemize}
\doxysubsubsection*{Data Fields}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_a3c138af7067df82c4c4964d42878edc6}{cache}} = \mbox{\hyperlink{classpip_1_1__vendor_1_1cachecontrol_1_1cache_1_1_dict_cache}{Dict\+Cache}}() \mbox{\hyperlink{prime__search_8m_acb18b236f7946309bc59d6e3e4e9f27c}{if}} cache is None else cache
\item 
\mbox{\hyperlink{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_a566ff2b71ecc3fce3ba7ce91f08808a1}{cache\+\_\+etags}} = cache\+\_\+etags
\item 
\mbox{\hyperlink{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_a40084e8ae2e834de2fdea3fbf06080af}{serializer}} = serializer or \mbox{\hyperlink{classpip_1_1__vendor_1_1cachecontrol_1_1serialize_1_1_serializer}{Serializer}}()
\item 
\mbox{\hyperlink{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_a1a7faddb48509fdda5785fab66c45b92}{cacheable\+\_\+status\+\_\+codes}} = status\+\_\+codes or (200, 203, 300, 301, 308)
\end{DoxyCompactItemize}
\doxysubsubsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_a435b5d4dcf6badabbf61fe4c47334eac}{\+\_\+urlnorm}} (cls, uri)
\item 
\mbox{\hyperlink{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_a493c66a7e1f68b6f8b70fbf5b610a4c0}{\+\_\+cache\+\_\+set}} (self, \mbox{\hyperlink{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_a4df701265ac595e8ec442a3a161550d7}{cache\+\_\+url}}, request, response, body=None, expires\+\_\+time=None)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\begin{DoxyVerb}An interface to see if request should cached or not.\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{controller_8py_source_l00036}{36}} of file \mbox{\hyperlink{controller_8py_source}{controller.\+py}}.



\label{doc-constructors}
\Hypertarget{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_doc-constructors}
\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_a825bbcdc04ed774ca0fbab955fe32abe}\index{CacheController@{CacheController}!\_\_init\_\_@{\_\_init\_\_}}
\index{\_\_init\_\_@{\_\_init\_\_}!CacheController@{CacheController}}
\doxysubsubsection{\texorpdfstring{\_\_init\_\_()}{\_\_init\_\_()}}
{\footnotesize\ttfamily \label{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_a825bbcdc04ed774ca0fbab955fe32abe} 
\+\_\+\+\_\+init\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self}{, }\item[{}]{cache}{ = {\ttfamily None}, }\item[{}]{cache\+\_\+etags}{ = {\ttfamily True}, }\item[{}]{serializer}{ = {\ttfamily None}, }\item[{}]{status\+\_\+codes}{ = {\ttfamily None}}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{controller_8py_source_l00039}{39}} of file \mbox{\hyperlink{controller_8py_source}{controller.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00041\ \ \ \ \ ):}
\DoxyCodeLine{00042\ \ \ \ \ \ \ \ \ self.cache\ =\ DictCache()\ \textcolor{keywordflow}{if}\ cache\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}\ \textcolor{keywordflow}{else}\ cache}
\DoxyCodeLine{00043\ \ \ \ \ \ \ \ \ self.cache\_etags\ =\ cache\_etags}
\DoxyCodeLine{00044\ \ \ \ \ \ \ \ \ self.serializer\ =\ serializer\ \textcolor{keywordflow}{or}\ Serializer()}
\DoxyCodeLine{00045\ \ \ \ \ \ \ \ \ self.cacheable\_status\_codes\ =\ status\_codes\ \textcolor{keywordflow}{or}\ (200,\ 203,\ 300,\ 301,\ 308)}
\DoxyCodeLine{00046\ }

\end{DoxyCode}


\label{doc-func-members}
\Hypertarget{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_doc-func-members}
\doxysubsection{Member Function Documentation}
\Hypertarget{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_a493c66a7e1f68b6f8b70fbf5b610a4c0}\index{CacheController@{CacheController}!\_cache\_set@{\_cache\_set}}
\index{\_cache\_set@{\_cache\_set}!CacheController@{CacheController}}
\doxysubsubsection{\texorpdfstring{\_cache\_set()}{\_cache\_set()}}
{\footnotesize\ttfamily \label{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_a493c66a7e1f68b6f8b70fbf5b610a4c0} 
\+\_\+cache\+\_\+set (\begin{DoxyParamCaption}\item[{}]{self}{, }\item[{}]{cache\+\_\+url}{, }\item[{}]{request}{, }\item[{}]{response}{, }\item[{}]{body}{ = {\ttfamily None}, }\item[{}]{expires\+\_\+time}{ = {\ttfamily None}}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}

\begin{DoxyVerb}Store the data in the cache.
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{controller_8py_source_l00258}{258}} of file \mbox{\hyperlink{controller_8py_source}{controller.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00258\ \ \ \ \ \textcolor{keyword}{def\ }\_cache\_set(self,\ cache\_url,\ request,\ response,\ body=None,\ expires\_time=None):}
\DoxyCodeLine{00259\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{00260\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Store\ the\ data\ in\ the\ cache.}}
\DoxyCodeLine{00261\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{00262\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ isinstance(self.cache,\ SeparateBodyBaseCache):}
\DoxyCodeLine{00263\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ We\ pass\ in\ the\ body\ separately;\ just\ put\ a\ placeholder\ empty}}
\DoxyCodeLine{00264\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ string\ in\ the\ metadata.}}
\DoxyCodeLine{00265\ \ \ \ \ \ \ \ \ \ \ \ \ self.cache.set(}
\DoxyCodeLine{00266\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cache\_url,}
\DoxyCodeLine{00267\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.serializer.dumps(request,\ response,\ b\textcolor{stringliteral}{"{}"{}}),}
\DoxyCodeLine{00268\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ expires=expires\_time,}
\DoxyCodeLine{00269\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{00270\ \ \ \ \ \ \ \ \ \ \ \ \ self.cache.set\_body(cache\_url,\ body)}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{00272\ \ \ \ \ \ \ \ \ \ \ \ \ self.cache.set(}
\DoxyCodeLine{00273\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cache\_url,}
\DoxyCodeLine{00274\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.serializer.dumps(request,\ response,\ body),}
\DoxyCodeLine{00275\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ expires=expires\_time,}
\DoxyCodeLine{00276\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{00277\ }

\end{DoxyCode}


References \mbox{\hyperlink{adapter_8py_source_l00031}{Cache\+Control\+Adapter.\+cache}}, \mbox{\hyperlink{controller_8py_source_l00042}{cache}}, and \mbox{\hyperlink{controller_8py_source_l00044}{serializer}}.



Referenced by \mbox{\hyperlink{controller_8py_source_l00278}{cache\+\_\+response()}}, and \mbox{\hyperlink{controller_8py_source_l00401}{update\+\_\+cached\+\_\+response()}}.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=309pt]{d4/d39/classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_a493c66a7e1f68b6f8b70fbf5b610a4c0_icgraph}
\end{center}
\end{figure}
\Hypertarget{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_a435b5d4dcf6badabbf61fe4c47334eac}\index{CacheController@{CacheController}!\_urlnorm@{\_urlnorm}}
\index{\_urlnorm@{\_urlnorm}!CacheController@{CacheController}}
\doxysubsubsection{\texorpdfstring{\_urlnorm()}{\_urlnorm()}}
{\footnotesize\ttfamily \label{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_a435b5d4dcf6badabbf61fe4c47334eac} 
\+\_\+urlnorm (\begin{DoxyParamCaption}\item[{}]{cls}{, }\item[{}]{uri}{}\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}

\begin{DoxyVerb}Normalize the URL to create a safe key for the cache\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{controller_8py_source_l00048}{48}} of file \mbox{\hyperlink{controller_8py_source}{controller.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00048\ \ \ \ \ \textcolor{keyword}{def\ }\_urlnorm(cls,\ uri):}
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Normalize\ the\ URL\ to\ create\ a\ safe\ key\ for\ the\ cache"{}"{}"{}}}
\DoxyCodeLine{00050\ \ \ \ \ \ \ \ \ (scheme,\ authority,\ path,\ query,\ fragment)\ =\ parse\_uri(uri)}
\DoxyCodeLine{00051\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ scheme\ \textcolor{keywordflow}{or}\ \textcolor{keywordflow}{not}\ authority:}
\DoxyCodeLine{00052\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ Exception(\textcolor{stringliteral}{"{}Only\ absolute\ URIs\ are\ allowed.\ uri\ =\ \%s"{}}\ \%\ uri)}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00054\ \ \ \ \ \ \ \ \ scheme\ =\ scheme.lower()}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ authority\ =\ authority.lower()}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ path:}
\DoxyCodeLine{00058\ \ \ \ \ \ \ \ \ \ \ \ \ path\ =\ \textcolor{stringliteral}{"{}/"{}}}
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00060\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Could\ do\ syntax\ based\ normalization\ of\ the\ URI\ before}}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ computing\ the\ digest.\ See\ Section\ 6.2.2\ of\ Std\ 66.}}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ request\_uri\ =\ query\ \textcolor{keywordflow}{and}\ \textcolor{stringliteral}{"{}?"{}}.join([path,\ query])\ \textcolor{keywordflow}{or}\ path}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ defrag\_uri\ =\ scheme\ +\ \textcolor{stringliteral}{"{}://"{}}\ +\ authority\ +\ request\_uri}
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ defrag\_uri}
\DoxyCodeLine{00066\ }

\end{DoxyCode}


References \mbox{\hyperlink{controller_8py_source_l00027}{pip.\+\_\+vendor.\+cachecontrol.\+controller.\+parse\+\_\+uri()}}.



Referenced by \mbox{\hyperlink{controller_8py_source_l00068}{cache\+\_\+url()}}.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d4/d39/classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_a435b5d4dcf6badabbf61fe4c47334eac_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d4/d39/classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_a435b5d4dcf6badabbf61fe4c47334eac_icgraph}
\end{center}
\end{figure}
\Hypertarget{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_adf2940445ebbb6f3e630fc743b56a3d3}\index{CacheController@{CacheController}!cache\_response@{cache\_response}}
\index{cache\_response@{cache\_response}!CacheController@{CacheController}}
\doxysubsubsection{\texorpdfstring{cache\_response()}{cache\_response()}}
{\footnotesize\ttfamily \label{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_adf2940445ebbb6f3e630fc743b56a3d3} 
cache\+\_\+response (\begin{DoxyParamCaption}\item[{}]{self}{, }\item[{}]{request}{, }\item[{}]{response}{, }\item[{}]{body}{ = {\ttfamily None}, }\item[{}]{status\+\_\+codes}{ = {\ttfamily None}}\end{DoxyParamCaption})}

\begin{DoxyVerb}Algorithm for caching requests.

This assumes a requests Response object.
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{controller_8py_source_l00278}{278}} of file \mbox{\hyperlink{controller_8py_source}{controller.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00278\ \ \ \ \ \textcolor{keyword}{def\ }cache\_response(self,\ request,\ response,\ body=None,\ status\_codes=None):}
\DoxyCodeLine{00279\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{00280\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Algorithm\ for\ caching\ requests.}}
\DoxyCodeLine{00281\ \textcolor{stringliteral}{}}
\DoxyCodeLine{00282\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ This\ assumes\ a\ requests\ Response\ object.}}
\DoxyCodeLine{00283\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{00284\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ From\ httplib2:\ Don't\ cache\ 206's\ since\ we\ aren't\ going\ to}}
\DoxyCodeLine{00285\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ handle\ byte\ range\ requests}}
\DoxyCodeLine{00286\ \ \ \ \ \ \ \ \ cacheable\_status\_codes\ =\ status\_codes\ \textcolor{keywordflow}{or}\ self.cacheable\_status\_codes}
\DoxyCodeLine{00287\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ response.status\ \textcolor{keywordflow}{not}\ \textcolor{keywordflow}{in}\ cacheable\_status\_codes:}
\DoxyCodeLine{00288\ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(}
\DoxyCodeLine{00289\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Status\ code\ \%s\ not\ in\ \%s"{}},\ response.status,\ cacheable\_status\_codes}
\DoxyCodeLine{00290\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{00291\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}}
\DoxyCodeLine{00292\ }
\DoxyCodeLine{00293\ \ \ \ \ \ \ \ \ response\_headers\ =\ CaseInsensitiveDict(response.headers)}
\DoxyCodeLine{00294\ }
\DoxyCodeLine{00295\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{stringliteral}{"{}date"{}}\ \textcolor{keywordflow}{in}\ response\_headers:}
\DoxyCodeLine{00296\ \ \ \ \ \ \ \ \ \ \ \ \ date\ =\ calendar.timegm(parsedate\_tz(response\_headers[\textcolor{stringliteral}{"{}date"{}}]))}
\DoxyCodeLine{00297\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \ \ \ \ \ \ date\ =\ 0}
\DoxyCodeLine{00299\ }
\DoxyCodeLine{00300\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ If\ we've\ been\ given\ a\ body,\ our\ response\ has\ a\ Content-\/Length,\ that}}
\DoxyCodeLine{00301\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Content-\/Length\ is\ valid\ then\ we\ can\ check\ to\ see\ if\ the\ body\ we've}}
\DoxyCodeLine{00302\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ been\ given\ matches\ the\ expected\ size,\ and\ if\ it\ doesn't\ we'll\ just}}
\DoxyCodeLine{00303\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ skip\ trying\ to\ cache\ it.}}
\DoxyCodeLine{00304\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (}
\DoxyCodeLine{00305\ \ \ \ \ \ \ \ \ \ \ \ \ body\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{00306\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{and}\ \textcolor{stringliteral}{"{}content-\/length"{}}\ \textcolor{keywordflow}{in}\ response\_headers}
\DoxyCodeLine{00307\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{and}\ response\_headers[\textcolor{stringliteral}{"{}content-\/length"{}}].isdigit()}
\DoxyCodeLine{00308\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{and}\ int(response\_headers[\textcolor{stringliteral}{"{}content-\/length"{}}])\ !=\ len(body)}
\DoxyCodeLine{00309\ \ \ \ \ \ \ \ \ ):}
\DoxyCodeLine{00310\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}}
\DoxyCodeLine{00311\ }
\DoxyCodeLine{00312\ \ \ \ \ \ \ \ \ cc\_req\ =\ self.parse\_cache\_control(request.headers)}
\DoxyCodeLine{00313\ \ \ \ \ \ \ \ \ cc\ =\ self.parse\_cache\_control(response\_headers)}
\DoxyCodeLine{00314\ }
\DoxyCodeLine{00315\ \ \ \ \ \ \ \ \ cache\_url\ =\ self.cache\_url(request.url)}
\DoxyCodeLine{00316\ \ \ \ \ \ \ \ \ logger.debug(\textcolor{stringliteral}{'Updating\ cache\ with\ response\ from\ "{}\%s"{}'},\ cache\_url)}
\DoxyCodeLine{00317\ }
\DoxyCodeLine{00318\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Delete\ it\ from\ the\ cache\ if\ we\ happen\ to\ have\ it\ stored\ there}}
\DoxyCodeLine{00319\ \ \ \ \ \ \ \ \ no\_store\ =\ \textcolor{keyword}{False}}
\DoxyCodeLine{00320\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{stringliteral}{"{}no-\/store"{}}\ \textcolor{keywordflow}{in}\ cc:}
\DoxyCodeLine{00321\ \ \ \ \ \ \ \ \ \ \ \ \ no\_store\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{00322\ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(\textcolor{stringliteral}{'Response\ header\ has\ "{}no-\/store"{}'})}
\DoxyCodeLine{00323\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{stringliteral}{"{}no-\/store"{}}\ \textcolor{keywordflow}{in}\ cc\_req:}
\DoxyCodeLine{00324\ \ \ \ \ \ \ \ \ \ \ \ \ no\_store\ =\ \textcolor{keyword}{True}}
\DoxyCodeLine{00325\ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(\textcolor{stringliteral}{'Request\ header\ has\ "{}no-\/store"{}'})}
\DoxyCodeLine{00326\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ no\_store\ \textcolor{keywordflow}{and}\ self.cache.get(cache\_url):}
\DoxyCodeLine{00327\ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(\textcolor{stringliteral}{'Purging\ existing\ cache\ entry\ to\ honor\ "{}no-\/store"{}'})}
\DoxyCodeLine{00328\ \ \ \ \ \ \ \ \ \ \ \ \ self.cache.delete(cache\_url)}
\DoxyCodeLine{00329\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ no\_store:}
\DoxyCodeLine{00330\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}}
\DoxyCodeLine{00331\ }
\DoxyCodeLine{00332\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ https://tools.ietf.org/html/rfc7234\#section-\/4.1:}}
\DoxyCodeLine{00333\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ A\ Vary\ header\ field-\/value\ of\ "{}*"{}\ always\ fails\ to\ match.}}
\DoxyCodeLine{00334\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Storing\ such\ a\ response\ leads\ to\ a\ deserialization\ warning}}
\DoxyCodeLine{00335\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ during\ cache\ lookup\ and\ is\ not\ allowed\ to\ ever\ be\ served,}}
\DoxyCodeLine{00336\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ so\ storing\ it\ can\ be\ avoided.}}
\DoxyCodeLine{00337\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{stringliteral}{"{}*"{}}\ \textcolor{keywordflow}{in}\ response\_headers.get(\textcolor{stringliteral}{"{}vary"{}},\ \textcolor{stringliteral}{"{}"{}}):}
\DoxyCodeLine{00338\ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(\textcolor{stringliteral}{'Response\ header\ has\ "{}Vary:\ *"{}'})}
\DoxyCodeLine{00339\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}}
\DoxyCodeLine{00340\ }
\DoxyCodeLine{00341\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ If\ we've\ been\ given\ an\ etag,\ then\ keep\ the\ response}}
\DoxyCodeLine{00342\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ self.cache\_etags\ \textcolor{keywordflow}{and}\ \textcolor{stringliteral}{"{}etag"{}}\ \textcolor{keywordflow}{in}\ response\_headers:}
\DoxyCodeLine{00343\ \ \ \ \ \ \ \ \ \ \ \ \ expires\_time\ =\ 0}
\DoxyCodeLine{00344\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ response\_headers.get(\textcolor{stringliteral}{"{}expires"{}}):}
\DoxyCodeLine{00345\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ expires\ =\ parsedate\_tz(response\_headers[\textcolor{stringliteral}{"{}expires"{}}])}
\DoxyCodeLine{00346\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ expires\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{00347\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ expires\_time\ =\ calendar.timegm(expires)\ -\/\ date}
\DoxyCodeLine{00348\ }
\DoxyCodeLine{00349\ \ \ \ \ \ \ \ \ \ \ \ \ expires\_time\ =\ max(expires\_time,\ 14\ *\ 86400)}
\DoxyCodeLine{00350\ }
\DoxyCodeLine{00351\ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(\textcolor{stringliteral}{"{}etag\ object\ cached\ for\ \{0\}\ seconds"{}}.format(expires\_time))}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(\textcolor{stringliteral}{"{}Caching\ due\ to\ etag"{}})}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \ \ \ \ \ \ self.\_cache\_set(cache\_url,\ request,\ response,\ body,\ expires\_time)}
\DoxyCodeLine{00354\ }
\DoxyCodeLine{00355\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Add\ to\ the\ cache\ any\ permanent\ redirects.\ We\ do\ this\ before\ looking}}
\DoxyCodeLine{00356\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ that\ the\ Date\ headers.}}
\DoxyCodeLine{00357\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ int(response.status)\ \textcolor{keywordflow}{in}\ PERMANENT\_REDIRECT\_STATUSES:}
\DoxyCodeLine{00358\ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(\textcolor{stringliteral}{"{}Caching\ permanent\ redirect"{}})}
\DoxyCodeLine{00359\ \ \ \ \ \ \ \ \ \ \ \ \ self.\_cache\_set(cache\_url,\ request,\ response,\ b\textcolor{stringliteral}{"{}"{}})}
\DoxyCodeLine{00360\ }
\DoxyCodeLine{00361\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Add\ to\ the\ cache\ if\ the\ response\ headers\ demand\ it.\ If\ there}}
\DoxyCodeLine{00362\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ is\ no\ date\ header\ then\ we\ can't\ do\ anything\ about\ expiring}}
\DoxyCodeLine{00363\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ the\ cache.}}
\DoxyCodeLine{00364\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ \textcolor{stringliteral}{"{}date"{}}\ \textcolor{keywordflow}{in}\ response\_headers:}
\DoxyCodeLine{00365\ \ \ \ \ \ \ \ \ \ \ \ \ date\ =\ calendar.timegm(parsedate\_tz(response\_headers[\textcolor{stringliteral}{"{}date"{}}]))}
\DoxyCodeLine{00366\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ cache\ when\ there\ is\ a\ max-\/age\ >\ 0}}
\DoxyCodeLine{00367\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{stringliteral}{"{}max-\/age"{}}\ \textcolor{keywordflow}{in}\ cc\ \textcolor{keywordflow}{and}\ cc[\textcolor{stringliteral}{"{}max-\/age"{}}]\ >\ 0:}
\DoxyCodeLine{00368\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(\textcolor{stringliteral}{"{}Caching\ b/c\ date\ exists\ and\ max-\/age\ >\ 0"{}})}
\DoxyCodeLine{00369\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ expires\_time\ =\ cc[\textcolor{stringliteral}{"{}max-\/age"{}}]}
\DoxyCodeLine{00370\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.\_cache\_set(}
\DoxyCodeLine{00371\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cache\_url,}
\DoxyCodeLine{00372\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ request,}
\DoxyCodeLine{00373\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ response,}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ body,}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ expires\_time,}
\DoxyCodeLine{00376\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{00377\ }
\DoxyCodeLine{00378\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ If\ the\ request\ can\ expire,\ it\ means\ we\ should\ cache\ it}}
\DoxyCodeLine{00379\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ in\ the\ meantime.}}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ \textcolor{stringliteral}{"{}expires"{}}\ \textcolor{keywordflow}{in}\ response\_headers:}
\DoxyCodeLine{00381\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ response\_headers[\textcolor{stringliteral}{"{}expires"{}}]:}
\DoxyCodeLine{00382\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ expires\ =\ parsedate\_tz(response\_headers[\textcolor{stringliteral}{"{}expires"{}}])}
\DoxyCodeLine{00383\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ expires\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{00384\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ expires\_time\ =\ calendar.timegm(expires)\ -\/\ date}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{00386\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ expires\_time\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{00387\ }
\DoxyCodeLine{00388\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(}
\DoxyCodeLine{00389\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Caching\ b/c\ of\ expires\ header.\ expires\ in\ \{0\}\ seconds"{}}.format(}
\DoxyCodeLine{00390\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ expires\_time}
\DoxyCodeLine{00391\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{00392\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{00393\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.\_cache\_set(}
\DoxyCodeLine{00394\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ cache\_url,}
\DoxyCodeLine{00395\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ request,}
\DoxyCodeLine{00396\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ response,}
\DoxyCodeLine{00397\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ body,}
\DoxyCodeLine{00398\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ expires\_time,}
\DoxyCodeLine{00399\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{00400\ }

\end{DoxyCode}


References \mbox{\hyperlink{controller_8py_source_l00258}{\+\_\+cache\+\_\+set()}}, \mbox{\hyperlink{adapter_8py_source_l00031}{Cache\+Control\+Adapter.\+cache}}, \mbox{\hyperlink{controller_8py_source_l00042}{cache}}, \mbox{\hyperlink{controller_8py_source_l00043}{cache\+\_\+etags}}, \mbox{\hyperlink{controller_8py_source_l00068}{cache\+\_\+url()}}, \mbox{\hyperlink{controller_8py_source_l00045}{cacheable\+\_\+status\+\_\+codes}}, and \mbox{\hyperlink{controller_8py_source_l00071}{parse\+\_\+cache\+\_\+control()}}.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d4/d39/classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_adf2940445ebbb6f3e630fc743b56a3d3_cgraph}
\end{center}
\end{figure}
\Hypertarget{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_a4df701265ac595e8ec442a3a161550d7}\index{CacheController@{CacheController}!cache\_url@{cache\_url}}
\index{cache\_url@{cache\_url}!CacheController@{CacheController}}
\doxysubsubsection{\texorpdfstring{cache\_url()}{cache\_url()}}
{\footnotesize\ttfamily \label{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_a4df701265ac595e8ec442a3a161550d7} 
cache\+\_\+url (\begin{DoxyParamCaption}\item[{}]{cls}{, }\item[{}]{uri}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{controller_8py_source_l00068}{68}} of file \mbox{\hyperlink{controller_8py_source}{controller.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00068\ \ \ \ \ \textcolor{keyword}{def\ }cache\_url(cls,\ uri):}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ cls.\_urlnorm(uri)}
\DoxyCodeLine{00070\ }

\end{DoxyCode}


References \mbox{\hyperlink{controller_8py_source_l00048}{\+\_\+urlnorm()}}.



Referenced by \mbox{\hyperlink{controller_8py_source_l00278}{cache\+\_\+response()}}, \mbox{\hyperlink{controller_8py_source_l00125}{cached\+\_\+request()}}, \mbox{\hyperlink{controller_8py_source_l00242}{conditional\+\_\+headers()}}, and \mbox{\hyperlink{controller_8py_source_l00401}{update\+\_\+cached\+\_\+response()}}.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d4/d39/classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_a4df701265ac595e8ec442a3a161550d7_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=301pt]{d4/d39/classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_a4df701265ac595e8ec442a3a161550d7_icgraph}
\end{center}
\end{figure}
\Hypertarget{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_a95cabb8ee81f870ea342ff7f37c1099b}\index{CacheController@{CacheController}!cached\_request@{cached\_request}}
\index{cached\_request@{cached\_request}!CacheController@{CacheController}}
\doxysubsubsection{\texorpdfstring{cached\_request()}{cached\_request()}}
{\footnotesize\ttfamily \label{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_a95cabb8ee81f870ea342ff7f37c1099b} 
cached\+\_\+request (\begin{DoxyParamCaption}\item[{}]{self}{, }\item[{}]{request}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}Return a cached response if it exists in the cache, otherwise
return False.
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{controller_8py_source_l00125}{125}} of file \mbox{\hyperlink{controller_8py_source}{controller.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00125\ \ \ \ \ \textcolor{keyword}{def\ }cached\_request(self,\ request):}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{00127\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ Return\ a\ cached\ response\ if\ it\ exists\ in\ the\ cache,\ otherwise}}
\DoxyCodeLine{00128\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ return\ False.}}
\DoxyCodeLine{00129\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ cache\_url\ =\ self.cache\_url(request.url)}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ logger.debug(\textcolor{stringliteral}{'Looking\ up\ "{}\%s"{}\ in\ the\ cache'},\ cache\_url)}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ cc\ =\ self.parse\_cache\_control(request.headers)}
\DoxyCodeLine{00133\ }
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Bail\ out\ if\ the\ request\ insists\ on\ fresh\ data}}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{stringliteral}{"{}no-\/cache"{}}\ \textcolor{keywordflow}{in}\ cc:}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(\textcolor{stringliteral}{'Request\ header\ has\ "{}no-\/cache"{},\ cache\ bypassed'})}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{False}}
\DoxyCodeLine{00138\ }
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{stringliteral}{"{}max-\/age"{}}\ \textcolor{keywordflow}{in}\ cc\ \textcolor{keywordflow}{and}\ cc[\textcolor{stringliteral}{"{}max-\/age"{}}]\ ==\ 0:}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(\textcolor{stringliteral}{'Request\ header\ has\ "{}max\_age"{}\ as\ 0,\ cache\ bypassed'})}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{False}}
\DoxyCodeLine{00142\ }
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Request\ allows\ serving\ from\ the\ cache,\ let's\ see\ if\ we\ find\ something}}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ cache\_data\ =\ self.cache.get(cache\_url)}
\DoxyCodeLine{00145\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ cache\_data\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(\textcolor{stringliteral}{"{}No\ cache\ entry\ available"{}})}
\DoxyCodeLine{00147\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{False}}
\DoxyCodeLine{00148\ }
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ isinstance(self.cache,\ SeparateBodyBaseCache):}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ \ \ \ \ body\_file\ =\ self.cache.get\_body(cache\_url)}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{00152\ \ \ \ \ \ \ \ \ \ \ \ \ body\_file\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{00153\ }
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Check\ whether\ it\ can\ be\ deserialized}}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ resp\ =\ self.serializer.loads(request,\ cache\_data,\ body\_file)}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ resp:}
\DoxyCodeLine{00157\ \ \ \ \ \ \ \ \ \ \ \ \ logger.warning(\textcolor{stringliteral}{"{}Cache\ entry\ deserialization\ failed,\ entry\ ignored"{}})}
\DoxyCodeLine{00158\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{False}}
\DoxyCodeLine{00159\ }
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ If\ we\ have\ a\ cached\ permanent\ redirect,\ return\ it\ immediately.\ We}}
\DoxyCodeLine{00161\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ don't\ need\ to\ test\ our\ response\ for\ other\ headers\ b/c\ it\ is}}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ intrinsically\ "{}cacheable"{}\ as\ it\ is\ Permanent.}}
\DoxyCodeLine{00163\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#}}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ See:}}
\DoxyCodeLine{00165\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ https://tools.ietf.org/html/rfc7231\#section-\/6.4.2}}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#}}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Client\ can\ try\ to\ refresh\ the\ value\ by\ repeating\ the\ request}}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ with\ cache\ busting\ headers\ as\ usual\ (ie\ no-\/cache).}}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ int(resp.status)\ \textcolor{keywordflow}{in}\ PERMANENT\_REDIRECT\_STATUSES:}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ \ \ \ \ msg\ =\ (}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Returning\ cached\ permanent\ redirect\ response\ "{}}}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}(ignoring\ date\ and\ etag\ information)"{}}}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(msg)}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ resp}
\DoxyCodeLine{00176\ }
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ headers\ =\ CaseInsensitiveDict(resp.headers)}
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ headers\ \textcolor{keywordflow}{or}\ \textcolor{stringliteral}{"{}date"{}}\ \textcolor{keywordflow}{not}\ \textcolor{keywordflow}{in}\ headers:}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{stringliteral}{"{}etag"{}}\ \textcolor{keywordflow}{not}\ \textcolor{keywordflow}{in}\ headers:}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Without\ date\ or\ etag,\ the\ cached\ response\ can\ never\ be\ used}}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ and\ should\ be\ deleted.}}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(\textcolor{stringliteral}{"{}Purging\ cached\ response:\ no\ date\ or\ etag"{}})}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ self.cache.delete(cache\_url)}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(\textcolor{stringliteral}{"{}Ignoring\ cached\ response:\ no\ date"{}})}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{False}}
\DoxyCodeLine{00186\ }
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ now\ =\ time.time()}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ date\ =\ calendar.timegm(parsedate\_tz(headers[\textcolor{stringliteral}{"{}date"{}}]))}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ current\_age\ =\ max(0,\ now\ -\/\ date)}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ logger.debug(\textcolor{stringliteral}{"{}Current\ age\ based\ on\ date:\ \%i"{}},\ current\_age)}
\DoxyCodeLine{00191\ }
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ TODO:\ There\ is\ an\ assumption\ that\ the\ result\ will\ be\ a}}
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ urllib3\ response\ object.\ This\ may\ not\ be\ best\ since\ we}}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ could\ probably\ avoid\ instantiating\ or\ constructing\ the}}
\DoxyCodeLine{00195\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ \ \ \ \ \ \ response\ until\ we\ know\ we\ need\ it.}}
\DoxyCodeLine{00196\ \ \ \ \ \ \ \ \ resp\_cc\ =\ self.parse\_cache\_control(headers)}
\DoxyCodeLine{00197\ }
\DoxyCodeLine{00198\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ determine\ freshness}}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ freshness\_lifetime\ =\ 0}
\DoxyCodeLine{00200\ }
\DoxyCodeLine{00201\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Check\ the\ max-\/age\ pragma\ in\ the\ cache\ control\ header}}
\DoxyCodeLine{00202\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{stringliteral}{"{}max-\/age"{}}\ \textcolor{keywordflow}{in}\ resp\_cc:}
\DoxyCodeLine{00203\ \ \ \ \ \ \ \ \ \ \ \ \ freshness\_lifetime\ =\ resp\_cc[\textcolor{stringliteral}{"{}max-\/age"{}}]}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(\textcolor{stringliteral}{"{}Freshness\ lifetime\ from\ max-\/age:\ \%i"{}},\ freshness\_lifetime)}
\DoxyCodeLine{00205\ }
\DoxyCodeLine{00206\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ If\ there\ isn't\ a\ max-\/age,\ check\ for\ an\ expires\ header}}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ \textcolor{stringliteral}{"{}expires"{}}\ \textcolor{keywordflow}{in}\ headers:}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \ \ \ \ \ \ expires\ =\ parsedate\_tz(headers[\textcolor{stringliteral}{"{}expires"{}}])}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ expires\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ expire\_time\ =\ calendar.timegm(expires)\ -\/\ date}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ freshness\_lifetime\ =\ max(0,\ expire\_time)}
\DoxyCodeLine{00212\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(\textcolor{stringliteral}{"{}Freshness\ lifetime\ from\ expires:\ \%i"{}},\ freshness\_lifetime)}
\DoxyCodeLine{00213\ }
\DoxyCodeLine{00214\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Determine\ if\ we\ are\ setting\ freshness\ limit\ in\ the}}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ request.\ Note,\ this\ overrides\ what\ was\ in\ the\ response.}}
\DoxyCodeLine{00216\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{stringliteral}{"{}max-\/age"{}}\ \textcolor{keywordflow}{in}\ cc:}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \ \ \ \ \ \ freshness\_lifetime\ =\ cc[\textcolor{stringliteral}{"{}max-\/age"{}}]}
\DoxyCodeLine{00218\ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(}
\DoxyCodeLine{00219\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Freshness\ lifetime\ from\ request\ max-\/age:\ \%i"{}},\ freshness\_lifetime}
\DoxyCodeLine{00220\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{00221\ }
\DoxyCodeLine{00222\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{stringliteral}{"{}min-\/fresh"{}}\ \textcolor{keywordflow}{in}\ cc:}
\DoxyCodeLine{00223\ \ \ \ \ \ \ \ \ \ \ \ \ min\_fresh\ =\ cc[\textcolor{stringliteral}{"{}min-\/fresh"{}}]}
\DoxyCodeLine{00224\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ adjust\ our\ current\ age\ by\ our\ min\ fresh}}
\DoxyCodeLine{00225\ \ \ \ \ \ \ \ \ \ \ \ \ current\_age\ +=\ min\_fresh}
\DoxyCodeLine{00226\ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(\textcolor{stringliteral}{"{}Adjusted\ current\ age\ from\ min-\/fresh:\ \%i"{}},\ current\_age)}
\DoxyCodeLine{00227\ }
\DoxyCodeLine{00228\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Return\ entry\ if\ it\ is\ fresh\ enough}}
\DoxyCodeLine{00229\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ freshness\_lifetime\ >\ current\_age:}
\DoxyCodeLine{00230\ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(\textcolor{stringliteral}{'The\ response\ is\ "{}fresh"{},\ returning\ cached\ response'})}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(\textcolor{stringliteral}{"{}\%i\ >\ \%i"{}},\ freshness\_lifetime,\ current\_age)}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ resp}
\DoxyCodeLine{00233\ }
\DoxyCodeLine{00234\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ we're\ not\ fresh.\ If\ we\ don't\ have\ an\ Etag,\ clear\ it\ out}}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{stringliteral}{"{}etag"{}}\ \textcolor{keywordflow}{not}\ \textcolor{keywordflow}{in}\ headers:}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(\textcolor{stringliteral}{'The\ cached\ response\ is\ "{}stale"{}\ with\ no\ etag,\ purging'})}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \ \ \ \ \ \ self.cache.delete(cache\_url)}
\DoxyCodeLine{00238\ }
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ return\ the\ original\ handler}}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{False}}
\DoxyCodeLine{00241\ }

\end{DoxyCode}


References \mbox{\hyperlink{adapter_8py_source_l00031}{Cache\+Control\+Adapter.\+cache}}, \mbox{\hyperlink{controller_8py_source_l00042}{cache}}, \mbox{\hyperlink{controller_8py_source_l00068}{cache\+\_\+url()}}, \mbox{\hyperlink{controller_8py_source_l00071}{parse\+\_\+cache\+\_\+control()}}, and \mbox{\hyperlink{controller_8py_source_l00044}{serializer}}.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d4/d39/classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_a95cabb8ee81f870ea342ff7f37c1099b_cgraph}
\end{center}
\end{figure}
\Hypertarget{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_a4e94e32dc5b0cd56665b14819bf6e41d}\index{CacheController@{CacheController}!conditional\_headers@{conditional\_headers}}
\index{conditional\_headers@{conditional\_headers}!CacheController@{CacheController}}
\doxysubsubsection{\texorpdfstring{conditional\_headers()}{conditional\_headers()}}
{\footnotesize\ttfamily \label{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_a4e94e32dc5b0cd56665b14819bf6e41d} 
conditional\+\_\+headers (\begin{DoxyParamCaption}\item[{}]{self}{, }\item[{}]{request}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{controller_8py_source_l00242}{242}} of file \mbox{\hyperlink{controller_8py_source}{controller.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00242\ \ \ \ \ \textcolor{keyword}{def\ }conditional\_headers(self,\ request):}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ cache\_url\ =\ self.cache\_url(request.url)}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ resp\ =\ self.serializer.loads(request,\ self.cache.get(cache\_url))}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ new\_headers\ =\ \{\}}
\DoxyCodeLine{00246\ }
\DoxyCodeLine{00247\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ resp:}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ \ \ \ \ headers\ =\ CaseInsensitiveDict(resp.headers)}
\DoxyCodeLine{00249\ }
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{stringliteral}{"{}etag"{}}\ \textcolor{keywordflow}{in}\ headers:}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ new\_headers[\textcolor{stringliteral}{"{}If-\/None-\/Match"{}}]\ =\ headers[\textcolor{stringliteral}{"{}ETag"{}}]}
\DoxyCodeLine{00252\ }
\DoxyCodeLine{00253\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{stringliteral}{"{}last-\/modified"{}}\ \textcolor{keywordflow}{in}\ headers:}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ new\_headers[\textcolor{stringliteral}{"{}If-\/Modified-\/Since"{}}]\ =\ headers[\textcolor{stringliteral}{"{}Last-\/Modified"{}}]}
\DoxyCodeLine{00255\ }
\DoxyCodeLine{00256\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ new\_headers}
\DoxyCodeLine{00257\ }

\end{DoxyCode}


References \mbox{\hyperlink{adapter_8py_source_l00031}{Cache\+Control\+Adapter.\+cache}}, \mbox{\hyperlink{controller_8py_source_l00042}{cache}}, \mbox{\hyperlink{controller_8py_source_l00068}{cache\+\_\+url()}}, and \mbox{\hyperlink{controller_8py_source_l00044}{serializer}}.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d4/d39/classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_a4e94e32dc5b0cd56665b14819bf6e41d_cgraph}
\end{center}
\end{figure}
\Hypertarget{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_aa3436f3fb8f51dbef33cc9b6c0cdb419}\index{CacheController@{CacheController}!parse\_cache\_control@{parse\_cache\_control}}
\index{parse\_cache\_control@{parse\_cache\_control}!CacheController@{CacheController}}
\doxysubsubsection{\texorpdfstring{parse\_cache\_control()}{parse\_cache\_control()}}
{\footnotesize\ttfamily \label{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_aa3436f3fb8f51dbef33cc9b6c0cdb419} 
parse\+\_\+cache\+\_\+control (\begin{DoxyParamCaption}\item[{}]{self}{, }\item[{}]{headers}{}\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{controller_8py_source_l00071}{71}} of file \mbox{\hyperlink{controller_8py_source}{controller.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00071\ \ \ \ \ \textcolor{keyword}{def\ }parse\_cache\_control(self,\ headers):}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ known\_directives\ =\ \{}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ https://tools.ietf.org/html/rfc7234\#section-\/5.2}}
\DoxyCodeLine{00074\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}max-\/age"{}}:\ (int,\ \textcolor{keyword}{True}),}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}max-\/stale"{}}:\ (int,\ \textcolor{keyword}{False}),}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}min-\/fresh"{}}:\ (int,\ \textcolor{keyword}{True}),}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}no-\/cache"{}}:\ (\textcolor{keywordtype}{None},\ \textcolor{keyword}{False}),}
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}no-\/store"{}}:\ (\textcolor{keywordtype}{None},\ \textcolor{keyword}{False}),}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}no-\/transform"{}}:\ (\textcolor{keywordtype}{None},\ \textcolor{keyword}{False}),}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}only-\/if-\/cached"{}}:\ (\textcolor{keywordtype}{None},\ \textcolor{keyword}{False}),}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}must-\/revalidate"{}}:\ (\textcolor{keywordtype}{None},\ \textcolor{keyword}{False}),}
\DoxyCodeLine{00082\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}public"{}}:\ (\textcolor{keywordtype}{None},\ \textcolor{keyword}{False}),}
\DoxyCodeLine{00083\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}private"{}}:\ (\textcolor{keywordtype}{None},\ \textcolor{keyword}{False}),}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}proxy-\/revalidate"{}}:\ (\textcolor{keywordtype}{None},\ \textcolor{keyword}{False}),}
\DoxyCodeLine{00085\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}s-\/maxage"{}}:\ (int,\ \textcolor{keyword}{True}),}
\DoxyCodeLine{00086\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00087\ }
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ cc\_headers\ =\ headers.get(\textcolor{stringliteral}{"{}cache-\/control"{}},\ headers.get(\textcolor{stringliteral}{"{}Cache-\/Control"{}},\ \textcolor{stringliteral}{"{}"{}}))}
\DoxyCodeLine{00089\ }
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ retval\ =\ \{\}}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ cc\_directive\ \textcolor{keywordflow}{in}\ cc\_headers.split(\textcolor{stringliteral}{"{},"{}}):}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ cc\_directive.strip():}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue}}
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00096\ \ \ \ \ \ \ \ \ \ \ \ \ parts\ =\ cc\_directive.split(\textcolor{stringliteral}{"{}="{}},\ 1)}
\DoxyCodeLine{00097\ \ \ \ \ \ \ \ \ \ \ \ \ directive\ =\ parts[0].strip()}
\DoxyCodeLine{00098\ }
\DoxyCodeLine{00099\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{00100\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ typ,\ required\ =\ known\_directives[directive]}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ KeyError:}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(\textcolor{stringliteral}{"{}Ignoring\ unknown\ cache-\/control\ directive:\ \%s"{}},\ directive)}
\DoxyCodeLine{00103\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue}}
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00105\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ typ\ \textcolor{keywordflow}{or}\ \textcolor{keywordflow}{not}\ required:}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ retval[directive]\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ typ:}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ retval[directive]\ =\ typ(parts[1].strip())}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ IndexError:}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ required:}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Missing\ value\ for\ cache-\/control\ "{}}\ \textcolor{stringliteral}{"{}directive:\ \%s"{}},}
\DoxyCodeLine{00114\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ directive,}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ ValueError:}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ logger.debug(}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Invalid\ value\ for\ cache-\/control\ directive\ "{}}\ \textcolor{stringliteral}{"{}\%s,\ must\ be\ \%s"{}},}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ directive,}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ typ.\_\_name\_\_,}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{00122\ }
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ retval}
\DoxyCodeLine{00124\ }

\end{DoxyCode}


Referenced by \mbox{\hyperlink{controller_8py_source_l00278}{cache\+\_\+response()}}, and \mbox{\hyperlink{controller_8py_source_l00125}{cached\+\_\+request()}}.

Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=309pt]{d4/d39/classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_aa3436f3fb8f51dbef33cc9b6c0cdb419_icgraph}
\end{center}
\end{figure}
\Hypertarget{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_a5fa9cb6f918a1c6cf11760f42dfa773a}\index{CacheController@{CacheController}!update\_cached\_response@{update\_cached\_response}}
\index{update\_cached\_response@{update\_cached\_response}!CacheController@{CacheController}}
\doxysubsubsection{\texorpdfstring{update\_cached\_response()}{update\_cached\_response()}}
{\footnotesize\ttfamily \label{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_a5fa9cb6f918a1c6cf11760f42dfa773a} 
update\+\_\+cached\+\_\+response (\begin{DoxyParamCaption}\item[{}]{self}{, }\item[{}]{request}{, }\item[{}]{response}{}\end{DoxyParamCaption})}

\begin{DoxyVerb}On a 304 we will get a new set of headers that we want to
update our cached value with, assuming we have one.

This should only ever be called when we've sent an ETag and
gotten a 304 as the response.
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{controller_8py_source_l00401}{401}} of file \mbox{\hyperlink{controller_8py_source}{controller.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00401\ \ \ \ \ \textcolor{keyword}{def\ }update\_cached\_response(self,\ request,\ response):}
\DoxyCodeLine{00402\ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}On\ a\ 304\ we\ will\ get\ a\ new\ set\ of\ headers\ that\ we\ want\ to}}
\DoxyCodeLine{00403\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ update\ our\ cached\ value\ with,\ assuming\ we\ have\ one.}}
\DoxyCodeLine{00404\ \textcolor{stringliteral}{}}
\DoxyCodeLine{00405\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ This\ should\ only\ ever\ be\ called\ when\ we've\ sent\ an\ ETag\ and}}
\DoxyCodeLine{00406\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ gotten\ a\ 304\ as\ the\ response.}}
\DoxyCodeLine{00407\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{00408\ \ \ \ \ \ \ \ \ cache\_url\ =\ self.cache\_url(request.url)}
\DoxyCodeLine{00409\ }
\DoxyCodeLine{00410\ \ \ \ \ \ \ \ \ cached\_response\ =\ self.serializer.loads(request,\ self.cache.get(cache\_url))}
\DoxyCodeLine{00411\ }
\DoxyCodeLine{00412\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ cached\_response:}
\DoxyCodeLine{00413\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ we\ didn't\ have\ a\ cached\ response}}
\DoxyCodeLine{00414\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ response}
\DoxyCodeLine{00415\ }
\DoxyCodeLine{00416\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Lets\ update\ our\ headers\ with\ the\ headers\ from\ the\ new\ request:}}
\DoxyCodeLine{00417\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ http://tools.ietf.org/html/draft-\/ietf-\/httpbis-\/p4-\/conditional-\/26\#section-\/4.1}}
\DoxyCodeLine{00418\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#}}
\DoxyCodeLine{00419\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ The\ server\ isn't\ supposed\ to\ send\ headers\ that\ would\ make}}
\DoxyCodeLine{00420\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ the\ cached\ body\ invalid.\ But...\ just\ in\ case,\ we'll\ be\ sure}}
\DoxyCodeLine{00421\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ to\ strip\ out\ ones\ we\ know\ that\ might\ be\ problmatic\ due\ to}}
\DoxyCodeLine{00422\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ typical\ assumptions.}}
\DoxyCodeLine{00423\ \ \ \ \ \ \ \ \ excluded\_headers\ =\ [\textcolor{stringliteral}{"{}content-\/length"{}}]}
\DoxyCodeLine{00424\ }
\DoxyCodeLine{00425\ \ \ \ \ \ \ \ \ cached\_response.headers.update(}
\DoxyCodeLine{00426\ \ \ \ \ \ \ \ \ \ \ \ \ dict(}
\DoxyCodeLine{00427\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (k,\ v)}
\DoxyCodeLine{00428\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ k,\ v\ \textcolor{keywordflow}{in}\ response.headers.items()}
\DoxyCodeLine{00429\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ k.lower()\ \textcolor{keywordflow}{not}\ \textcolor{keywordflow}{in}\ excluded\_headers}
\DoxyCodeLine{00430\ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{00431\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{00432\ }
\DoxyCodeLine{00433\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ we\ want\ a\ 200\ b/c\ we\ have\ content\ via\ the\ cache}}
\DoxyCodeLine{00434\ \ \ \ \ \ \ \ \ cached\_response.status\ =\ 200}
\DoxyCodeLine{00435\ }
\DoxyCodeLine{00436\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ update\ our\ cache}}
\DoxyCodeLine{00437\ \ \ \ \ \ \ \ \ self.\_cache\_set(cache\_url,\ request,\ cached\_response)}
\DoxyCodeLine{00438\ }
\DoxyCodeLine{00439\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ cached\_response}

\end{DoxyCode}


References \mbox{\hyperlink{controller_8py_source_l00258}{\+\_\+cache\+\_\+set()}}, \mbox{\hyperlink{adapter_8py_source_l00031}{Cache\+Control\+Adapter.\+cache}}, \mbox{\hyperlink{controller_8py_source_l00042}{cache}}, \mbox{\hyperlink{controller_8py_source_l00068}{cache\+\_\+url()}}, and \mbox{\hyperlink{controller_8py_source_l00044}{serializer}}.

Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d4/d39/classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_a5fa9cb6f918a1c6cf11760f42dfa773a_cgraph}
\end{center}
\end{figure}


\label{doc-variable-members}
\Hypertarget{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_doc-variable-members}
\doxysubsection{Field Documentation}
\Hypertarget{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_a3c138af7067df82c4c4964d42878edc6}\index{CacheController@{CacheController}!cache@{cache}}
\index{cache@{cache}!CacheController@{CacheController}}
\doxysubsubsection{\texorpdfstring{cache}{cache}}
{\footnotesize\ttfamily \label{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_a3c138af7067df82c4c4964d42878edc6} 
cache = \mbox{\hyperlink{classpip_1_1__vendor_1_1cachecontrol_1_1cache_1_1_dict_cache}{Dict\+Cache}}() \mbox{\hyperlink{prime__search_8m_acb18b236f7946309bc59d6e3e4e9f27c}{if}} cache is None else cache}



Definition at line \mbox{\hyperlink{controller_8py_source_l00042}{42}} of file \mbox{\hyperlink{controller_8py_source}{controller.\+py}}.



Referenced by \mbox{\hyperlink{controller_8py_source_l00258}{\+\_\+cache\+\_\+set()}}, \mbox{\hyperlink{controller_8py_source_l00278}{cache\+\_\+response()}}, \mbox{\hyperlink{controller_8py_source_l00125}{cached\+\_\+request()}}, \mbox{\hyperlink{controller_8py_source_l00242}{conditional\+\_\+headers()}}, and \mbox{\hyperlink{controller_8py_source_l00401}{update\+\_\+cached\+\_\+response()}}.

\Hypertarget{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_a566ff2b71ecc3fce3ba7ce91f08808a1}\index{CacheController@{CacheController}!cache\_etags@{cache\_etags}}
\index{cache\_etags@{cache\_etags}!CacheController@{CacheController}}
\doxysubsubsection{\texorpdfstring{cache\_etags}{cache\_etags}}
{\footnotesize\ttfamily \label{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_a566ff2b71ecc3fce3ba7ce91f08808a1} 
cache\+\_\+etags = cache\+\_\+etags}



Definition at line \mbox{\hyperlink{controller_8py_source_l00043}{43}} of file \mbox{\hyperlink{controller_8py_source}{controller.\+py}}.



Referenced by \mbox{\hyperlink{controller_8py_source_l00278}{cache\+\_\+response()}}.

\Hypertarget{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_a1a7faddb48509fdda5785fab66c45b92}\index{CacheController@{CacheController}!cacheable\_status\_codes@{cacheable\_status\_codes}}
\index{cacheable\_status\_codes@{cacheable\_status\_codes}!CacheController@{CacheController}}
\doxysubsubsection{\texorpdfstring{cacheable\_status\_codes}{cacheable\_status\_codes}}
{\footnotesize\ttfamily \label{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_a1a7faddb48509fdda5785fab66c45b92} 
cacheable\+\_\+status\+\_\+codes = status\+\_\+codes or (200, 203, 300, 301, 308)}



Definition at line \mbox{\hyperlink{controller_8py_source_l00045}{45}} of file \mbox{\hyperlink{controller_8py_source}{controller.\+py}}.



Referenced by \mbox{\hyperlink{controller_8py_source_l00278}{cache\+\_\+response()}}.

\Hypertarget{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_a40084e8ae2e834de2fdea3fbf06080af}\index{CacheController@{CacheController}!serializer@{serializer}}
\index{serializer@{serializer}!CacheController@{CacheController}}
\doxysubsubsection{\texorpdfstring{serializer}{serializer}}
{\footnotesize\ttfamily \label{classpip_1_1__vendor_1_1cachecontrol_1_1controller_1_1_cache_controller_a40084e8ae2e834de2fdea3fbf06080af} 
serializer = serializer or \mbox{\hyperlink{classpip_1_1__vendor_1_1cachecontrol_1_1serialize_1_1_serializer}{Serializer}}()}



Definition at line \mbox{\hyperlink{controller_8py_source_l00044}{44}} of file \mbox{\hyperlink{controller_8py_source}{controller.\+py}}.



Referenced by \mbox{\hyperlink{controller_8py_source_l00258}{\+\_\+cache\+\_\+set()}}, \mbox{\hyperlink{controller_8py_source_l00125}{cached\+\_\+request()}}, \mbox{\hyperlink{controller_8py_source_l00242}{conditional\+\_\+headers()}}, and \mbox{\hyperlink{controller_8py_source_l00401}{update\+\_\+cached\+\_\+response()}}.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
E\+:/pqc-\/engineering-\/ssec-\/23/venv/lib/python3.\+12/site-\/packages/pip/\+\_\+vendor/cachecontrol/\mbox{\hyperlink{controller_8py}{controller.\+py}}\end{DoxyCompactItemize}
