\doxysection{pip.\+\_\+internal.\+utils.\+unpacking Namespace Reference}
\hypertarget{namespacepip_1_1__internal_1_1utils_1_1unpacking}{}\label{namespacepip_1_1__internal_1_1utils_1_1unpacking}\index{pip.\_internal.utils.unpacking@{pip.\_internal.utils.unpacking}}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \mbox{\hyperlink{namespacepip_1_1__internal_1_1utils_1_1unpacking_af0f6c2a138b90a3f8509e104e711247a}{current\+\_\+umask}} ()
\item 
List\mbox{[}str\mbox{]} \mbox{\hyperlink{namespacepip_1_1__internal_1_1utils_1_1unpacking_a00692ba5e206beb08b428fba04480597}{split\+\_\+leading\+\_\+dir}} (str path)
\item 
bool \mbox{\hyperlink{namespacepip_1_1__internal_1_1utils_1_1unpacking_a37780b46b0d1d9317c8eccf175225dc5}{has\+\_\+leading\+\_\+dir}} (Iterable\mbox{[}str\mbox{]} \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{paths}})
\item 
bool \mbox{\hyperlink{namespacepip_1_1__internal_1_1utils_1_1unpacking_a35e36944c8599945de0120df6ebfb1b6}{is\+\_\+within\+\_\+directory}} (str directory, str target)
\item 
\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{None}} \mbox{\hyperlink{namespacepip_1_1__internal_1_1utils_1_1unpacking_a45246969f08c73a1507a2ffaee1178fd}{set\+\_\+extracted\+\_\+file\+\_\+to\+\_\+default\+\_\+mode\+\_\+plus\+\_\+executable}} (str path)
\item 
bool \mbox{\hyperlink{namespacepip_1_1__internal_1_1utils_1_1unpacking_ae4f7ac75282bfddedfd46778640a939b}{zip\+\_\+item\+\_\+is\+\_\+executable}} (Zip\+Info info)
\item 
\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{None}} \mbox{\hyperlink{namespacepip_1_1__internal_1_1utils_1_1unpacking_ac3a79feb22c41075d3280473b06ed62b}{unzip\+\_\+file}} (str filename, str location, bool \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{flatten}}=True)
\item 
\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{None}} \mbox{\hyperlink{namespacepip_1_1__internal_1_1utils_1_1unpacking_aeeaa12c1dac293795c7407df64bb96b8}{untar\+\_\+file}} (str filename, str location)
\item 
\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{None}} \mbox{\hyperlink{namespacepip_1_1__internal_1_1utils_1_1unpacking_a2e4ec14ef37f131edfc2e29f087047e7}{unpack\+\_\+file}} (str filename, str location, Optional\mbox{[}str\mbox{]} content\+\_\+type=\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{None}})
\end{DoxyCompactItemize}
\doxysubsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacepip_1_1__internal_1_1utils_1_1unpacking_a0b14e488ae28d98d262453f3e9cd6e4d}{logger}} = logging.\+get\+Logger(\+\_\+\+\_\+name\+\_\+\+\_\+)
\item 
\mbox{\hyperlink{namespacepip_1_1__internal_1_1utils_1_1unpacking_a2d49e2978a121bad364ce115163cc52a}{SUPPORTED\+\_\+\+EXTENSIONS}} = ZIP\+\_\+\+EXTENSIONS + TAR\+\_\+\+EXTENSIONS
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\begin{DoxyVerb}Utilities related archives.
\end{DoxyVerb}
 

\doxysubsection{Function Documentation}
\Hypertarget{namespacepip_1_1__internal_1_1utils_1_1unpacking_af0f6c2a138b90a3f8509e104e711247a}\label{namespacepip_1_1__internal_1_1utils_1_1unpacking_af0f6c2a138b90a3f8509e104e711247a} 
\index{pip.\_internal.utils.unpacking@{pip.\_internal.utils.unpacking}!current\_umask@{current\_umask}}
\index{current\_umask@{current\_umask}!pip.\_internal.utils.unpacking@{pip.\_internal.utils.unpacking}}
\doxysubsubsection{\texorpdfstring{current\_umask()}{current\_umask()}}
{\footnotesize\ttfamily  int current\+\_\+umask (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})}

\begin{DoxyVerb}Get the current umask which involves having to set it temporarily.\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{unpacking_8py_source_l00043}{43}} of file \mbox{\hyperlink{unpacking_8py_source}{unpacking.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00043\ \textcolor{keyword}{def\ }current\_umask()\ -\/>\ int:}
\DoxyCodeLine{00044\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Get\ the\ current\ umask\ which\ involves\ having\ to\ set\ it\ temporarily."{}"{}"{}}}
\DoxyCodeLine{00045\ \ \ \ \ mask\ =\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{os.umask}}(0)}
\DoxyCodeLine{00046\ \ \ \ \ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{os.umask}}(mask)}
\DoxyCodeLine{00047\ \ \ \ \ \textcolor{keywordflow}{return}\ mask}
\DoxyCodeLine{00048\ }
\DoxyCodeLine{00049\ }

\end{DoxyCode}


References \mbox{\hyperlink{prime__search_8m_source_l00010}{i}}.



Referenced by \mbox{\hyperlink{unpacking_8py_source_l00088}{pip.\+\_\+internal.\+utils.\+unpacking.\+set\+\_\+extracted\+\_\+file\+\_\+to\+\_\+default\+\_\+mode\+\_\+plus\+\_\+executable()}}.

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=335pt]{d8/d22/namespacepip_1_1__internal_1_1utils_1_1unpacking_af0f6c2a138b90a3f8509e104e711247a_icgraph}
\end{center}
\end{figure}
\Hypertarget{namespacepip_1_1__internal_1_1utils_1_1unpacking_a37780b46b0d1d9317c8eccf175225dc5}\label{namespacepip_1_1__internal_1_1utils_1_1unpacking_a37780b46b0d1d9317c8eccf175225dc5} 
\index{pip.\_internal.utils.unpacking@{pip.\_internal.utils.unpacking}!has\_leading\_dir@{has\_leading\_dir}}
\index{has\_leading\_dir@{has\_leading\_dir}!pip.\_internal.utils.unpacking@{pip.\_internal.utils.unpacking}}
\doxysubsubsection{\texorpdfstring{has\_leading\_dir()}{has\_leading\_dir()}}
{\footnotesize\ttfamily  bool has\+\_\+leading\+\_\+dir (\begin{DoxyParamCaption}\item[{Iterable\mbox{[}str\mbox{]}}]{paths }\end{DoxyParamCaption})}

\begin{DoxyVerb}Returns true if all the paths have the same leading path name
(i.e., everything is in one subdirectory in an archive)\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{unpacking_8py_source_l00062}{62}} of file \mbox{\hyperlink{unpacking_8py_source}{unpacking.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00062\ \textcolor{keyword}{def\ }has\_leading\_dir(paths:\ Iterable[str])\ -\/>\ bool:}
\DoxyCodeLine{00063\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Returns\ true\ if\ all\ the\ paths\ have\ the\ same\ leading\ path\ name}}
\DoxyCodeLine{00064\ \textcolor{stringliteral}{\ \ \ \ (i.e.,\ everything\ is\ in\ one\ subdirectory\ in\ an\ archive)"{}"{}"{}}}
\DoxyCodeLine{00065\ \ \ \ \ common\_prefix\ =\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{00066\ \ \ \ \ \textcolor{keywordflow}{for}\ path\ \textcolor{keywordflow}{in}\ paths:}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ prefix,\ rest\ =\ split\_leading\_dir(path)}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ prefix:}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{False}}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ common\_prefix\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \ \ \ \ common\_prefix\ =\ prefix}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ prefix\ !=\ common\_prefix:}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{False}}
\DoxyCodeLine{00074\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{True}}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00076\ }

\end{DoxyCode}


References \mbox{\hyperlink{unpacking_8py_source_l00050}{pip.\+\_\+internal.\+utils.\+unpacking.\+split\+\_\+leading\+\_\+dir()}}.



Referenced by \mbox{\hyperlink{unpacking_8py_source_l00149}{pip.\+\_\+internal.\+utils.\+unpacking.\+untar\+\_\+file()}}, and \mbox{\hyperlink{unpacking_8py_source_l00103}{pip.\+\_\+internal.\+utils.\+unpacking.\+unzip\+\_\+file()}}.

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=285pt]{d8/d22/namespacepip_1_1__internal_1_1utils_1_1unpacking_a37780b46b0d1d9317c8eccf175225dc5_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d22/namespacepip_1_1__internal_1_1utils_1_1unpacking_a37780b46b0d1d9317c8eccf175225dc5_icgraph}
\end{center}
\end{figure}
\Hypertarget{namespacepip_1_1__internal_1_1utils_1_1unpacking_a35e36944c8599945de0120df6ebfb1b6}\label{namespacepip_1_1__internal_1_1utils_1_1unpacking_a35e36944c8599945de0120df6ebfb1b6} 
\index{pip.\_internal.utils.unpacking@{pip.\_internal.utils.unpacking}!is\_within\_directory@{is\_within\_directory}}
\index{is\_within\_directory@{is\_within\_directory}!pip.\_internal.utils.unpacking@{pip.\_internal.utils.unpacking}}
\doxysubsubsection{\texorpdfstring{is\_within\_directory()}{is\_within\_directory()}}
{\footnotesize\ttfamily  bool is\+\_\+within\+\_\+directory (\begin{DoxyParamCaption}\item[{str}]{directory,  }\item[{str}]{target }\end{DoxyParamCaption})}

\begin{DoxyVerb}Return true if the absolute path of target is within the directory
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{unpacking_8py_source_l00077}{77}} of file \mbox{\hyperlink{unpacking_8py_source}{unpacking.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00077\ \textcolor{keyword}{def\ }is\_within\_directory(directory:\ str,\ target:\ str)\ -\/>\ bool:}
\DoxyCodeLine{00078\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{00079\ \textcolor{stringliteral}{\ \ \ \ Return\ true\ if\ the\ absolute\ path\ of\ target\ is\ within\ the\ directory}}
\DoxyCodeLine{00080\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{00081\ \ \ \ \ abs\_directory\ =\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{os.path.abspath}}(directory)}
\DoxyCodeLine{00082\ \ \ \ \ abs\_target\ =\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{os.path.abspath}}(target)}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00084\ \ \ \ \ prefix\ =\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{os.path.commonprefix}}([abs\_directory,\ abs\_target])}
\DoxyCodeLine{00085\ \ \ \ \ \textcolor{keywordflow}{return}\ prefix\ ==\ abs\_directory}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00087\ }

\end{DoxyCode}


References \mbox{\hyperlink{prime__search_8m_source_l00010}{i}}.

\Hypertarget{namespacepip_1_1__internal_1_1utils_1_1unpacking_a45246969f08c73a1507a2ffaee1178fd}\label{namespacepip_1_1__internal_1_1utils_1_1unpacking_a45246969f08c73a1507a2ffaee1178fd} 
\index{pip.\_internal.utils.unpacking@{pip.\_internal.utils.unpacking}!set\_extracted\_file\_to\_default\_mode\_plus\_executable@{set\_extracted\_file\_to\_default\_mode\_plus\_executable}}
\index{set\_extracted\_file\_to\_default\_mode\_plus\_executable@{set\_extracted\_file\_to\_default\_mode\_plus\_executable}!pip.\_internal.utils.unpacking@{pip.\_internal.utils.unpacking}}
\doxysubsubsection{\texorpdfstring{set\_extracted\_file\_to\_default\_mode\_plus\_executable()}{set\_extracted\_file\_to\_default\_mode\_plus\_executable()}}
{\footnotesize\ttfamily  \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{None}} set\+\_\+extracted\+\_\+file\+\_\+to\+\_\+default\+\_\+mode\+\_\+plus\+\_\+executable (\begin{DoxyParamCaption}\item[{str}]{path }\end{DoxyParamCaption})}

\begin{DoxyVerb}Make file present at path have execute for user/group/world
(chmod +x) is no-op on windows per python docs
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{unpacking_8py_source_l00088}{88}} of file \mbox{\hyperlink{unpacking_8py_source}{unpacking.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00088\ \textcolor{keyword}{def\ }set\_extracted\_file\_to\_default\_mode\_plus\_executable(path:\ str)\ -\/>\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{00089\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{00090\ \textcolor{stringliteral}{\ \ \ \ Make\ file\ present\ at\ path\ have\ execute\ for\ user/group/world}}
\DoxyCodeLine{00091\ \textcolor{stringliteral}{\ \ \ \ (chmod\ +x)\ is\ no-\/op\ on\ windows\ per\ python\ docs}}
\DoxyCodeLine{00092\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{00093\ \ \ \ \ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{os.chmod}}(path,\ (0o777\ \&\ \string~current\_umask()\ |\ 0o111))}
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00095\ }

\end{DoxyCode}


References \mbox{\hyperlink{unpacking_8py_source_l00043}{pip.\+\_\+internal.\+utils.\+unpacking.\+current\+\_\+umask()}}, and \mbox{\hyperlink{prime__search_8m_source_l00010}{i}}.

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=313pt]{d8/d22/namespacepip_1_1__internal_1_1utils_1_1unpacking_a45246969f08c73a1507a2ffaee1178fd_cgraph}
\end{center}
\end{figure}
\Hypertarget{namespacepip_1_1__internal_1_1utils_1_1unpacking_a00692ba5e206beb08b428fba04480597}\label{namespacepip_1_1__internal_1_1utils_1_1unpacking_a00692ba5e206beb08b428fba04480597} 
\index{pip.\_internal.utils.unpacking@{pip.\_internal.utils.unpacking}!split\_leading\_dir@{split\_leading\_dir}}
\index{split\_leading\_dir@{split\_leading\_dir}!pip.\_internal.utils.unpacking@{pip.\_internal.utils.unpacking}}
\doxysubsubsection{\texorpdfstring{split\_leading\_dir()}{split\_leading\_dir()}}
{\footnotesize\ttfamily  List\mbox{[}str\mbox{]} split\+\_\+leading\+\_\+dir (\begin{DoxyParamCaption}\item[{str}]{path }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{unpacking_8py_source_l00050}{50}} of file \mbox{\hyperlink{unpacking_8py_source}{unpacking.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00050\ \textcolor{keyword}{def\ }split\_leading\_dir(path:\ str)\ -\/>\ List[str]:}
\DoxyCodeLine{00051\ \ \ \ \ path\ =\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{path.lstrip}}(\textcolor{stringliteral}{"{}/"{}}).\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{lstrip}}(\textcolor{stringliteral}{"{}\(\backslash\)\(\backslash\)"{}})}
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{stringliteral}{"{}/"{}}\ \textcolor{keywordflow}{in}\ path\ \textcolor{keywordflow}{and}\ (}
\DoxyCodeLine{00053\ \ \ \ \ \ \ \ \ (\textcolor{stringliteral}{"{}\(\backslash\)\(\backslash\)"{}}\ \textcolor{keywordflow}{in}\ path\ \textcolor{keywordflow}{and}\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{path.find}}(\textcolor{stringliteral}{"{}/"{}})\ <\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{path.find}}(\textcolor{stringliteral}{"{}\(\backslash\)\(\backslash\)"{}}))\ \textcolor{keywordflow}{or}\ \textcolor{stringliteral}{"{}\(\backslash\)\(\backslash\)"{}}\ \textcolor{keywordflow}{not}\ \textcolor{keywordflow}{in}\ path}
\DoxyCodeLine{00054\ \ \ \ \ ):}
\DoxyCodeLine{00055\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{path.split}}(\textcolor{stringliteral}{"{}/"{}},\ 1)}
\DoxyCodeLine{00056\ \ \ \ \ \textcolor{keywordflow}{elif}\ \textcolor{stringliteral}{"{}\(\backslash\)\(\backslash\)"{}}\ \textcolor{keywordflow}{in}\ path:}
\DoxyCodeLine{00057\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{path.split}}(\textcolor{stringliteral}{"{}\(\backslash\)\(\backslash\)"{}},\ 1)}
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{00059\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ [path,\ \textcolor{stringliteral}{"{}"{}}]}
\DoxyCodeLine{00060\ }
\DoxyCodeLine{00061\ }

\end{DoxyCode}


References \mbox{\hyperlink{prime__search_8m_source_l00010}{i}}.



Referenced by \mbox{\hyperlink{unpacking_8py_source_l00062}{pip.\+\_\+internal.\+utils.\+unpacking.\+has\+\_\+leading\+\_\+dir()}}, \mbox{\hyperlink{unpacking_8py_source_l00149}{pip.\+\_\+internal.\+utils.\+unpacking.\+untar\+\_\+file()}}, and \mbox{\hyperlink{unpacking_8py_source_l00103}{pip.\+\_\+internal.\+utils.\+unpacking.\+unzip\+\_\+file()}}.

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d22/namespacepip_1_1__internal_1_1utils_1_1unpacking_a00692ba5e206beb08b428fba04480597_icgraph}
\end{center}
\end{figure}
\Hypertarget{namespacepip_1_1__internal_1_1utils_1_1unpacking_a2e4ec14ef37f131edfc2e29f087047e7}\label{namespacepip_1_1__internal_1_1utils_1_1unpacking_a2e4ec14ef37f131edfc2e29f087047e7} 
\index{pip.\_internal.utils.unpacking@{pip.\_internal.utils.unpacking}!unpack\_file@{unpack\_file}}
\index{unpack\_file@{unpack\_file}!pip.\_internal.utils.unpacking@{pip.\_internal.utils.unpacking}}
\doxysubsubsection{\texorpdfstring{unpack\_file()}{unpack\_file()}}
{\footnotesize\ttfamily  \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{None}} unpack\+\_\+file (\begin{DoxyParamCaption}\item[{str}]{filename,  }\item[{str}]{location,  }\item[{Optional\mbox{[}str\mbox{]} }]{content\+\_\+type = {\ttfamily \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{None}}} }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{unpacking_8py_source_l00229}{229}} of file \mbox{\hyperlink{unpacking_8py_source}{unpacking.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00233\ )\ -\/>\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{00234\ \ \ \ \ filename\ =\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{os.path.realpath}}(filename)}
\DoxyCodeLine{00235\ \ \ \ \ \textcolor{keywordflow}{if}\ (}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ content\_type\ ==\ \textcolor{stringliteral}{"{}application/zip"{}}}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{or}\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{filename.lower}}().\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{endswith}}(ZIP\_EXTENSIONS)}
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{or}\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{zipfile.is\_zipfile}}(filename)}
\DoxyCodeLine{00239\ \ \ \ \ ):}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ unzip\_file(filename,\ location,\ flatten=\textcolor{keywordflow}{not}\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{filename.endswith}}(\textcolor{stringliteral}{"{}.whl"{}}))}
\DoxyCodeLine{00241\ \ \ \ \ \textcolor{keywordflow}{elif}\ (}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ content\_type\ ==\ \textcolor{stringliteral}{"{}application/x-\/gzip"{}}}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{or}\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{tarfile.is\_tarfile}}(filename)}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{or}\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{filename.lower}}().\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{endswith}}(TAR\_EXTENSIONS\ +\ BZ2\_EXTENSIONS\ +\ XZ\_EXTENSIONS)}
\DoxyCodeLine{00245\ \ \ \ \ ):}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ untar\_file(filename,\ location)}
\DoxyCodeLine{00247\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ FIXME:\ handle?}}
\DoxyCodeLine{00249\ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ FIXME:\ magic\ signatures?}}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{logger.critical}}(}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Cannot\ unpack\ file\ \%s\ (downloaded\ from\ \%s,\ content-\/type:\ \%s);\ "{}}}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}cannot\ detect\ archive\ format"{}},}
\DoxyCodeLine{00253\ \ \ \ \ \ \ \ \ \ \ \ \ filename,}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ \ \ \ \ location,}
\DoxyCodeLine{00255\ \ \ \ \ \ \ \ \ \ \ \ \ content\_type,}
\DoxyCodeLine{00256\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{00257\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ InstallationError(f\textcolor{stringliteral}{"{}Cannot\ determine\ archive\ format\ of\ \{location\}"{}})}

\end{DoxyCode}


References \mbox{\hyperlink{prime__search_8m_source_l00010}{i}}, \mbox{\hyperlink{unpacking_8py_source_l00149}{pip.\+\_\+internal.\+utils.\+unpacking.\+untar\+\_\+file()}}, and \mbox{\hyperlink{unpacking_8py_source_l00103}{pip.\+\_\+internal.\+utils.\+unpacking.\+unzip\+\_\+file()}}.

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d22/namespacepip_1_1__internal_1_1utils_1_1unpacking_a2e4ec14ef37f131edfc2e29f087047e7_cgraph}
\end{center}
\end{figure}
\Hypertarget{namespacepip_1_1__internal_1_1utils_1_1unpacking_aeeaa12c1dac293795c7407df64bb96b8}\label{namespacepip_1_1__internal_1_1utils_1_1unpacking_aeeaa12c1dac293795c7407df64bb96b8} 
\index{pip.\_internal.utils.unpacking@{pip.\_internal.utils.unpacking}!untar\_file@{untar\_file}}
\index{untar\_file@{untar\_file}!pip.\_internal.utils.unpacking@{pip.\_internal.utils.unpacking}}
\doxysubsubsection{\texorpdfstring{untar\_file()}{untar\_file()}}
{\footnotesize\ttfamily  \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{None}} untar\+\_\+file (\begin{DoxyParamCaption}\item[{str}]{filename,  }\item[{str}]{location }\end{DoxyParamCaption})}

\begin{DoxyVerb}Untar the file (with path `filename`) to the destination `location`.
All files are written based on system defaults and umask (i.e. permissions
are not preserved), except that regular file members with any execute
permissions (user, group, or world) have "chmod +x" applied after being
written.  Note that for windows, any execute changes using os.chmod are
no-ops per the python docs.
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{unpacking_8py_source_l00149}{149}} of file \mbox{\hyperlink{unpacking_8py_source}{unpacking.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00149\ \textcolor{keyword}{def\ }untar\_file(filename:\ str,\ location:\ str)\ -\/>\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{00150\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{00151\ \textcolor{stringliteral}{\ \ \ \ Untar\ the\ file\ (with\ path\ \`{}filename\`{})\ to\ the\ destination\ \`{}location\`{}.}}
\DoxyCodeLine{00152\ \textcolor{stringliteral}{\ \ \ \ All\ files\ are\ written\ based\ on\ system\ defaults\ and\ umask\ (i.e.\ permissions}}
\DoxyCodeLine{00153\ \textcolor{stringliteral}{\ \ \ \ are\ not\ preserved),\ except\ that\ regular\ file\ members\ with\ any\ execute}}
\DoxyCodeLine{00154\ \textcolor{stringliteral}{\ \ \ \ permissions\ (user,\ group,\ or\ world)\ have\ "{}chmod\ +x"{}\ applied\ after\ being}}
\DoxyCodeLine{00155\ \textcolor{stringliteral}{\ \ \ \ written.\ \ Note\ that\ for\ windows,\ any\ execute\ changes\ using\ os.chmod\ are}}
\DoxyCodeLine{00156\ \textcolor{stringliteral}{\ \ \ \ no-\/ops\ per\ the\ python\ docs.}}
\DoxyCodeLine{00157\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{00158\ \ \ \ \ ensure\_dir(location)}
\DoxyCodeLine{00159\ \ \ \ \ \textcolor{keywordflow}{if}\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{filename.lower}}().\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{endswith}}(\textcolor{stringliteral}{"{}.gz"{}})\ \textcolor{keywordflow}{or}\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{filename.lower}}().\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{endswith}}(\textcolor{stringliteral}{"{}.tgz"{}}):}
\DoxyCodeLine{00160\ \ \ \ \ \ \ \ \ mode\ =\ \textcolor{stringliteral}{"{}r:gz"{}}}
\DoxyCodeLine{00161\ \ \ \ \ \textcolor{keywordflow}{elif}\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{filename.lower}}().\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{endswith}}(BZ2\_EXTENSIONS):}
\DoxyCodeLine{00162\ \ \ \ \ \ \ \ \ mode\ =\ \textcolor{stringliteral}{"{}r:bz2"{}}}
\DoxyCodeLine{00163\ \ \ \ \ \textcolor{keywordflow}{elif}\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{filename.lower}}().\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{endswith}}(XZ\_EXTENSIONS):}
\DoxyCodeLine{00164\ \ \ \ \ \ \ \ \ mode\ =\ \textcolor{stringliteral}{"{}r:xz"{}}}
\DoxyCodeLine{00165\ \ \ \ \ \textcolor{keywordflow}{elif}\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{filename.lower}}().\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{endswith}}(\textcolor{stringliteral}{"{}.tar"{}}):}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ mode\ =\ \textcolor{stringliteral}{"{}r"{}}}
\DoxyCodeLine{00167\ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{logger.warning}}(}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Cannot\ determine\ compression\ type\ for\ file\ \%s"{}},}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ \ \ \ \ filename,}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ mode\ =\ \textcolor{stringliteral}{"{}r:*"{}}}
\DoxyCodeLine{00173\ \ \ \ \ tar\ =\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{tarfile.open}}(filename,\ mode,\ encoding=\textcolor{stringliteral}{"{}utf-\/8"{}})}
\DoxyCodeLine{00174\ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ leading\ =\ has\_leading\_dir([\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{member.name}}\ \textcolor{keywordflow}{for}\ member\ \textcolor{keywordflow}{in}\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{tar.getmembers}}()])}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ member\ \textcolor{keywordflow}{in}\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{tar.getmembers}}():}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \ \ \ \ fn\ =\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{member.name}}}
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ leading:}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fn\ =\ split\_leading\_dir(fn)[1]}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ \ \ \ \ path\ =\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{os.path.join}}(location,\ fn)}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ is\_within\_directory(location,\ path):}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ message\ =\ (}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}The\ tar\ file\ (\{\})\ has\ a\ file\ (\{\})\ trying\ to\ install\ "{}}}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}outside\ target\ directory\ (\{\})"{}}}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ InstallationError(\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{message.format}}(filename,\ path,\ location))}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{member.isdir}}():}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ensure\_dir(path)}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{elif}\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{member.issym}}():}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{tar.\_extract\_member}}(member,\ path)}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ Exception\ \textcolor{keyword}{as}\ exc:}
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Some\ corrupt\ tar\ files\ seem\ to\ produce\ this}}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ (specifically\ bad\ symlinks)}}
\DoxyCodeLine{00195\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{logger.warning}}(}
\DoxyCodeLine{00196\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}In\ the\ tar\ file\ \%s\ the\ member\ \%s\ is\ invalid:\ \%s"{}},}
\DoxyCodeLine{00197\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ filename,}
\DoxyCodeLine{00198\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{member.name}},}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ exc,}
\DoxyCodeLine{00200\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue}}
\DoxyCodeLine{00202\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{00203\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fp\ =\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{tar.extractfile}}(member)}
\DoxyCodeLine{00205\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{except}\ (KeyError,\ AttributeError)\ \textcolor{keyword}{as}\ exc:}
\DoxyCodeLine{00206\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Some\ corrupt\ tar\ files\ seem\ to\ produce\ this}}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ (specifically\ bad\ symlinks)}}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{logger.warning}}(}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}In\ the\ tar\ file\ \%s\ the\ member\ \%s\ is\ invalid:\ \%s"{}},}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ filename,}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{member.name}},}
\DoxyCodeLine{00212\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ exc,}
\DoxyCodeLine{00213\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{00214\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{continue}}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ensure\_dir(\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{os.path.dirname}}(path))}
\DoxyCodeLine{00216\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{assert}\ fp\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ open(path,\ \textcolor{stringliteral}{"{}wb"{}})\ \textcolor{keyword}{as}\ destfp:}
\DoxyCodeLine{00218\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{shutil.copyfileobj}}(fp,\ destfp)}
\DoxyCodeLine{00219\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{fp.close}}()}
\DoxyCodeLine{00220\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Update\ the\ timestamp\ (useful\ for\ cython\ compiled\ files)}}
\DoxyCodeLine{00221\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{tar.utime}}(member,\ path)}
\DoxyCodeLine{00222\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ member\ have\ any\ execute\ permissions\ for\ user/group/world?}}
\DoxyCodeLine{00223\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{member.mode}}\ \&\ 0o111:}
\DoxyCodeLine{00224\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ set\_extracted\_file\_to\_default\_mode\_plus\_executable(path)}
\DoxyCodeLine{00225\ \ \ \ \ \textcolor{keywordflow}{finally}:}
\DoxyCodeLine{00226\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{tar.close}}()}
\DoxyCodeLine{00227\ }
\DoxyCodeLine{00228\ }

\end{DoxyCode}


References \mbox{\hyperlink{unpacking_8py_source_l00062}{pip.\+\_\+internal.\+utils.\+unpacking.\+has\+\_\+leading\+\_\+dir()}}, \mbox{\hyperlink{prime__search_8m_source_l00010}{i}}, and \mbox{\hyperlink{unpacking_8py_source_l00050}{pip.\+\_\+internal.\+utils.\+unpacking.\+split\+\_\+leading\+\_\+dir()}}.



Referenced by \mbox{\hyperlink{unpacking_8py_source_l00233}{pip.\+\_\+internal.\+utils.\+unpacking.\+unpack\+\_\+file()}}.

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d22/namespacepip_1_1__internal_1_1utils_1_1unpacking_aeeaa12c1dac293795c7407df64bb96b8_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=237pt]{d8/d22/namespacepip_1_1__internal_1_1utils_1_1unpacking_aeeaa12c1dac293795c7407df64bb96b8_icgraph}
\end{center}
\end{figure}
\Hypertarget{namespacepip_1_1__internal_1_1utils_1_1unpacking_ac3a79feb22c41075d3280473b06ed62b}\label{namespacepip_1_1__internal_1_1utils_1_1unpacking_ac3a79feb22c41075d3280473b06ed62b} 
\index{pip.\_internal.utils.unpacking@{pip.\_internal.utils.unpacking}!unzip\_file@{unzip\_file}}
\index{unzip\_file@{unzip\_file}!pip.\_internal.utils.unpacking@{pip.\_internal.utils.unpacking}}
\doxysubsubsection{\texorpdfstring{unzip\_file()}{unzip\_file()}}
{\footnotesize\ttfamily  \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{None}} unzip\+\_\+file (\begin{DoxyParamCaption}\item[{str}]{filename,  }\item[{str}]{location,  }\item[{bool }]{flatten = {\ttfamily True} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Unzip the file (with path `filename`) to the destination `location`.  All
files are written based on system defaults and umask (i.e. permissions are
not preserved), except that regular file members with any execute
permissions (user, group, or world) have "chmod +x" applied after being
written. Note that for windows, any execute changes using os.chmod are
no-ops per the python docs.
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{unpacking_8py_source_l00103}{103}} of file \mbox{\hyperlink{unpacking_8py_source}{unpacking.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00103\ \textcolor{keyword}{def\ }unzip\_file(filename:\ str,\ location:\ str,\ flatten:\ bool\ =\ \textcolor{keyword}{True})\ -\/>\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{00104\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{00105\ \textcolor{stringliteral}{\ \ \ \ Unzip\ the\ file\ (with\ path\ \`{}filename\`{})\ to\ the\ destination\ \`{}location\`{}.\ \ All}}
\DoxyCodeLine{00106\ \textcolor{stringliteral}{\ \ \ \ files\ are\ written\ based\ on\ system\ defaults\ and\ umask\ (i.e.\ permissions\ are}}
\DoxyCodeLine{00107\ \textcolor{stringliteral}{\ \ \ \ not\ preserved),\ except\ that\ regular\ file\ members\ with\ any\ execute}}
\DoxyCodeLine{00108\ \textcolor{stringliteral}{\ \ \ \ permissions\ (user,\ group,\ or\ world)\ have\ "{}chmod\ +x"{}\ applied\ after\ being}}
\DoxyCodeLine{00109\ \textcolor{stringliteral}{\ \ \ \ written.\ Note\ that\ for\ windows,\ any\ execute\ changes\ using\ os.chmod\ are}}
\DoxyCodeLine{00110\ \textcolor{stringliteral}{\ \ \ \ no-\/ops\ per\ the\ python\ docs.}}
\DoxyCodeLine{00111\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{00112\ \ \ \ \ ensure\_dir(location)}
\DoxyCodeLine{00113\ \ \ \ \ zipfp\ =\ open(filename,\ \textcolor{stringliteral}{"{}rb"{}})}
\DoxyCodeLine{00114\ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{00115\ \ \ \ \ \ \ \ \ zip\ =\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{zipfile.ZipFile}}(zipfp,\ allowZip64=\textcolor{keyword}{True})}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ leading\ =\ has\_leading\_dir(\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{zip.namelist}}())\ \textcolor{keywordflow}{and}\ flatten}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ info\ \textcolor{keywordflow}{in}\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{zip.infolist}}():}
\DoxyCodeLine{00118\ \ \ \ \ \ \ \ \ \ \ \ \ name\ =\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{info.filename}}}
\DoxyCodeLine{00119\ \ \ \ \ \ \ \ \ \ \ \ \ fn\ =\ name}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ leading:}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fn\ =\ split\_leading\_dir(name)[1]}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \ \ \ \ fn\ =\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{os.path.join}}(location,\ fn)}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \ \ \ \ \ \ dir\ =\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{os.path.dirname}}(fn)}
\DoxyCodeLine{00124\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ is\_within\_directory(location,\ fn):}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ message\ =\ (}
\DoxyCodeLine{00126\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}The\ zip\ file\ (\{\})\ has\ a\ file\ (\{\})\ trying\ to\ install\ "{}}}
\DoxyCodeLine{00127\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}outside\ target\ directory\ (\{\})"{}}}
\DoxyCodeLine{00128\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ )}
\DoxyCodeLine{00129\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ InstallationError(\mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{message.format}}(filename,\ fn,\ location))}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{fn.endswith}}(\textcolor{stringliteral}{"{}/"{}})\ \textcolor{keywordflow}{or}\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{fn.endswith}}(\textcolor{stringliteral}{"{}\(\backslash\)\(\backslash\)"{}}):}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ A\ directory}}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ensure\_dir(fn)}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}:}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ensure\_dir(dir)}
\DoxyCodeLine{00135\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ Don't\ use\ read()\ to\ avoid\ allocating\ an\ arbitrarily\ large}}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{\#\ chunk\ of\ memory\ for\ the\ file's\ content}}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ fp\ =\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{zip.open}}(name)}
\DoxyCodeLine{00138\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{try}:}
\DoxyCodeLine{00139\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{with}\ open(fn,\ \textcolor{stringliteral}{"{}wb"{}})\ \textcolor{keyword}{as}\ destfp:}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{shutil.copyfileobj}}(fp,\ destfp)}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{finally}:}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{fp.close}}()}
\DoxyCodeLine{00143\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ zip\_item\_is\_executable(info):}
\DoxyCodeLine{00144\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ set\_extracted\_file\_to\_default\_mode\_plus\_executable(fn)}
\DoxyCodeLine{00145\ \ \ \ \ \textcolor{keywordflow}{finally}:}
\DoxyCodeLine{00146\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{zipfp.close}}()}
\DoxyCodeLine{00147\ }
\DoxyCodeLine{00148\ }

\end{DoxyCode}


References \mbox{\hyperlink{unpacking_8py_source_l00062}{pip.\+\_\+internal.\+utils.\+unpacking.\+has\+\_\+leading\+\_\+dir()}}, \mbox{\hyperlink{prime__search_8m_source_l00010}{i}}, and \mbox{\hyperlink{unpacking_8py_source_l00050}{pip.\+\_\+internal.\+utils.\+unpacking.\+split\+\_\+leading\+\_\+dir()}}.



Referenced by \mbox{\hyperlink{unpacking_8py_source_l00233}{pip.\+\_\+internal.\+utils.\+unpacking.\+unpack\+\_\+file()}}.

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d8/d22/namespacepip_1_1__internal_1_1utils_1_1unpacking_ac3a79feb22c41075d3280473b06ed62b_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=239pt]{d8/d22/namespacepip_1_1__internal_1_1utils_1_1unpacking_ac3a79feb22c41075d3280473b06ed62b_icgraph}
\end{center}
\end{figure}
\Hypertarget{namespacepip_1_1__internal_1_1utils_1_1unpacking_ae4f7ac75282bfddedfd46778640a939b}\label{namespacepip_1_1__internal_1_1utils_1_1unpacking_ae4f7ac75282bfddedfd46778640a939b} 
\index{pip.\_internal.utils.unpacking@{pip.\_internal.utils.unpacking}!zip\_item\_is\_executable@{zip\_item\_is\_executable}}
\index{zip\_item\_is\_executable@{zip\_item\_is\_executable}!pip.\_internal.utils.unpacking@{pip.\_internal.utils.unpacking}}
\doxysubsubsection{\texorpdfstring{zip\_item\_is\_executable()}{zip\_item\_is\_executable()}}
{\footnotesize\ttfamily  bool zip\+\_\+item\+\_\+is\+\_\+executable (\begin{DoxyParamCaption}\item[{Zip\+Info}]{info }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{unpacking_8py_source_l00096}{96}} of file \mbox{\hyperlink{unpacking_8py_source}{unpacking.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00096\ \textcolor{keyword}{def\ }zip\_item\_is\_executable(info:\ ZipInfo)\ -\/>\ bool:}
\DoxyCodeLine{00097\ \ \ \ \ mode\ =\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{info.external\_attr}}\ >>\ 16}
\DoxyCodeLine{00098\ \ \ \ \ \textcolor{comment}{\#\ if\ mode\ and\ regular\ file\ and\ any\ execute\ permissions\ for}}
\DoxyCodeLine{00099\ \ \ \ \ \textcolor{comment}{\#\ user/group/world?}}
\DoxyCodeLine{00100\ \ \ \ \ \textcolor{keywordflow}{return}\ bool(mode\ \textcolor{keywordflow}{and}\ \mbox{\hyperlink{prime__search_8m_a6f6ccfcf58b31cb6412107d9d5281426}{stat.S\_ISREG}}(mode)\ \textcolor{keywordflow}{and}\ mode\ \&\ 0o111)}
\DoxyCodeLine{00101\ }
\DoxyCodeLine{00102\ }

\end{DoxyCode}


References \mbox{\hyperlink{prime__search_8m_source_l00010}{i}}.



\doxysubsection{Variable Documentation}
\Hypertarget{namespacepip_1_1__internal_1_1utils_1_1unpacking_a0b14e488ae28d98d262453f3e9cd6e4d}\label{namespacepip_1_1__internal_1_1utils_1_1unpacking_a0b14e488ae28d98d262453f3e9cd6e4d} 
\index{pip.\_internal.utils.unpacking@{pip.\_internal.utils.unpacking}!logger@{logger}}
\index{logger@{logger}!pip.\_internal.utils.unpacking@{pip.\_internal.utils.unpacking}}
\doxysubsubsection{\texorpdfstring{logger}{logger}}
{\footnotesize\ttfamily logger = logging.\+get\+Logger(\+\_\+\+\_\+name\+\_\+\+\_\+)}



Definition at line \mbox{\hyperlink{unpacking_8py_source_l00022}{22}} of file \mbox{\hyperlink{unpacking_8py_source}{unpacking.\+py}}.

\Hypertarget{namespacepip_1_1__internal_1_1utils_1_1unpacking_a2d49e2978a121bad364ce115163cc52a}\label{namespacepip_1_1__internal_1_1utils_1_1unpacking_a2d49e2978a121bad364ce115163cc52a} 
\index{pip.\_internal.utils.unpacking@{pip.\_internal.utils.unpacking}!SUPPORTED\_EXTENSIONS@{SUPPORTED\_EXTENSIONS}}
\index{SUPPORTED\_EXTENSIONS@{SUPPORTED\_EXTENSIONS}!pip.\_internal.utils.unpacking@{pip.\_internal.utils.unpacking}}
\doxysubsubsection{\texorpdfstring{SUPPORTED\_EXTENSIONS}{SUPPORTED\_EXTENSIONS}}
{\footnotesize\ttfamily SUPPORTED\+\_\+\+EXTENSIONS = ZIP\+\_\+\+EXTENSIONS + TAR\+\_\+\+EXTENSIONS}



Definition at line \mbox{\hyperlink{unpacking_8py_source_l00025}{25}} of file \mbox{\hyperlink{unpacking_8py_source}{unpacking.\+py}}.

