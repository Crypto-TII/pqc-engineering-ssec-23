<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.14.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Let us walk on the 3-isogeny graph: E:/pqc-engineering-ssec-23/dCTIDH/src/CTIDH/ctidh_wombat_eval.c File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<script type="text/javascript" src="../../clipboard.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<script type="text/javascript" src="../../cookie.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Let us walk on the 3-isogeny graph
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.14.0 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
</script>
<script type="text/javascript">
$(function() { codefold.init(); });
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('../../',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(function(){initNavTree('da/d82/ctidh__wombat__eval_8c.html','../../',''); });
</script>
<div id="container">
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">ctidh_wombat_eval.c File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;assert.h&gt;</code><br />
<code>#include &quot;<a class="el" href="../../d4/d4c/ctidh_8h_source.html">ctidh.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d6/d5f/primes_8h_source.html">../common/primes.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d8/dd3/int64mask_8h_source.html">../common/int64mask.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d0/d35/elligator_8h_source.html">../common/elligator.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d1/d79/random_8h_source.html">../common/random.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for ctidh_wombat_eval.c:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/de3/ctidh__wombat__eval_8c__incl.png" border="0" usemap="#a_e_1_2pqc-engineering-ssec-23_2d_c_t_i_d_h_2src_2_c_t_i_d_h_2ctidh__wombat__eval_8c" loading="lazy" alt=""/></div>
<map name="a_e_1_2pqc-engineering-ssec-23_2d_c_t_i_d_h_2src_2_c_t_i_d_h_2ctidh__wombat__eval_8c" id="a_e_1_2pqc-engineering-ssec-23_2d_c_t_i_d_h_2src_2_c_t_i_d_h_2ctidh__wombat__eval_8c">
<area shape="rect" title=" " alt="" coords="407,5,601,64"/>
<area shape="rect" title=" " alt="" coords="6,336,71,363"/>
<area shape="poly" title=" " alt="" coords="407,55,299,77,184,108,130,125,84,145,47,166,23,188,15,204,10,220,10,256,17,291,28,321,23,323,12,293,4,257,5,219,10,202,19,185,44,162,81,140,128,120,182,102,298,72,406,50"/>
<area shape="rect" title=" " alt="" coords="774,112,842,139"/>
<area shape="poly" title=" " alt="" coords="602,62,759,107,758,112,600,67"/>
<area shape="rect" href="../../d4/d4c/ctidh_8h.html" title=" " alt="" coords="387,112,447,139"/>
<area shape="poly" title=" " alt="" coords="478,66,442,103,438,99,474,62"/>
<area shape="rect" href="../../d6/d5f/primes_8h.html" title=" " alt="" coords="455,187,592,213"/>
<area shape="poly" title=" " alt="" coords="510,64,523,171,518,172,505,65"/>
<area shape="rect" href="../../d8/dd3/int64mask_8h.html" title=" " alt="" coords="591,112,750,139"/>
<area shape="poly" title=" " alt="" coords="559,62,634,102,632,107,557,67"/>
<area shape="rect" href="../../d0/d35/elligator_8h.html" title=" " alt="" coords="33,187,177,213"/>
<area shape="poly" title=" " alt="" coords="435,67,151,183,149,178,433,62"/>
<area shape="rect" href="../../d1/d79/random_8h.html" title=" " alt="" coords="617,187,758,213"/>
<area shape="poly" title=" " alt="" coords="522,63,548,100,581,137,613,159,645,177,643,182,610,164,578,141,544,103,518,66"/>
<area shape="rect" href="../../df/d2a/namespace_8h.html" title=" " alt="" coords="334,261,500,288"/>
<area shape="poly" title=" " alt="" coords="420,139,420,246,414,246,414,139"/>
<area shape="rect" title=" " alt="" coords="136,336,293,363"/>
<area shape="poly" title=" " alt="" coords="387,130,352,135,313,145,274,162,242,188,224,219,215,255,212,290,213,320,208,320,207,290,210,254,219,217,238,185,271,157,311,140,351,130,386,125"/>
<area shape="rect" href="../../d0/d84/mont_8h.html" title=" " alt="" coords="252,187,379,213"/>
<area shape="poly" title=" " alt="" coords="401,141,347,179,344,175,398,137"/>
<area shape="poly" title=" " alt="" coords="437,137,494,175,491,180,434,141"/>
<area shape="poly" title=" " alt="" coords="335,212,388,250,385,254,332,216"/>
<area shape="poly" title=" " alt="" coords="309,215,234,325,229,322,305,212"/>
<area shape="rect" href="../../d2/dcf/proj_8h.html" title=" " alt="" coords="101,261,154,288"/>
<area shape="poly" title=" " alt="" coords="284,216,170,260,168,255,282,211"/>
<area shape="poly" title=" " alt="" coords="114,291,67,328,64,324,110,286"/>
<area shape="poly" title=" " alt="" coords="144,286,190,324,186,328,141,291"/>
<area shape="poly" title=" " alt="" coords="507,216,450,254,447,250,504,212"/>
<area shape="rect" title=" " alt="" coords="649,261,727,288"/>
<area shape="poly" title=" " alt="" coords="553,211,646,252,644,257,551,216"/>
<area shape="poly" title=" " alt="" coords="711,137,745,156,760,169,773,186,777,206,768,225,751,242,731,256,728,251,748,238,763,222,771,206,768,188,757,173,742,160,708,142"/>
<area shape="poly" title=" " alt="" coords="160,211,348,255,347,260,159,217"/>
<area shape="poly" title=" " alt="" coords="112,213,122,246,117,247,106,215"/>
<area shape="poly" title=" " alt="" coords="641,216,480,259,478,254,640,211"/>
<area shape="poly" title=" " alt="" coords="690,214,690,246,685,246,685,214"/>
</map>
</div>
</div>
<p><a href="../../da/d82/ctidh__wombat__eval_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-func-members" class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad6eaa6451c6422920550bf06f4169b6d" id="r_ad6eaa6451c6422920550bf06f4169b6d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ad6eaa6451c6422920550bf06f4169b6d">fulltorsion_points</a> (<a class="el" href="../../d8/d66/fp-gmp_8h.html#a167c68a20b94476341fdbff3d8688784">fp</a> u, <a class="el" href="../../d8/d66/fp-gmp_8h.html#a167c68a20b94476341fdbff3d8688784">fp</a> const <a class="el" href="../../d5/dac/to__model_8m.html#ae72ab0a319852f0c6d43e6937c1063bd">a</a>)</td></tr>
<tr class="memitem:a3d7a2d4a7501eca430997c1af6984de8" id="r_a3d7a2d4a7501eca430997c1af6984de8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a3d7a2d4a7501eca430997c1af6984de8">action</a> (<a class="el" href="../../d3/dce/structpublic__key.html">public_key</a> *out, <a class="el" href="../../d3/dce/structpublic__key.html">public_key</a> const *in, <a class="el" href="../../d4/d54/structprivate__key.html">private_key</a> const *priv)</td></tr>
<tr class="memitem:a16c24b59d32ee85588cc61c9770e378b" id="r_a16c24b59d32ee85588cc61c9770e378b"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#a16c24b59d32ee85588cc61c9770e378b">csidh</a> (<a class="el" href="../../d3/dce/structpublic__key.html">public_key</a> *out, <a class="el" href="../../d3/dce/structpublic__key.html">public_key</a> const *in, <a class="el" href="../../d4/d54/structprivate__key.html">private_key</a> const *priv)</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 id="header-var-members" class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ae5a97e9debf3707d97dfb35dc631a0ca" id="r_ae5a97e9debf3707d97dfb35dc631a0ca"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../d3/dce/structpublic__key.html">public_key</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="#ae5a97e9debf3707d97dfb35dc631a0ca">base</a> = {.A = {0}, .seed = ELLIGATOR_SEED}</td></tr>
</table>
<a name="doc-func-members" id="doc-func-members"></a><h2 id="header-doc-func-members" class="groupheader">Function Documentation</h2>
<a id="a3d7a2d4a7501eca430997c1af6984de8" name="a3d7a2d4a7501eca430997c1af6984de8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d7a2d4a7501eca430997c1af6984de8">&#9670;&#160;</a></span>action()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void action </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d3/dce/structpublic__key.html">public_key</a> *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/dce/structpublic__key.html">public_key</a> const *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/d54/structprivate__key.html">private_key</a> const *</td>          <td class="paramname"><span class="paramname"><em>priv</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d82/ctidh__wombat__eval_8c_source.html#l00177">177</a> of file <a class="el" href="../../da/d82/ctidh__wombat__eval_8c_source.html">ctidh_wombat_eval.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  178</span>{</div>
<div class="line"><span class="lineno">  179</span> </div>
<div class="line"><span class="lineno">  180</span>    init_counters();</div>
<div class="line"><span class="lineno">  181</span> </div>
<div class="line"><span class="lineno">  182</span>    <a class="code hl_struct" href="../../d8/d6e/structproj.html">proj</a> <a class="code hl_variable" href="../../d9/df4/namespacetests.html#a3b98e2dffc6cb06a89dcb0d5c60a0206">A</a>;</div>
<div class="line"><span class="lineno">  183</span>    <a class="code hl_define" href="../../d8/d66/fp-gmp_8h.html#ad0b6e5afb2fdd4f50fd2714fc59931ab">fp_copy</a>(<a class="code hl_variable" href="../../d9/df4/namespacetests.html#a3b98e2dffc6cb06a89dcb0d5c60a0206">A</a>.x, in-&gt;A);</div>
<div class="line"><span class="lineno">  184</span>    <a class="code hl_define" href="../../d8/d66/fp-gmp_8h.html#ad0b6e5afb2fdd4f50fd2714fc59931ab">fp_copy</a>(<a class="code hl_variable" href="../../d9/df4/namespacetests.html#a3b98e2dffc6cb06a89dcb0d5c60a0206">A</a>.z, <a class="code hl_define" href="../../d8/d66/fp-gmp_8h.html#a4ec3519815103a8a92bd612f933abbb1">fp_1</a>);</div>
<div class="line"><span class="lineno">  185</span> </div>
<div class="line"><span class="lineno">  186</span>    <a class="code hl_struct" href="../../d8/d6e/structproj.html">proj</a> A24;</div>
<div class="line"><span class="lineno">  187</span>    <a class="code hl_define" href="../../d0/d84/mont_8h.html#a1983214d89665bc95ea846ba0d45114b">xA24</a>(&amp;A24, &amp;A);</div>
<div class="line"><span class="lineno">  188</span> </div>
<div class="line"><span class="lineno">  189</span>    <a class="code hl_struct" href="../../d8/d6e/structproj.html">proj</a> Points[4];</div>
<div class="line"><span class="lineno">  190</span>    <a class="code hl_typedef" href="../../d8/d66/fp-gmp_8h.html#a167c68a20b94476341fdbff3d8688784">fp</a> seed;</div>
<div class="line"><span class="lineno">  191</span>    fp_set(seed, in-&gt;seed);</div>
<div class="line"><span class="lineno">  192</span>    <a class="code hl_define" href="../../d8/d66/fp-gmp_8h.html#aa73022969fcd23d0d81d0b7115248d5d">fp_enc</a>(seed, seed);</div>
<div class="line"><span class="lineno">  193</span>    <a class="code hl_define" href="../../d0/d35/elligator_8h.html#ab62f777855b4aeae0423f37feb8386e2">elligator_seeded</a>(&amp;Points[0], &amp;Points[1], &amp;A24, (<span class="keyword">const</span> <a class="code hl_typedef" href="../../d8/d66/fp-gmp_8h.html#a167c68a20b94476341fdbff3d8688784">fp</a> *)seed);</div>
<div class="line"><span class="lineno">  194</span> </div>
<div class="line"><span class="lineno">  195</span>    clearpublicprimes(&amp;Points[0], &amp;A24);</div>
<div class="line"><span class="lineno">  196</span>    clearpublicprimes(&amp;Points[1], &amp;A24);</div>
<div class="line"><span class="lineno">  197</span> </div>
<div class="line"><span class="lineno">  198</span>    <span class="comment">// clear ells not used in the keyspace</span></div>
<div class="line"><span class="lineno">  199</span>    <span class="keywordflow">for</span> (int16_t <a class="code hl_variable" href="../../d2/d00/prime__search_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = <a class="code hl_define" href="../../d6/d5f/primes_8h.html#acc9e03579591509b3edb49d07bc8cca6">batch_stop</a>[primes_batches - 1] + 1; <a class="code hl_variable" href="../../d2/d00/prime__search_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; primes_num; <a class="code hl_variable" href="../../d2/d00/prime__search_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++)</div>
<div class="line"><span class="lineno">  200</span>    {</div>
<div class="line"><span class="lineno">  201</span>        <a class="code hl_define" href="../../d0/d84/mont_8h.html#a33bcb2a867a845121bac1591c68456d1">xMUL_dac</a>(&amp;Points[0], &amp;A24, 0, &amp;Points[0], <a class="code hl_define" href="../../d6/d5f/primes_8h.html#a56cb00c68833427c91926115f0eb70f0">primes_dac</a>[<a class="code hl_variable" href="../../d2/d00/prime__search_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>], <a class="code hl_define" href="../../d6/d5f/primes_8h.html#a91122dc998b135229e3bbde3ed578d80">primes_daclen</a>[<a class="code hl_variable" href="../../d2/d00/prime__search_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>], <a class="code hl_define" href="../../d6/d5f/primes_8h.html#a91122dc998b135229e3bbde3ed578d80">primes_daclen</a>[<a class="code hl_variable" href="../../d2/d00/prime__search_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>]);</div>
<div class="line"><span class="lineno">  202</span>        <a class="code hl_define" href="../../d0/d84/mont_8h.html#a33bcb2a867a845121bac1591c68456d1">xMUL_dac</a>(&amp;Points[1], &amp;A24, 0, &amp;Points[1], <a class="code hl_define" href="../../d6/d5f/primes_8h.html#a56cb00c68833427c91926115f0eb70f0">primes_dac</a>[<a class="code hl_variable" href="../../d2/d00/prime__search_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>], <a class="code hl_define" href="../../d6/d5f/primes_8h.html#a91122dc998b135229e3bbde3ed578d80">primes_daclen</a>[<a class="code hl_variable" href="../../d2/d00/prime__search_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>], <a class="code hl_define" href="../../d6/d5f/primes_8h.html#a91122dc998b135229e3bbde3ed578d80">primes_daclen</a>[<a class="code hl_variable" href="../../d2/d00/prime__search_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>]);</div>
<div class="line"><span class="lineno">  203</span>    }</div>
<div class="line"><span class="lineno">  204</span> </div>
<div class="line"><span class="lineno">  205</span>    <span class="comment">// collect primes not used in the key ...</span></div>
<div class="line"><span class="lineno">  206</span>    int16_t unused[<a class="code hl_define" href="../../d6/d5f/primes_8h.html#acc9e03579591509b3edb49d07bc8cca6">batch_stop</a>[primes_batches - 1] + 1];</div>
<div class="line"><span class="lineno">  207</span>    <span class="comment">// int16_t unused[255] = {0};</span></div>
<div class="line"><span class="lineno">  208</span> </div>
<div class="line"><span class="lineno">  209</span>    int16_t u = 0;</div>
<div class="line"><span class="lineno">  210</span>    int16_t e = 0;</div>
<div class="line"><span class="lineno">  211</span>    int16_t w = 0;</div>
<div class="line"><span class="lineno">  212</span>    <span class="keywordflow">for</span> (e = 0; e &lt;= <a class="code hl_define" href="../../d6/d5f/primes_8h.html#acc9e03579591509b3edb49d07bc8cca6">batch_stop</a>[primes_batches - 1]; e++)</div>
<div class="line"><span class="lineno">  213</span>    {</div>
<div class="line"><span class="lineno">  214</span><span class="preprocessor">#ifdef ENABLE_CT_TESTING</span></div>
<div class="line"><span class="lineno">  215</span>        VALGRIND_MAKE_MEM_DEFINED(&amp;u, <span class="keyword">sizeof</span>(int16_t));</div>
<div class="line"><span class="lineno">  216</span>        VALGRIND_MAKE_MEM_DEFINED(&amp;e, <span class="keyword">sizeof</span>(int16_t));</div>
<div class="line"><span class="lineno">  217</span>        VALGRIND_MAKE_MEM_DEFINED(&amp;w, <span class="keyword">sizeof</span>(int16_t));</div>
<div class="line"><span class="lineno">  218</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  219</span> </div>
<div class="line"><span class="lineno">  220</span>        unused[u] = e;</div>
<div class="line"><span class="lineno">  221</span> </div>
<div class="line"><span class="lineno">  222</span>        int64_t mov = -int64mask_equal((int64_t)e, (int64_t)priv-&gt;ells[w]);</div>
<div class="line"><span class="lineno">  223</span> </div>
<div class="line"><span class="lineno">  224</span>        <a class="code hl_typedef" href="../../d8/d66/fp-gmp_8h.html#a167c68a20b94476341fdbff3d8688784">fp</a> t1, t2;</div>
<div class="line"><span class="lineno">  225</span>        t1[0] = u;</div>
<div class="line"><span class="lineno">  226</span>        t2[0] = u + 1;</div>
<div class="line"><span class="lineno">  227</span>        <a class="code hl_define" href="../../d8/d66/fp-gmp_8h.html#a5324909527d54f9d1ec902b743b5133c">fp_cmov</a>(&amp;t1, (<span class="keyword">const</span> <a class="code hl_typedef" href="../../d8/d66/fp-gmp_8h.html#a167c68a20b94476341fdbff3d8688784">fp</a> *)&amp;t2, 1 - mov);</div>
<div class="line"><span class="lineno">  228</span>        u = t1[0];</div>
<div class="line"><span class="lineno">  229</span> </div>
<div class="line"><span class="lineno">  230</span>        t1[0] = w;</div>
<div class="line"><span class="lineno">  231</span>        t2[0] = w + 1;</div>
<div class="line"><span class="lineno">  232</span>        <a class="code hl_define" href="../../d8/d66/fp-gmp_8h.html#a5324909527d54f9d1ec902b743b5133c">fp_cmov</a>(&amp;t1, (<span class="keyword">const</span> <a class="code hl_typedef" href="../../d8/d66/fp-gmp_8h.html#a167c68a20b94476341fdbff3d8688784">fp</a> *)&amp;t2, mov);</div>
<div class="line"><span class="lineno">  233</span>        w = t1[0];</div>
<div class="line"><span class="lineno">  234</span>    }</div>
<div class="line"><span class="lineno">  235</span> </div>
<div class="line"><span class="lineno">  236</span>    <span class="comment">// ... and remove them from our points</span></div>
<div class="line"><span class="lineno">  237</span>    int16_t tmp_b = 0;</div>
<div class="line"><span class="lineno">  238</span>    <span class="keywordflow">for</span> (u = 0; u &lt;= <a class="code hl_define" href="../../d6/d5f/primes_8h.html#acc9e03579591509b3edb49d07bc8cca6">batch_stop</a>[primes_batches - 1] - WOMBATKEYS; u++)</div>
<div class="line"><span class="lineno">  239</span>    {</div>
<div class="line"><span class="lineno">  240</span>        int16_t t = unused[u];</div>
<div class="line"><span class="lineno">  241</span>        <span class="keywordflow">if</span> (t &gt; <a class="code hl_define" href="../../d6/d5f/primes_8h.html#acc9e03579591509b3edb49d07bc8cca6">batch_stop</a>[tmp_b])</div>
<div class="line"><span class="lineno">  242</span>            tmp_b++;</div>
<div class="line"><span class="lineno">  243</span>        </div>
<div class="line"><span class="lineno">  244</span>        <span class="keywordtype">long</span> <span class="keywordtype">long</span> dac = lookup(t, <a class="code hl_define" href="../../d6/d5f/primes_8h.html#a56cb00c68833427c91926115f0eb70f0">primes_dac</a>);</div>
<div class="line"><span class="lineno">  245</span>        <span class="keywordtype">long</span> <span class="keywordtype">long</span> daclen = lookup(t, <a class="code hl_define" href="../../d6/d5f/primes_8h.html#a91122dc998b135229e3bbde3ed578d80">primes_daclen</a>);</div>
<div class="line"><span class="lineno">  246</span> </div>
<div class="line"><span class="lineno">  247</span>        <a class="code hl_define" href="../../d0/d84/mont_8h.html#a33bcb2a867a845121bac1591c68456d1">xMUL_dac</a>(&amp;Points[0], &amp;A24, 0, &amp;Points[0], dac, daclen, <a class="code hl_define" href="../../d6/d5f/primes_8h.html#a258b7d004311e956a8eac8954d5d184d">batch_maxdac</a>[tmp_b]);</div>
<div class="line"><span class="lineno">  248</span>        <a class="code hl_define" href="../../d0/d84/mont_8h.html#a33bcb2a867a845121bac1591c68456d1">xMUL_dac</a>(&amp;Points[1], &amp;A24, 0, &amp;Points[1], dac, daclen, <a class="code hl_define" href="../../d6/d5f/primes_8h.html#a258b7d004311e956a8eac8954d5d184d">batch_maxdac</a>[tmp_b]);</div>
<div class="line"><span class="lineno">  249</span>    }</div>
<div class="line"><span class="lineno">  250</span> </div>
<div class="line"><span class="lineno">  251</span>    <span class="comment">// ACTION!</span></div>
<div class="line"><span class="lineno">  252</span>    <span class="comment">// copy &quot;outer&quot; points</span></div>
<div class="line"><span class="lineno">  253</span>    proj_copy(&amp;Points[2], &amp;Points[0]);</div>
<div class="line"><span class="lineno">  254</span>    proj_copy(&amp;Points[3], &amp;Points[1]);</div>
<div class="line"><span class="lineno">  255</span> </div>
<div class="line"><span class="lineno">  256</span>    int16_t current_key = WOMBATKEYS - 1;</div>
<div class="line"><span class="lineno">  257</span>    <span class="keywordflow">for</span> (int16_t current_batch = primes_batches - 1; current_batch &gt;= 0; current_batch--)</div>
<div class="line"><span class="lineno">  258</span>    {</div>
<div class="line"><span class="lineno">  259</span>        uint8_t inner_counter = 0;</div>
<div class="line"><span class="lineno">  260</span> </div>
<div class="line"><span class="lineno">  261</span>        <span class="comment">// outer points are now the inner points</span></div>
<div class="line"><span class="lineno">  262</span>        proj_copy(&amp;Points[0], &amp;Points[2]);</div>
<div class="line"><span class="lineno">  263</span>        proj_copy(&amp;Points[1], &amp;Points[3]);</div>
<div class="line"><span class="lineno">  264</span> </div>
<div class="line"><span class="lineno">  265</span>        <span class="comment">// remove degrees not in the batch</span></div>
<div class="line"><span class="lineno">  266</span>        tmp_b = 0;</div>
<div class="line"><span class="lineno">  267</span>        <span class="keywordflow">for</span> (int16_t <a class="code hl_variable" href="../../d2/d00/prime__search_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../d2/d00/prime__search_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; <a class="code hl_define" href="../../d6/d5f/primes_8h.html#a0c186a4875e68bfc39a2688c42d12e26">batch_keybounds_start</a>[current_batch]; <a class="code hl_variable" href="../../d2/d00/prime__search_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++)</div>
<div class="line"><span class="lineno">  268</span>        {</div>
<div class="line"><span class="lineno">  269</span>            <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d2/d00/prime__search_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &gt; <a class="code hl_define" href="../../d6/d5f/primes_8h.html#a3a6da910ef8a7d99406350469d1fba82">batch_keybounds_stop</a>[tmp_b])</div>
<div class="line"><span class="lineno">  270</span>                tmp_b++;</div>
<div class="line"><span class="lineno">  271</span> </div>
<div class="line"><span class="lineno">  272</span>            <span class="keywordtype">long</span> <span class="keywordtype">long</span> dac = lookup(priv-&gt;ells[<a class="code hl_variable" href="../../d2/d00/prime__search_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>], <a class="code hl_define" href="../../d6/d5f/primes_8h.html#a56cb00c68833427c91926115f0eb70f0">primes_dac</a>);</div>
<div class="line"><span class="lineno">  273</span>            <span class="keywordtype">long</span> <span class="keywordtype">long</span> daclen = lookup(priv-&gt;ells[<a class="code hl_variable" href="../../d2/d00/prime__search_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>], <a class="code hl_define" href="../../d6/d5f/primes_8h.html#a91122dc998b135229e3bbde3ed578d80">primes_daclen</a>);</div>
<div class="line"><span class="lineno">  274</span> </div>
<div class="line"><span class="lineno">  275</span>            <a class="code hl_define" href="../../d0/d84/mont_8h.html#a33bcb2a867a845121bac1591c68456d1">xMUL_dac</a>(&amp;Points[0], &amp;A24, 0, &amp;Points[0], dac, daclen, <a class="code hl_define" href="../../d6/d5f/primes_8h.html#a258b7d004311e956a8eac8954d5d184d">batch_maxdac</a>[tmp_b]);</div>
<div class="line"><span class="lineno">  276</span>            <a class="code hl_define" href="../../d0/d84/mont_8h.html#a33bcb2a867a845121bac1591c68456d1">xMUL_dac</a>(&amp;Points[1], &amp;A24, 0, &amp;Points[1], dac, daclen, <a class="code hl_define" href="../../d6/d5f/primes_8h.html#a258b7d004311e956a8eac8954d5d184d">batch_maxdac</a>[tmp_b]);</div>
<div class="line"><span class="lineno">  277</span>        }</div>
<div class="line"><span class="lineno">  278</span> </div>
<div class="line"><span class="lineno">  279</span> </div>
<div class="line"><span class="lineno">  280</span>        <span class="keywordflow">for</span> (; current_key &gt;= <a class="code hl_define" href="../../d6/d5f/primes_8h.html#a0c186a4875e68bfc39a2688c42d12e26">batch_keybounds_start</a>[current_batch]; current_key--)</div>
<div class="line"><span class="lineno">  281</span>        {</div>
<div class="line"><span class="lineno">  282</span>            uint16_t current_ell_index = priv-&gt;ells[current_key];</div>
<div class="line"><span class="lineno">  283</span>            uint64_t current_ell = lookup(current_ell_index, <a class="code hl_define" href="../../d6/d5f/primes_8h.html#a137794744a03163a524ebb2aac2105c0">primes</a>);</div>
<div class="line"><span class="lineno">  284</span>            <span class="comment">// 0 -&gt; dummy, 1 -&gt; + direction, 2 -&gt; - direction</span></div>
<div class="line"><span class="lineno">  285</span>            int64_t direction = priv-&gt;directions[current_key];</div>
<div class="line"><span class="lineno">  286</span> </div>
<div class="line"><span class="lineno">  287</span>            uint64_t lowerend_ell = <a class="code hl_define" href="../../d6/d5f/primes_8h.html#a137794744a03163a524ebb2aac2105c0">primes</a>[<a class="code hl_define" href="../../d6/d5f/primes_8h.html#a63de22a96a777bab244dd0850f58fed9">batch_start</a>[current_batch] + <a class="code hl_define" href="../../d6/d5f/primes_8h.html#a950dc149fa08d10049e01546ca3562b3">batch_numkeys</a>[current_batch] - inner_counter - 1];</div>
<div class="line"><span class="lineno">  288</span>            uint64_t upperend_ell = <a class="code hl_define" href="../../d6/d5f/primes_8h.html#a137794744a03163a524ebb2aac2105c0">primes</a>[<a class="code hl_define" href="../../d6/d5f/primes_8h.html#acc9e03579591509b3edb49d07bc8cca6">batch_stop</a>[current_batch] - inner_counter];</div>
<div class="line"><span class="lineno">  289</span>            <span class="comment">// printf(&quot;%3d: %2d - %4ld-isogeny to %ld for cost of (%4ld,%4ld)\n&quot;,</span></div>
<div class="line"><span class="lineno">  290</span>            <span class="comment">//           current_key, current_batch, current_ell, direction, lowerend_ell, upperend_ell);</span></div>
<div class="line"><span class="lineno">  291</span> </div>
<div class="line"><span class="lineno">  292</span>            <span class="comment">// multiply out other factors</span></div>
<div class="line"><span class="lineno">  293</span>            <a class="code hl_struct" href="../../d8/d6e/structproj.html">proj</a> K;</div>
<div class="line"><span class="lineno">  294</span>            proj_cmov(&amp;K, &amp;Points[0], -int64mask_equal(direction, (int64_t)2));</div>
<div class="line"><span class="lineno">  295</span>            proj_cmov(&amp;K, &amp;Points[1], 1 + int64mask_equal(direction, (int64_t)2));</div>
<div class="line"><span class="lineno">  296</span> </div>
<div class="line"><span class="lineno">  297</span>            <span class="comment">// we skip the &quot;last/already processed&quot; and remove only the &quot;other&quot; degrees</span></div>
<div class="line"><span class="lineno">  298</span>            <span class="keywordflow">for</span> (int16_t <a class="code hl_variable" href="../../d2/d00/prime__search_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = <a class="code hl_define" href="../../d6/d5f/primes_8h.html#a0c186a4875e68bfc39a2688c42d12e26">batch_keybounds_start</a>[current_batch]; <a class="code hl_variable" href="../../d2/d00/prime__search_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; <a class="code hl_define" href="../../d6/d5f/primes_8h.html#a3a6da910ef8a7d99406350469d1fba82">batch_keybounds_stop</a>[current_batch] - inner_counter; <a class="code hl_variable" href="../../d2/d00/prime__search_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++)</div>
<div class="line"><span class="lineno">  299</span>            {</div>
<div class="line"><span class="lineno">  300</span>                <a class="code hl_define" href="../../d0/d84/mont_8h.html#a33bcb2a867a845121bac1591c68456d1">xMUL_dac</a>(&amp;K, &amp;A24, 0, &amp;K, lookup(priv-&gt;ells[<a class="code hl_variable" href="../../d2/d00/prime__search_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>], <a class="code hl_define" href="../../d6/d5f/primes_8h.html#a56cb00c68833427c91926115f0eb70f0">primes_dac</a>), lookup(priv-&gt;ells[<a class="code hl_variable" href="../../d2/d00/prime__search_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>], <a class="code hl_define" href="../../d6/d5f/primes_8h.html#a91122dc998b135229e3bbde3ed578d80">primes_daclen</a>), <a class="code hl_define" href="../../d6/d5f/primes_8h.html#a258b7d004311e956a8eac8954d5d184d">batch_maxdac</a>[current_batch]);</div>
<div class="line"><span class="lineno">  301</span>            }</div>
<div class="line"><span class="lineno">  302</span>            </div>
<div class="line"><span class="lineno">  303</span>            <span class="comment">// make a copy to trow away in the dummy case</span></div>
<div class="line"><span class="lineno">  304</span>            <a class="code hl_struct" href="../../d8/d6e/structproj.html">proj</a> A_;</div>
<div class="line"><span class="lineno">  305</span>            <a class="code hl_struct" href="../../d8/d6e/structproj.html">proj</a> Points_[4];</div>
<div class="line"><span class="lineno">  306</span>            proj_copy(&amp;Points_[0], &amp;Points[0]);</div>
<div class="line"><span class="lineno">  307</span>            proj_copy(&amp;Points_[1], &amp;Points[1]);</div>
<div class="line"><span class="lineno">  308</span>            proj_copy(&amp;Points_[2], &amp;Points[2]);</div>
<div class="line"><span class="lineno">  309</span>            proj_copy(&amp;Points_[3], &amp;Points[3]);</div>
<div class="line"><span class="lineno">  310</span>            proj_copy(&amp;A_, &amp;A);</div>
<div class="line"><span class="lineno">  311</span>            <span class="comment">// we can now compute the isogeny</span></div>
<div class="line"><span class="lineno">  312</span>            <span class="keywordflow">if</span> (current_key == 0)</div>
<div class="line"><span class="lineno">  313</span>            {</div>
<div class="line"><span class="lineno">  314</span>                <span class="comment">// this is the last isogeny we need to compute! so we don&#39;t need to push points</span></div>
<div class="line"><span class="lineno">  315</span>                <a class="code hl_define" href="../../d0/d84/mont_8h.html#ac3af9f03d84babaea6d4d2faea220ba1">xISOG_matryoshka</a>(&amp;A_, Points_, 0, &amp;K, current_ell, lowerend_ell, upperend_ell);</div>
<div class="line"><span class="lineno">  316</span>            }</div>
<div class="line"><span class="lineno">  317</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (current_key == <a class="code hl_define" href="../../d6/d5f/primes_8h.html#a0c186a4875e68bfc39a2688c42d12e26">batch_keybounds_start</a>[current_batch])</div>
<div class="line"><span class="lineno">  318</span>            {</div>
<div class="line"><span class="lineno">  319</span>                <span class="comment">// on the last isogeny of the batch, we only need to push the 2 &quot;outer&quot; points</span></div>
<div class="line"><span class="lineno">  320</span>                <a class="code hl_define" href="../../d0/d84/mont_8h.html#ac3af9f03d84babaea6d4d2faea220ba1">xISOG_matryoshka</a>(&amp;A_, &amp;Points_[2], 2, &amp;K, current_ell, lowerend_ell, upperend_ell);</div>
<div class="line"><span class="lineno">  321</span>            }</div>
<div class="line"><span class="lineno">  322</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (current_batch == 0)</div>
<div class="line"><span class="lineno">  323</span>            {</div>
<div class="line"><span class="lineno">  324</span>                <span class="comment">// on the last batch, we only need the inner points</span></div>
<div class="line"><span class="lineno">  325</span>                <a class="code hl_define" href="../../d0/d84/mont_8h.html#ac3af9f03d84babaea6d4d2faea220ba1">xISOG_matryoshka</a>(&amp;A_, Points_, 2, &amp;K, current_ell, lowerend_ell, upperend_ell);</div>
<div class="line"><span class="lineno">  326</span>            }</div>
<div class="line"><span class="lineno">  327</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (current_key == <a class="code hl_define" href="../../d6/d5f/primes_8h.html#a0c186a4875e68bfc39a2688c42d12e26">batch_keybounds_start</a>[current_batch] + 1)</div>
<div class="line"><span class="lineno">  328</span>            {</div>
<div class="line"><span class="lineno">  329</span>                <span class="comment">// on the second to last isogeny of a batch, we only need to push 3 points</span></div>
<div class="line"><span class="lineno">  330</span>                <span class="comment">// the one needed for the last isogeny of the batch + the two outer points</span></div>
<div class="line"><span class="lineno">  331</span>                proj_cswap(&amp;Points_[0], &amp;Points_[1], -int64mask_equal(priv-&gt;directions[current_key - 1], (int64_t)2));</div>
<div class="line"><span class="lineno">  332</span>                <a class="code hl_define" href="../../d0/d84/mont_8h.html#ac3af9f03d84babaea6d4d2faea220ba1">xISOG_matryoshka</a>(&amp;A_, &amp;Points_[1], 3, &amp;K, current_ell, lowerend_ell, upperend_ell);</div>
<div class="line"><span class="lineno">  333</span>                proj_cswap(&amp;Points_[0], &amp;Points_[1], -int64mask_equal(priv-&gt;directions[current_key - 1], (int64_t)2));</div>
<div class="line"><span class="lineno">  334</span>            }</div>
<div class="line"><span class="lineno">  335</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  336</span>            {</div>
<div class="line"><span class="lineno">  337</span>                <a class="code hl_define" href="../../d0/d84/mont_8h.html#ac3af9f03d84babaea6d4d2faea220ba1">xISOG_matryoshka</a>(&amp;A_, Points_, 4, &amp;K, current_ell, lowerend_ell, upperend_ell);</div>
<div class="line"><span class="lineno">  338</span>            }</div>
<div class="line"><span class="lineno">  339</span> </div>
<div class="line"><span class="lineno">  340</span>            <span class="comment">// skip isogeny in case of dummy isog</span></div>
<div class="line"><span class="lineno">  341</span>            proj_cmov(&amp;A, &amp;A_, -int64mask_nonzero(direction));</div>
<div class="line"><span class="lineno">  342</span>            proj_cmov(&amp;Points[0], &amp;Points_[0], -int64mask_nonzero(direction));</div>
<div class="line"><span class="lineno">  343</span>            proj_cmov(&amp;Points[1], &amp;Points_[1], -int64mask_nonzero(direction));</div>
<div class="line"><span class="lineno">  344</span>            proj_cmov(&amp;Points[2], &amp;Points_[2], -int64mask_nonzero(direction));</div>
<div class="line"><span class="lineno">  345</span>            proj_cmov(&amp;Points[3], &amp;Points_[3], -int64mask_nonzero(direction));</div>
<div class="line"><span class="lineno">  346</span> </div>
<div class="line"><span class="lineno">  347</span>            <a class="code hl_define" href="../../d0/d84/mont_8h.html#a1983214d89665bc95ea846ba0d45114b">xA24</a>(&amp;A24, &amp;A);</div>
<div class="line"><span class="lineno">  348</span> </div>
<div class="line"><span class="lineno">  349</span> </div>
<div class="line"><span class="lineno">  350</span>            <span class="keywordtype">long</span> <span class="keywordtype">long</span> dac = lookup(current_ell_index, <a class="code hl_define" href="../../d6/d5f/primes_8h.html#a56cb00c68833427c91926115f0eb70f0">primes_dac</a>);</div>
<div class="line"><span class="lineno">  351</span>            <span class="keywordtype">long</span> <span class="keywordtype">long</span> daclen = lookup(current_ell_index, <a class="code hl_define" href="../../d6/d5f/primes_8h.html#a91122dc998b135229e3bbde3ed578d80">primes_daclen</a>);</div>
<div class="line"><span class="lineno">  352</span> </div>
<div class="line"><span class="lineno">  353</span>            <span class="comment">// needed to remove the order incase a dummy isogeny was used</span></div>
<div class="line"><span class="lineno">  354</span>            <span class="keywordflow">if</span> (current_key &gt; <a class="code hl_define" href="../../d6/d5f/primes_8h.html#a0c186a4875e68bfc39a2688c42d12e26">batch_keybounds_start</a>[current_batch])</div>
<div class="line"><span class="lineno">  355</span>            {</div>
<div class="line"><span class="lineno">  356</span>                <span class="comment">// not needed for the inner points in the last round</span></div>
<div class="line"><span class="lineno">  357</span>                <span class="keywordflow">if</span> (current_key == <a class="code hl_define" href="../../d6/d5f/primes_8h.html#a0c186a4875e68bfc39a2688c42d12e26">batch_keybounds_start</a>[current_batch] + 1)</div>
<div class="line"><span class="lineno">  358</span>                {</div>
<div class="line"><span class="lineno">  359</span>                    proj_cswap(&amp;Points[0], &amp;Points[1], -int64mask_equal(priv-&gt;directions[current_key - 1], (int64_t)2));</div>
<div class="line"><span class="lineno">  360</span>                    <a class="code hl_define" href="../../d0/d84/mont_8h.html#a33bcb2a867a845121bac1591c68456d1">xMUL_dac</a>(&amp;Points[1], &amp;A24, 0, &amp;Points[1], dac, daclen, <a class="code hl_define" href="../../d6/d5f/primes_8h.html#a258b7d004311e956a8eac8954d5d184d">batch_maxdac</a>[current_batch]);</div>
<div class="line"><span class="lineno">  361</span>                    proj_cswap(&amp;Points[0], &amp;Points[1], -int64mask_equal(priv-&gt;directions[current_key - 1], (int64_t)2));</div>
<div class="line"><span class="lineno">  362</span>                }</div>
<div class="line"><span class="lineno">  363</span>                <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  364</span>                {</div>
<div class="line"><span class="lineno">  365</span>                    <a class="code hl_define" href="../../d0/d84/mont_8h.html#a33bcb2a867a845121bac1591c68456d1">xMUL_dac</a>(&amp;Points[0], &amp;A24, 0, &amp;Points[0], dac, daclen, <a class="code hl_define" href="../../d6/d5f/primes_8h.html#a258b7d004311e956a8eac8954d5d184d">batch_maxdac</a>[current_batch]);</div>
<div class="line"><span class="lineno">  366</span>                    <a class="code hl_define" href="../../d0/d84/mont_8h.html#a33bcb2a867a845121bac1591c68456d1">xMUL_dac</a>(&amp;Points[1], &amp;A24, 0, &amp;Points[1], dac, daclen, <a class="code hl_define" href="../../d6/d5f/primes_8h.html#a258b7d004311e956a8eac8954d5d184d">batch_maxdac</a>[current_batch]);</div>
<div class="line"><span class="lineno">  367</span>                }</div>
<div class="line"><span class="lineno">  368</span>            }</div>
<div class="line"><span class="lineno">  369</span> </div>
<div class="line"><span class="lineno">  370</span>            <span class="keywordflow">if</span> (current_batch != 0)</div>
<div class="line"><span class="lineno">  371</span>            {</div>
<div class="line"><span class="lineno">  372</span>                <a class="code hl_define" href="../../d0/d84/mont_8h.html#a33bcb2a867a845121bac1591c68456d1">xMUL_dac</a>(&amp;Points[2], &amp;A24, 0, &amp;Points[2], dac, daclen, <a class="code hl_define" href="../../d6/d5f/primes_8h.html#a258b7d004311e956a8eac8954d5d184d">batch_maxdac</a>[current_batch]);</div>
<div class="line"><span class="lineno">  373</span>                <a class="code hl_define" href="../../d0/d84/mont_8h.html#a33bcb2a867a845121bac1591c68456d1">xMUL_dac</a>(&amp;Points[3], &amp;A24, 0, &amp;Points[3], dac, daclen, <a class="code hl_define" href="../../d6/d5f/primes_8h.html#a258b7d004311e956a8eac8954d5d184d">batch_maxdac</a>[current_batch]);</div>
<div class="line"><span class="lineno">  374</span>            }</div>
<div class="line"><span class="lineno">  375</span> </div>
<div class="line"><span class="lineno">  376</span>            inner_counter++;</div>
<div class="line"><span class="lineno">  377</span>        }</div>
<div class="line"><span class="lineno">  378</span>    }</div>
<div class="line"><span class="lineno">  379</span> </div>
<div class="line"><span class="lineno">  380</span>    <a class="code hl_define" href="../../d8/d66/fp-gmp_8h.html#a4fe5cafb16f3d0021f55eca85d443683">fp_inv</a>(<a class="code hl_variable" href="../../d9/df4/namespacetests.html#a3b98e2dffc6cb06a89dcb0d5c60a0206">A</a>.z);</div>
<div class="line"><span class="lineno">  381</span>    fp_mul2(&amp;<a class="code hl_variable" href="../../d9/df4/namespacetests.html#a3b98e2dffc6cb06a89dcb0d5c60a0206">A</a>.x, (<span class="keyword">const</span> <a class="code hl_typedef" href="../../d8/d66/fp-gmp_8h.html#a167c68a20b94476341fdbff3d8688784">fp</a> *)&amp;<a class="code hl_variable" href="../../d9/df4/namespacetests.html#a3b98e2dffc6cb06a89dcb0d5c60a0206">A</a>.z);</div>
<div class="line"><span class="lineno">  382</span>    <a class="code hl_define" href="../../d8/d66/fp-gmp_8h.html#ad0b6e5afb2fdd4f50fd2714fc59931ab">fp_copy</a>(out-&gt;<a class="code hl_variable" href="../../d3/dce/structpublic__key.html#a72d8790e9a07d07ac5b6e1a33a632dc5">A</a>, <a class="code hl_variable" href="../../d9/df4/namespacetests.html#a3b98e2dffc6cb06a89dcb0d5c60a0206">A</a>.x);</div>
<div class="line"><span class="lineno">  383</span>}</div>
<div class="ttc" id="aelligator_8h_html_ab62f777855b4aeae0423f37feb8386e2"><div class="ttname"><a href="../../d0/d35/elligator_8h.html#ab62f777855b4aeae0423f37feb8386e2">elligator_seeded</a></div><div class="ttdeci">#define elligator_seeded</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d35/elligator_8h_source.html#l00008">elligator.h:8</a></div></div>
<div class="ttc" id="afp-gmp_8h_html_a167c68a20b94476341fdbff3d8688784"><div class="ttname"><a href="../../d8/d66/fp-gmp_8h.html#a167c68a20b94476341fdbff3d8688784">fp</a></div><div class="ttdeci">uint64_t fp[NUMBER_OF_WORDS]</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d66/fp-gmp_8h_source.html#l00022">fp-gmp.h:22</a></div></div>
<div class="ttc" id="afp-gmp_8h_html_a4ec3519815103a8a92bd612f933abbb1"><div class="ttname"><a href="../../d8/d66/fp-gmp_8h.html#a4ec3519815103a8a92bd612f933abbb1">fp_1</a></div><div class="ttdeci">#define fp_1</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d66/fp-gmp_8h_source.html#l00048">fp-gmp.h:48</a></div></div>
<div class="ttc" id="afp-gmp_8h_html_a4fe5cafb16f3d0021f55eca85d443683"><div class="ttname"><a href="../../d8/d66/fp-gmp_8h.html#a4fe5cafb16f3d0021f55eca85d443683">fp_inv</a></div><div class="ttdeci">#define fp_inv</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d66/fp-gmp_8h_source.html#l00088">fp-gmp.h:88</a></div></div>
<div class="ttc" id="afp-gmp_8h_html_a5324909527d54f9d1ec902b743b5133c"><div class="ttname"><a href="../../d8/d66/fp-gmp_8h.html#a5324909527d54f9d1ec902b743b5133c">fp_cmov</a></div><div class="ttdeci">#define fp_cmov</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d66/fp-gmp_8h_source.html#l00323">fp-gmp.h:323</a></div></div>
<div class="ttc" id="afp-gmp_8h_html_aa73022969fcd23d0d81d0b7115248d5d"><div class="ttname"><a href="../../d8/d66/fp-gmp_8h.html#aa73022969fcd23d0d81d0b7115248d5d">fp_enc</a></div><div class="ttdeci">#define fp_enc</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d66/fp-gmp_8h_source.html#l00055">fp-gmp.h:55</a></div></div>
<div class="ttc" id="afp-gmp_8h_html_ad0b6e5afb2fdd4f50fd2714fc59931ab"><div class="ttname"><a href="../../d8/d66/fp-gmp_8h.html#ad0b6e5afb2fdd4f50fd2714fc59931ab">fp_copy</a></div><div class="ttdeci">#define fp_copy</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d66/fp-gmp_8h_source.html#l00079">fp-gmp.h:79</a></div></div>
<div class="ttc" id="amont_8h_html_a1983214d89665bc95ea846ba0d45114b"><div class="ttname"><a href="../../d0/d84/mont_8h.html#a1983214d89665bc95ea846ba0d45114b">xA24</a></div><div class="ttdeci">#define xA24</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d84/mont_8h_source.html#l00017">mont.h:17</a></div></div>
<div class="ttc" id="amont_8h_html_a33bcb2a867a845121bac1591c68456d1"><div class="ttname"><a href="../../d0/d84/mont_8h.html#a33bcb2a867a845121bac1591c68456d1">xMUL_dac</a></div><div class="ttdeci">#define xMUL_dac</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d84/mont_8h_source.html#l00021">mont.h:21</a></div></div>
<div class="ttc" id="amont_8h_html_ac3af9f03d84babaea6d4d2faea220ba1"><div class="ttname"><a href="../../d0/d84/mont_8h.html#ac3af9f03d84babaea6d4d2faea220ba1">xISOG_matryoshka</a></div><div class="ttdeci">#define xISOG_matryoshka</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d84/mont_8h_source.html#l00024">mont.h:24</a></div></div>
<div class="ttc" id="anamespacetests_html_a3b98e2dffc6cb06a89dcb0d5c60a0206"><div class="ttname"><a href="../../d9/df4/namespacetests.html#a3b98e2dffc6cb06a89dcb0d5c60a0206">tests.A</a></div><div class="ttdeci">A</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d94/tests_8py_source.html#l00029">tests.py:29</a></div></div>
<div class="ttc" id="aprime__search_8m_html_ac86694252f8dfdb19aaeadc4b7c342c6"><div class="ttname"><a href="../../d2/d00/prime__search_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a></div><div class="ttdeci">for j</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d00/prime__search_8m_source.html#l00011">prime_search.m:12</a></div></div>
<div class="ttc" id="aprimes_8h_html_a0c186a4875e68bfc39a2688c42d12e26"><div class="ttname"><a href="../../d6/d5f/primes_8h.html#a0c186a4875e68bfc39a2688c42d12e26">batch_keybounds_start</a></div><div class="ttdeci">#define batch_keybounds_start</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d5f/primes_8h_source.html#l00057">primes.h:57</a></div></div>
<div class="ttc" id="aprimes_8h_html_a137794744a03163a524ebb2aac2105c0"><div class="ttname"><a href="../../d6/d5f/primes_8h.html#a137794744a03163a524ebb2aac2105c0">primes</a></div><div class="ttdeci">#define primes</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d5f/primes_8h_source.html#l00051">primes.h:51</a></div></div>
<div class="ttc" id="aprimes_8h_html_a258b7d004311e956a8eac8954d5d184d"><div class="ttname"><a href="../../d6/d5f/primes_8h.html#a258b7d004311e956a8eac8954d5d184d">batch_maxdac</a></div><div class="ttdeci">#define batch_maxdac</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d5f/primes_8h_source.html#l00060">primes.h:60</a></div></div>
<div class="ttc" id="aprimes_8h_html_a3a6da910ef8a7d99406350469d1fba82"><div class="ttname"><a href="../../d6/d5f/primes_8h.html#a3a6da910ef8a7d99406350469d1fba82">batch_keybounds_stop</a></div><div class="ttdeci">#define batch_keybounds_stop</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d5f/primes_8h_source.html#l00058">primes.h:58</a></div></div>
<div class="ttc" id="aprimes_8h_html_a56cb00c68833427c91926115f0eb70f0"><div class="ttname"><a href="../../d6/d5f/primes_8h.html#a56cb00c68833427c91926115f0eb70f0">primes_dac</a></div><div class="ttdeci">#define primes_dac</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d5f/primes_8h_source.html#l00052">primes.h:52</a></div></div>
<div class="ttc" id="aprimes_8h_html_a63de22a96a777bab244dd0850f58fed9"><div class="ttname"><a href="../../d6/d5f/primes_8h.html#a63de22a96a777bab244dd0850f58fed9">batch_start</a></div><div class="ttdeci">#define batch_start</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d5f/primes_8h_source.html#l00055">primes.h:55</a></div></div>
<div class="ttc" id="aprimes_8h_html_a91122dc998b135229e3bbde3ed578d80"><div class="ttname"><a href="../../d6/d5f/primes_8h.html#a91122dc998b135229e3bbde3ed578d80">primes_daclen</a></div><div class="ttdeci">#define primes_daclen</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d5f/primes_8h_source.html#l00053">primes.h:53</a></div></div>
<div class="ttc" id="aprimes_8h_html_a950dc149fa08d10049e01546ca3562b3"><div class="ttname"><a href="../../d6/d5f/primes_8h.html#a950dc149fa08d10049e01546ca3562b3">batch_numkeys</a></div><div class="ttdeci">#define batch_numkeys</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d5f/primes_8h_source.html#l00059">primes.h:59</a></div></div>
<div class="ttc" id="aprimes_8h_html_acc9e03579591509b3edb49d07bc8cca6"><div class="ttname"><a href="../../d6/d5f/primes_8h.html#acc9e03579591509b3edb49d07bc8cca6">batch_stop</a></div><div class="ttdeci">#define batch_stop</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d5f/primes_8h_source.html#l00056">primes.h:56</a></div></div>
<div class="ttc" id="astructproj_html"><div class="ttname"><a href="../../d8/d6e/structproj.html">proj</a></div><div class="ttdef"><b>Definition</b> <a href="../../d2/dcf/proj_8h_source.html#l00017">proj.h:18</a></div></div>
<div class="ttc" id="astructpublic__key_html_a72d8790e9a07d07ac5b6e1a33a632dc5"><div class="ttname"><a href="../../d3/dce/structpublic__key.html#a72d8790e9a07d07ac5b6e1a33a632dc5">public_key::A</a></div><div class="ttdeci">fp A</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d4c/ctidh_8h_source.html#l00040">ctidh.h:40</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/d4c/ctidh_8h_source.html#l00040">public_key::A</a>, <a class="el" href="../../d6/d5f/primes_8h_source.html#l00057">batch_keybounds_start</a>, <a class="el" href="../../d6/d5f/primes_8h_source.html#l00058">batch_keybounds_stop</a>, <a class="el" href="../../d6/d5f/primes_8h_source.html#l00060">batch_maxdac</a>, <a class="el" href="../../d6/d5f/primes_8h_source.html#l00059">batch_numkeys</a>, <a class="el" href="../../d6/d5f/primes_8h_source.html#l00055">batch_start</a>, <a class="el" href="../../d6/d5f/primes_8h_source.html#l00056">batch_stop</a>, <a class="el" href="../../d4/d4c/ctidh_8h_source.html#l00033">private_key::directions</a>, <a class="el" href="../../d0/d35/elligator_8h_source.html#l00008">elligator_seeded</a>, <a class="el" href="../../d4/d4c/ctidh_8h_source.html#l00032">private_key::ells</a>, <a class="el" href="../../d8/d66/fp-gmp_8h_source.html#l00048">fp_1</a>, <a class="el" href="../../d8/d66/fp-gmp_8h_source.html#l00323">fp_cmov</a>, <a class="el" href="../../d8/d66/fp-gmp_8h_source.html#l00079">fp_copy</a>, <a class="el" href="../../d8/d66/fp-gmp_8h_source.html#l00055">fp_enc</a>, <a class="el" href="../../d8/d66/fp-gmp_8h_source.html#l00088">fp_inv</a>, <a class="el" href="../../d2/d00/prime__search_8m_source.html#l00012">j</a>, <a class="el" href="../../d6/d5f/primes_8h_source.html#l00051">primes</a>, <a class="el" href="../../d6/d5f/primes_8h_source.html#l00052">primes_dac</a>, <a class="el" href="../../d6/d5f/primes_8h_source.html#l00053">primes_daclen</a>, <a class="el" href="../../d4/d4c/ctidh_8h_source.html#l00041">public_key::seed</a>, <a class="el" href="../../d0/d84/mont_8h_source.html#l00017">xA24</a>, <a class="el" href="../../d0/d84/mont_8h_source.html#l00024">xISOG_matryoshka</a>, and <a class="el" href="../../d0/d84/mont_8h_source.html#l00021">xMUL_dac</a>.</p>

</div>
</div>
<a id="a16c24b59d32ee85588cc61c9770e378b" name="a16c24b59d32ee85588cc61c9770e378b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16c24b59d32ee85588cc61c9770e378b">&#9670;&#160;</a></span>csidh()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool csidh </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d3/dce/structpublic__key.html">public_key</a> *</td>          <td class="paramname"><span class="paramname"><em>out</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/dce/structpublic__key.html">public_key</a> const *</td>          <td class="paramname"><span class="paramname"><em>in</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/d54/structprivate__key.html">private_key</a> const *</td>          <td class="paramname"><span class="paramname"><em>priv</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d82/ctidh__wombat__eval_8c_source.html#l00386">386</a> of file <a class="el" href="../../da/d82/ctidh__wombat__eval_8c_source.html">ctidh_wombat_eval.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  387</span>{</div>
<div class="line"><span class="lineno">  388</span>    <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../d4/d4c/ctidh_8h.html#a2ead90c83cecd062dd9dc5229a729612">validate</a>(in))</div>
<div class="line"><span class="lineno">  389</span>    {</div>
<div class="line"><span class="lineno">  390</span>        <a class="code hl_define" href="../../d8/d66/fp-gmp_8h.html#afe624b010306dd35023fcd3ccbcf3378">fp_random</a>(out-&gt;<a class="code hl_variable" href="../../d3/dce/structpublic__key.html#a72d8790e9a07d07ac5b6e1a33a632dc5">A</a>);</div>
<div class="line"><span class="lineno">  391</span>        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  392</span>    }</div>
<div class="line"><span class="lineno">  393</span>    <a class="code hl_define" href="../../d4/d4c/ctidh_8h.html#a9aee97121de573073646701bc150f4b0">action</a>(out, in, priv);</div>
<div class="line"><span class="lineno">  394</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  395</span>}</div>
<div class="ttc" id="actidh_8h_html_a2ead90c83cecd062dd9dc5229a729612"><div class="ttname"><a href="../../d4/d4c/ctidh_8h.html#a2ead90c83cecd062dd9dc5229a729612">validate</a></div><div class="ttdeci">#define validate</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d4c/ctidh_8h_source.html#l00053">ctidh.h:53</a></div></div>
<div class="ttc" id="actidh_8h_html_a9aee97121de573073646701bc150f4b0"><div class="ttname"><a href="../../d4/d4c/ctidh_8h.html#a9aee97121de573073646701bc150f4b0">action</a></div><div class="ttdeci">#define action</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d4c/ctidh_8h_source.html#l00054">ctidh.h:54</a></div></div>
<div class="ttc" id="afp-gmp_8h_html_afe624b010306dd35023fcd3ccbcf3378"><div class="ttname"><a href="../../d8/d66/fp-gmp_8h.html#afe624b010306dd35023fcd3ccbcf3378">fp_random</a></div><div class="ttdeci">#define fp_random</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d66/fp-gmp_8h_source.html#l00085">fp-gmp.h:85</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d4/d4c/ctidh_8h_source.html#l00040">public_key::A</a>, <a class="el" href="../../d4/d4c/ctidh_8h_source.html#l00054">action</a>, <a class="el" href="../../d8/d66/fp-gmp_8h_source.html#l00085">fp_random</a>, and <a class="el" href="../../d4/d4c/ctidh_8h_source.html#l00053">validate</a>.</p>

</div>
</div>
<a id="ad6eaa6451c6422920550bf06f4169b6d" name="ad6eaa6451c6422920550bf06f4169b6d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6eaa6451c6422920550bf06f4169b6d">&#9670;&#160;</a></span>fulltorsion_points()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void fulltorsion_points </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d8/d66/fp-gmp_8h.html#a167c68a20b94476341fdbff3d8688784">fp</a></td>          <td class="paramname"><span class="paramname"><em>u</em></span>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d8/d66/fp-gmp_8h.html#a167c68a20b94476341fdbff3d8688784">fp</a> const</td>          <td class="paramname"><span class="paramname"><em>a</em></span>&#160;)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d82/ctidh__wombat__eval_8c_source.html#l00094">94</a> of file <a class="el" href="../../da/d82/ctidh__wombat__eval_8c_source.html">ctidh_wombat_eval.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   95</span>{</div>
<div class="line"><span class="lineno">   96</span>    <a class="code hl_struct" href="../../d8/d6e/structproj.html">proj</a> Tp, Tm, Pp[primes_num], Aux_Tp[3], Pm[primes_num], Aux_Tm[3], <a class="code hl_variable" href="../../d9/df4/namespacetests.html#a3b98e2dffc6cb06a89dcb0d5c60a0206">A</a>;</div>
<div class="line"><span class="lineno">   97</span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="../../d2/d00/prime__search_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>;</div>
<div class="line"><span class="lineno">   98</span> </div>
<div class="line"><span class="lineno">   99</span>    <span class="comment">// Convert curve to projective Montgomery form (A&#39; + 2C : 4C)</span></div>
<div class="line"><span class="lineno">  100</span>    <a class="code hl_define" href="../../d8/d66/fp-gmp_8h.html#ad0b6e5afb2fdd4f50fd2714fc59931ab">fp_copy</a>(<a class="code hl_variable" href="../../d9/df4/namespacetests.html#a3b98e2dffc6cb06a89dcb0d5c60a0206">A</a>.x, <a class="code hl_variable" href="../../d5/dac/to__model_8m.html#ae72ab0a319852f0c6d43e6937c1063bd">a</a>);</div>
<div class="line"><span class="lineno">  101</span>    fp_set1(<a class="code hl_variable" href="../../d9/df4/namespacetests.html#a3b98e2dffc6cb06a89dcb0d5c60a0206">A</a>.z);</div>
<div class="line"><span class="lineno">  102</span>    <a class="code hl_define" href="../../d8/d66/fp-gmp_8h.html#a80f123b780aa89ca8990f737ca4cb107">fp_add</a>(<a class="code hl_variable" href="../../d9/df4/namespacetests.html#a3b98e2dffc6cb06a89dcb0d5c60a0206">A</a>.z, <a class="code hl_variable" href="../../d9/df4/namespacetests.html#a3b98e2dffc6cb06a89dcb0d5c60a0206">A</a>.z, <a class="code hl_variable" href="../../d9/df4/namespacetests.html#a3b98e2dffc6cb06a89dcb0d5c60a0206">A</a>.z); <span class="comment">// 2C</span></div>
<div class="line"><span class="lineno">  103</span>    <a class="code hl_define" href="../../d8/d66/fp-gmp_8h.html#a80f123b780aa89ca8990f737ca4cb107">fp_add</a>(<a class="code hl_variable" href="../../d9/df4/namespacetests.html#a3b98e2dffc6cb06a89dcb0d5c60a0206">A</a>.x, <a class="code hl_variable" href="../../d9/df4/namespacetests.html#a3b98e2dffc6cb06a89dcb0d5c60a0206">A</a>.x, <a class="code hl_variable" href="../../d9/df4/namespacetests.html#a3b98e2dffc6cb06a89dcb0d5c60a0206">A</a>.z); <span class="comment">// A&#39; + 2C</span></div>
<div class="line"><span class="lineno">  104</span>    <a class="code hl_define" href="../../d8/d66/fp-gmp_8h.html#a80f123b780aa89ca8990f737ca4cb107">fp_add</a>(<a class="code hl_variable" href="../../d9/df4/namespacetests.html#a3b98e2dffc6cb06a89dcb0d5c60a0206">A</a>.z, <a class="code hl_variable" href="../../d9/df4/namespacetests.html#a3b98e2dffc6cb06a89dcb0d5c60a0206">A</a>.z, <a class="code hl_variable" href="../../d9/df4/namespacetests.html#a3b98e2dffc6cb06a89dcb0d5c60a0206">A</a>.z); <span class="comment">// 4C</span></div>
<div class="line"><span class="lineno">  105</span> </div>
<div class="line"><span class="lineno">  106</span>    fp_set0(u); <span class="comment">// u &lt;- 0</span></div>
<div class="line"><span class="lineno">  107</span>    uint8_t boolp = 0, boolm = 0;</div>
<div class="line"><span class="lineno">  108</span> </div>
<div class="line"><span class="lineno">  109</span>    <span class="keywordflow">do</span></div>
<div class="line"><span class="lineno">  110</span>    {</div>
<div class="line"><span class="lineno">  111</span> </div>
<div class="line"><span class="lineno">  112</span><span class="preprocessor">#ifdef ENABLE_CT_TESTING</span></div>
<div class="line"><span class="lineno">  113</span>        VALGRIND_MAKE_MEM_DEFINED(Aux_Tp, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="../../d8/d6e/structproj.html">proj</a>) * 3);</div>
<div class="line"><span class="lineno">  114</span>        VALGRIND_MAKE_MEM_DEFINED(Aux_Tm, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="../../d8/d6e/structproj.html">proj</a>) * 3);</div>
<div class="line"><span class="lineno">  115</span>        VALGRIND_MAKE_MEM_DEFINED(&amp;A, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="../../d8/d6e/structproj.html">proj</a>));</div>
<div class="line"><span class="lineno">  116</span>        VALGRIND_MAKE_MEM_DEFINED(&amp;boolp, <span class="keyword">sizeof</span>(uint8_t));</div>
<div class="line"><span class="lineno">  117</span>        VALGRIND_MAKE_MEM_DEFINED(&amp;boolm, <span class="keyword">sizeof</span>(uint8_t));</div>
<div class="line"><span class="lineno">  118</span>        VALGRIND_MAKE_MEM_DEFINED(&amp;Tp, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="../../d8/d6e/structproj.html">proj</a>));</div>
<div class="line"><span class="lineno">  119</span>        VALGRIND_MAKE_MEM_DEFINED(Pp, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="../../d8/d6e/structproj.html">proj</a>) * primes_num);</div>
<div class="line"><span class="lineno">  120</span>        VALGRIND_MAKE_MEM_DEFINED(Pm, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="../../d8/d6e/structproj.html">proj</a>) * primes_num);</div>
<div class="line"><span class="lineno">  121</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  122</span> </div>
<div class="line"><span class="lineno">  123</span>        <a class="code hl_define" href="../../d8/d66/fp-gmp_8h.html#a80f123b780aa89ca8990f737ca4cb107">fp_add</a>(u, u, <a class="code hl_define" href="../../d8/d66/fp-gmp_8h.html#a4ec3519815103a8a92bd612f933abbb1">fp_1</a>); <span class="comment">// u &lt;- u + 1 ... Recall, 1 must be in Montgomery domain</span></div>
<div class="line"><span class="lineno">  124</span>        <a class="code hl_define" href="../../d0/d35/elligator_8h.html#ab62f777855b4aeae0423f37feb8386e2">elligator_seeded</a>(&amp;Tp, &amp;Tm, &amp;A, (<span class="keyword">const</span> <a class="code hl_typedef" href="../../d8/d66/fp-gmp_8h.html#a167c68a20b94476341fdbff3d8688784">fp</a> *)u);</div>
<div class="line"><span class="lineno">  125</span> </div>
<div class="line"><span class="lineno">  126</span>        clearpublicprimes(&amp;Tp, &amp;A);</div>
<div class="line"><span class="lineno">  127</span>        clearpublicprimes(&amp;Tm, &amp;A);</div>
<div class="line"><span class="lineno">  128</span> </div>
<div class="line"><span class="lineno">  129</span><span class="preprocessor">#ifdef ENABLE_CT_TESTING</span></div>
<div class="line"><span class="lineno">  130</span>        memset(Aux_Tp, 0, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="../../d8/d6e/structproj.html">proj</a>) * 3);</div>
<div class="line"><span class="lineno">  131</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  132</span>        multiples(Aux_Tp, Tp, A);</div>
<div class="line"><span class="lineno">  133</span>        <span class="keywordflow">if</span> (fp_iszero(Aux_Tp[0].z) | fp_iszero(Aux_Tp[1].z) | fp_iszero(Aux_Tp[2].z))</div>
<div class="line"><span class="lineno">  134</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  135</span> </div>
<div class="line"><span class="lineno">  136</span><span class="preprocessor">#ifdef ENABLE_CT_TESTING</span></div>
<div class="line"><span class="lineno">  137</span>        memset(Aux_Tm, 0, <span class="keyword">sizeof</span>(<a class="code hl_struct" href="../../d8/d6e/structproj.html">proj</a>) * 3);</div>
<div class="line"><span class="lineno">  138</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  139</span>        multiples(Aux_Tm, Tm, A);</div>
<div class="line"><span class="lineno">  140</span>        <span class="keywordflow">if</span> (fp_iszero(Aux_Tm[0].z) | fp_iszero(Aux_Tm[1].z) | fp_iszero(Aux_Tm[2].z))</div>
<div class="line"><span class="lineno">  141</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  142</span> </div>
<div class="line"><span class="lineno">  143</span>        <span class="comment">// Checking if Tp is an order (p+1)/(2^e)</span></div>
<div class="line"><span class="lineno">  144</span>        proj_copy(&amp;Pp[0], &amp;Tp);</div>
<div class="line"><span class="lineno">  145</span>        <a class="code hl_define" href="../../d4/d4c/ctidh_8h.html#aef94c206880c1495cff4b5fa89212810">cofactor_multiples</a>(Pp, A, 0, primes_num);</div>
<div class="line"><span class="lineno">  146</span>        boolp = 1;</div>
<div class="line"><span class="lineno">  147</span>        boolp &amp;= (1 - fp_iszero(Pp[0].z)) | (1 - fp_iszero(Aux_Tp[0].z));</div>
<div class="line"><span class="lineno">  148</span>        boolp &amp;= (1 - fp_iszero(Pp[1].z)) | (1 - fp_iszero(Aux_Tp[1].z));</div>
<div class="line"><span class="lineno">  149</span>        boolp &amp;= (1 - fp_iszero(Pp[2].z)) | (1 - fp_iszero(Aux_Tp[2].z));</div>
<div class="line"><span class="lineno">  150</span>        <span class="keywordflow">for</span> (<a class="code hl_variable" href="../../d2/d00/prime__search_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 3; <a class="code hl_variable" href="../../d2/d00/prime__search_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; (int)primes_num; <a class="code hl_variable" href="../../d2/d00/prime__search_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++)</div>
<div class="line"><span class="lineno">  151</span>            boolp &amp;= (1 - fp_iszero(Pp[<a class="code hl_variable" href="../../d2/d00/prime__search_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>].z));</div>
<div class="line"><span class="lineno">  152</span> </div>
<div class="line"><span class="lineno">  153</span>        <span class="keywordflow">if</span> (1 - boolp)</div>
<div class="line"><span class="lineno">  154</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  155</span> </div>
<div class="line"><span class="lineno">  156</span>        <span class="comment">// ---&gt; This can be removed for wd1 style</span></div>
<div class="line"><span class="lineno">  157</span>        <span class="comment">// Checking if Tm is an order (p+1)/(2^e)</span></div>
<div class="line"><span class="lineno">  158</span>        proj_copy(&amp;Pm[0], &amp;Tm);</div>
<div class="line"><span class="lineno">  159</span>        <a class="code hl_define" href="../../d4/d4c/ctidh_8h.html#aef94c206880c1495cff4b5fa89212810">cofactor_multiples</a>(Pm, A, 0, primes_num);</div>
<div class="line"><span class="lineno">  160</span> </div>
<div class="line"><span class="lineno">  161</span>        boolm = 1;</div>
<div class="line"><span class="lineno">  162</span>        boolm &amp;= (1 - fp_iszero(Pm[0].z)) | (1 - fp_iszero(Aux_Tm[0].z));</div>
<div class="line"><span class="lineno">  163</span>        boolm &amp;= (1 - fp_iszero(Pm[1].z)) | (1 - fp_iszero(Aux_Tm[1].z));</div>
<div class="line"><span class="lineno">  164</span>        boolm &amp;= (1 - fp_iszero(Pm[2].z)) | (1 - fp_iszero(Aux_Tm[2].z));</div>
<div class="line"><span class="lineno">  165</span>        <span class="keywordflow">for</span> (<a class="code hl_variable" href="../../d2/d00/prime__search_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 3; <a class="code hl_variable" href="../../d2/d00/prime__search_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; (int)primes_num; <a class="code hl_variable" href="../../d2/d00/prime__search_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++)</div>
<div class="line"><span class="lineno">  166</span>            boolm &amp;= (1 - fp_iszero(Pm[<a class="code hl_variable" href="../../d2/d00/prime__search_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>].z));</div>
<div class="line"><span class="lineno">  167</span> </div>
<div class="line"><span class="lineno">  168</span>        <span class="keywordflow">if</span> (1 - boolm)</div>
<div class="line"><span class="lineno">  169</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  170</span>        <span class="comment">// &lt;---</span></div>
<div class="line"><span class="lineno">  171</span>    } <span class="keywordflow">while</span> ((1 - boolp) | (1 - boolm));</div>
<div class="line"><span class="lineno">  172</span> </div>
<div class="line"><span class="lineno">  173</span>    <a class="code hl_define" href="../../d8/d66/fp-gmp_8h.html#afe9d15f0be91f1759f096d7c20655fb0">fp_dec</a>(u, (uint64_t *<span class="keyword">const</span>)u);</div>
<div class="line"><span class="lineno">  174</span>}</div>
<div class="ttc" id="actidh_8h_html_aef94c206880c1495cff4b5fa89212810"><div class="ttname"><a href="../../d4/d4c/ctidh_8h.html#aef94c206880c1495cff4b5fa89212810">cofactor_multiples</a></div><div class="ttdeci">#define cofactor_multiples</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d4c/ctidh_8h_source.html#l00055">ctidh.h:55</a></div></div>
<div class="ttc" id="afp-gmp_8h_html_a80f123b780aa89ca8990f737ca4cb107"><div class="ttname"><a href="../../d8/d66/fp-gmp_8h.html#a80f123b780aa89ca8990f737ca4cb107">fp_add</a></div><div class="ttdeci">#define fp_add</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d66/fp-gmp_8h_source.html#l00064">fp-gmp.h:64</a></div></div>
<div class="ttc" id="afp-gmp_8h_html_afe9d15f0be91f1759f096d7c20655fb0"><div class="ttname"><a href="../../d8/d66/fp-gmp_8h.html#afe9d15f0be91f1759f096d7c20655fb0">fp_dec</a></div><div class="ttdeci">#define fp_dec</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d66/fp-gmp_8h_source.html#l00058">fp-gmp.h:58</a></div></div>
<div class="ttc" id="ato__model_8m_html_ae72ab0a319852f0c6d43e6937c1063bd"><div class="ttname"><a href="../../d5/dac/to__model_8m.html#ae72ab0a319852f0c6d43e6937c1063bd">a</a></div><div class="ttdeci">f a</div><div class="ttdef"><b>Definition</b> <a href="../../d5/dac/to__model_8m_source.html#l00012">to_model.m:12</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../d5/dac/to__model_8m_source.html#l00012">a</a>, <a class="el" href="../../d4/d4c/ctidh_8h_source.html#l00055">cofactor_multiples</a>, <a class="el" href="../../d0/d35/elligator_8h_source.html#l00008">elligator_seeded</a>, <a class="el" href="../../d8/d66/fp-gmp_8h_source.html#l00048">fp_1</a>, <a class="el" href="../../d8/d66/fp-gmp_8h_source.html#l00064">fp_add</a>, <a class="el" href="../../d8/d66/fp-gmp_8h_source.html#l00079">fp_copy</a>, <a class="el" href="../../d8/d66/fp-gmp_8h_source.html#l00058">fp_dec</a>, and <a class="el" href="../../d2/d00/prime__search_8m_source.html#l00012">j</a>.</p>

</div>
</div>
<a name="doc-var-members" id="doc-var-members"></a><h2 id="header-doc-var-members" class="groupheader">Variable Documentation</h2>
<a id="ae5a97e9debf3707d97dfb35dc631a0ca" name="ae5a97e9debf3707d97dfb35dc631a0ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5a97e9debf3707d97dfb35dc631a0ca">&#9670;&#160;</a></span>base</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="../../d3/dce/structpublic__key.html">public_key</a> base = {.A = {0}, .seed = ELLIGATOR_SEED}</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d82/ctidh__wombat__eval_8c_source.html#l00024">24</a> of file <a class="el" href="../../da/d82/ctidh__wombat__eval_8c_source.html">ctidh_wombat_eval.c</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   24</span>{.A = {0}, .seed = ELLIGATOR_SEED}; <span class="comment">/* A = 0 */</span></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div id="page-nav" class="page-nav-panel">
<div id="page-nav-resize-handle"></div>
<div id="page-nav-tree">
<div id="page-nav-contents">
</div><!-- page-nav-contents -->
</div><!-- page-nav-tree -->
</div><!-- page-nav -->
</div><!-- container -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a href="../../dir_885cc87fac2d91e269af0a5a959fa5f6.html">E:</a></li><li class="navelem"><a href="../../dir_a865573cf4ca7ee6ec5c0bfd646ea969.html">pqc-engineering-ssec-23</a></li><li class="navelem"><a href="../../dir_fce502bce9da5e45835e0996c6c380e6.html">dCTIDH</a></li><li class="navelem"><a href="../../dir_c45facb78362f188956c525ad3467299.html">src</a></li><li class="navelem"><a href="../../dir_1d7791e3f3dadd9f077cb76eae384141.html">CTIDH</a></li><li class="navelem"><a href="../../da/d82/ctidh__wombat__eval_8c.html">ctidh_wombat_eval.c</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.14.0 </li>
  </ul>
</div>
</body>
</html>
